<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Java8è¯­æ³•ç³–</title>
      <link href="/2023/01/05/Java8%E8%AF%AD%E6%B3%95%E7%B3%96/"/>
      <url>/2023/01/05/Java8%E8%AF%AD%E6%B3%95%E7%B3%96/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯è¯­æ³•ç³–ï¼ˆSyntactic-sugarï¼‰"><a href="#ä»€ä¹ˆæ˜¯è¯­æ³•ç³–ï¼ˆSyntactic-sugarï¼‰" class="headerlink" title="ä»€ä¹ˆæ˜¯è¯­æ³•ç³–ï¼ˆSyntactic sugarï¼‰"></a>ä»€ä¹ˆæ˜¯è¯­æ³•ç³–ï¼ˆSyntactic sugarï¼‰</h2><p>è¯­æ³•ç³–æ˜¯ä¸€ä¸ªè®¡ç®—æœºæ•°æ®ï¼Œç‰¹æŒ‡åœ¨ç¼–ç¨‹è¯­è¨€ä¸­æ·»åŠ çš„æŸç§è¯­æ³•ï¼Œè¿™ç§è¯­æ³•å¯¹è¯­è¨€çš„åŠŸèƒ½æ²¡æœ‰å½±å“ï¼Œä½†æ˜¯æ›´æ–¹ä¾¿ç¨‹åºå‘˜ä½¿ç”¨ã€‚è¯­æ³•ç³–è®©ç¨‹åºæ›´åŠ ç®€æ´ï¼Œæœ‰æ›´é«˜çš„å¯è¯»æ€§ã€‚</p><p>ç³–å˜›ï¼Œå¯¹åº”çš„è¯æ±‡å°±æ˜¯ç”œã€‚è€Œè¯­æ³•ç³–å°±æ˜¯è®©ä½ çš„ä»£ç æ›´ç”œğŸ¶ã€‚</p><p>å®é™…ä¸Šå°±åƒä¸Šé¢ä»‹ç»çš„ï¼Œå¦‚æœå¯ä»¥å°†è¯­å¥ä¸­çš„ä¸€äº›æ„é€ ä»è¯­å¥ä¸­åˆ é™¤è€Œä¸å½±å“è¯­è¨€çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯è¯­æ³•ç³–ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åºåˆ—åŒ–</title>
      <link href="/2023/01/05/%E5%BA%8F%E5%88%97%E5%8C%96/"/>
      <url>/2023/01/05/%E5%BA%8F%E5%88%97%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<h2 id="å¸¸ç”¨çš„åºåˆ—åŒ–ç±»åº“"><a href="#å¸¸ç”¨çš„åºåˆ—åŒ–ç±»åº“" class="headerlink" title="å¸¸ç”¨çš„åºåˆ—åŒ–ç±»åº“"></a>å¸¸ç”¨çš„åºåˆ—åŒ–ç±»åº“</h2><h3 id="1-Gson-googleå¼€å‘"><a href="#1-Gson-googleå¼€å‘" class="headerlink" title="1. Gson(googleå¼€å‘)"></a>1. Gson(googleå¼€å‘)</h3><ul><li>å¼•å…¥Gson:</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;gson&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.8.9&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><ul><li><p>åºåˆ—åŒ–ï¼šï¼ˆæŠŠå®ä½“å¯¹è±¡è½¬æ¢ä¸ºjsonå­—ç¬¦ä¸²ï¼‰</p><p>gson.tojson(); &#x2F;&#x2F;å½¢å‚ä¸ºè¦åºåˆ—åŒ–çš„jsonä¸²</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">       <span class="comment">//åˆ›å»ºå®ä½“ç±»</span></span><br><span class="line">      <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="string">&quot;ç”·&quot;</span>, <span class="number">25</span>);</span><br><span class="line">      <span class="comment">//å®ä¾‹åŒ–Gson</span></span><br><span class="line">      <span class="type">Gson</span> <span class="variable">gson</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Gson</span>();</span><br><span class="line">      <span class="comment">//æŠŠå¯¹è±¡åºåˆ—åŒ–ä¸ºjson</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> gson.toJson(user);</span><br><span class="line">      <span class="comment">//è¾“å‡º---åºåˆ—åŒ–åçš„ç»“æœä¸ºï¼š&#123;&quot;name&quot;:&quot;å¼ ä¸‰&quot;,&quot;sex&quot;:&quot;ç”·&quot;,&quot;age&quot;:25&#125;</span></span><br><span class="line">      System.out.println(<span class="string">&quot;åºåˆ—åŒ–åçš„ç»“æœä¸ºï¼š&quot;</span>+s);</span><br><span class="line">      <span class="comment">//å®šä¹‰Listé›†åˆ</span></span><br><span class="line">      List&lt;User&gt; users = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">      users.add(user);</span><br><span class="line">      <span class="type">String</span> <span class="variable">s1</span> <span class="operator">=</span> gson.toJson(users);</span><br><span class="line">      <span class="comment">//è¾“å‡º---Listé›†åˆåºåˆ—åŒ–åçš„ç»“æœä¸ºï¼š[&#123;&quot;name&quot;:&quot;å¼ ä¸‰&quot;,&quot;sex&quot;:&quot;ç”·&quot;,&quot;age&quot;:25&#125;]</span></span><br><span class="line">      System.out.println(<span class="string">&quot;Listé›†åˆåºåˆ—åŒ–åçš„ç»“æœä¸ºï¼š&quot;</span>+s1);</span><br><span class="line">      Map&lt;String, User&gt; userMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">      userMap.put(<span class="string">&quot;åºåˆ—åŒ–æµ‹è¯•&quot;</span>,user);</span><br><span class="line">      <span class="comment">//è¾“å‡º--Mapé›†åˆåºåˆ—åŒ–åçš„ç»“æœä¸ºï¼š&#123;åºåˆ—åŒ–æµ‹è¯•=StudentEntity&#123;name=&#x27;åºåˆ—åŒ–&#x27;, sex=&#x27;ç”·&#x27;, age=25&#125;&#125;</span></span><br><span class="line">      System.out.println(<span class="string">&quot;Mapé›†åˆåºåˆ—åŒ–åçš„ç»“æœä¸ºï¼š&quot;</span>+userMap);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>ååºåˆ—åŒ–ï¼šï¼ˆæŠŠjsonå­—ç¬¦ä¸²è½¬æ¢ä¸ºå®ä½“å¯¹è±¡ï¼‰</p><p>gson.fromJson();</p><ul><li><p>æŠŠjsonè½¬æ¢ä¸ºListå¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">      <span class="comment">// å®šä¹‰json</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> <span class="string">&quot;[&#123;\&quot;name\&quot;:\&quot;è½¬æ¢å¯¹è±¡\&quot;,\&quot;sex\&quot;:\&quot;å¥³\&quot;,\&quot;age\&quot;:20&#125;]&quot;</span>;</span><br><span class="line">      <span class="comment">//å®ä¾‹åŒ–Gson</span></span><br><span class="line">      <span class="type">Gson</span> <span class="variable">gson</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Gson</span>();</span><br><span class="line">      <span class="comment">//æŠŠjsonåºåˆ—åŒ–ä¸ºListå¯¹è±¡</span></span><br><span class="line">      List&lt;User&gt; o = gson.fromJson(json, <span class="keyword">new</span> <span class="title class_">TypeToken</span>&lt;List&lt;User&gt;&gt;() &#123;</span><br><span class="line">      &#125;.getType());</span><br><span class="line">      <span class="comment">//è¾“å‡º---åºåˆ—åŒ–åçš„ç»“æœä¸ºï¼š[StudentEntity&#123;name=&#x27;å¼ ä¸‰&#x27;, sex=&#x27;å¥³&#x27;, age=20&#125;]</span></span><br><span class="line">      System.out.println(<span class="string">&quot;ååºåˆ—åŒ–æˆListåçš„ç»“æœä¸ºï¼š&quot;</span>+o.toString());</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li><li><p>æŠŠjsonè½¬æ¢ä¸ºMapå¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">      <span class="comment">//å®ä¾‹åŒ–Gson</span></span><br><span class="line">      <span class="type">Gson</span> <span class="variable">gson</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Gson</span>();</span><br><span class="line">      <span class="comment">//å®šä¹‰json</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">jsonMap</span> <span class="operator">=</span> <span class="string">&quot;&#123;&#x27;åºåˆ—åŒ–æµ‹è¯•&#x27;:&#123;name=&#x27;å¼ ä¸‰&#x27;, sex=&#x27;ç”·&#x27;, age=25&#125;&#125;&quot;</span>;</span><br><span class="line">      <span class="comment">//æŠŠjsonåºåˆ—åŒ–ä¸ºMapå¯¹è±¡</span></span><br><span class="line">      HashMap&lt;String,User&gt; o1 = gson.fromJson(jsonMap, <span class="keyword">new</span> <span class="title class_">TypeToken</span>&lt;HashMap&lt;String,User&gt;&gt;() &#123;</span><br><span class="line">      &#125;.getType());</span><br><span class="line">      <span class="comment">//è¾“å‡º---&#123;åºåˆ—åŒ–æµ‹è¯•=StudentEntity&#123;name=&#x27;å¼ ä¸‰&#x27;, sex=&#x27;ç”·&#x27;, age=25&#125;&#125;</span></span><br><span class="line">      System.out.println(<span class="string">&quot;ååºåˆ—åŒ–æˆMapåçš„ç»“æœä¸ºï¼š&quot;</span>+o1);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li><li><p>æŠŠjsonè½¬æ¢ä¸ºå®ä½“å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">      <span class="comment">// å®šä¹‰json</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> <span class="string">&quot;&#123;\&quot;name\&quot;:\&quot;è½¬æ¢å¯¹è±¡\&quot;,\&quot;sex\&quot;:\&quot;å¥³\&quot;,\&quot;age\&quot;:20&#125;&quot;</span>;</span><br><span class="line">      <span class="comment">//å®ä¾‹åŒ–Gson</span></span><br><span class="line">      <span class="type">Gson</span> <span class="variable">gson</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Gson</span>();</span><br><span class="line">      <span class="comment">//æŠŠjsonåºåˆ—åŒ–ä¸ºå®ä½“ç±»ï¼ˆTestï¼‰å¯¹è±¡</span></span><br><span class="line">      <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> gson.fromJson(json, User.class);</span><br><span class="line">      <span class="comment">//è¾“å‡º---ååºåˆ—åŒ–åçš„ç»“æœä¸ºï¼šStudentEntity&#123;name=&#x27;å¼ ä¸‰&#x27;, sex=&#x27;å¥³&#x27;, age=20&#125;</span></span><br><span class="line">      System.out.println(<span class="string">&quot;ååºåˆ—åŒ–æˆå®ä½“ç±»åçš„ç»“æœä¸ºï¼š&quot;</span>+user.toString());</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li></ul></li></ul><h3 id="2-Fastjson-aliå¼€å‘"><a href="#2-Fastjson-aliå¼€å‘" class="headerlink" title="2. Fastjson(aliå¼€å‘)"></a>2. Fastjson(aliå¼€å‘)</h3><ul><li><p>å¼•å…¥ä¾èµ–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.alibaba.fastjson2&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;fastjson2&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;2.0.22&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></li><li><p>åºåˆ—åŒ–ï¼ˆjavaç±»è½¬æ¢ä¸ºjsonå­—ç¬¦ä¸²ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">objToJson</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//ç®€å•å¯¹è±¡è½¬æ¢</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;root&quot;</span>, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line">    <span class="comment">//è°ƒç”¨toJSONString()</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">userJson</span> <span class="operator">=</span> JSON.toJSONString(user);</span><br><span class="line">    System.out.println(<span class="string">&quot;javaç±»è½¬æ¢ä¸ºjsonä¸²ï¼š&quot;</span> + userJson);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é›†åˆè½¬jsonä¸²</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;zhangsan&quot;</span>, <span class="string">&quot;123456&quot;</span>);</span><br><span class="line">    <span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;lisi&quot;</span>, <span class="string">&quot;000&quot;</span>);</span><br><span class="line">    List&lt;User&gt; users = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;User&gt;();</span><br><span class="line">    users.add(user1);</span><br><span class="line">    users.add(user2);</span><br><span class="line">    <span class="comment">//è°ƒç”¨toJSONString()</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">usersjson</span> <span class="operator">=</span> JSON.toJSONString(users);</span><br><span class="line">    System.out.println(<span class="string">&quot;é›†åˆè½¬jsonä¸²ï¼š&quot;</span> + usersjson);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¤æ‚javaç±»è½¬æ¢å¯¹è±¡</span></span><br><span class="line">    <span class="type">UserGroup</span> <span class="variable">userGroup</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserGroup</span>(<span class="string">&quot;userGroup&quot;</span>, users);</span><br><span class="line">    <span class="comment">//è°ƒç”¨toJSONString()</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">userGroupJson</span> <span class="operator">=</span> JSON.toJSONString(userGroup);</span><br><span class="line">    System.out.println(<span class="string">&quot;å¤æ‚javaç±»è½¬æ¢jsonä¸²ï¼š&quot;</span> + userGroupJson);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//ç»“æœ</span></span><br><span class="line">javaç±»è½¬æ¢ä¸ºjsonä¸²ï¼š&#123;<span class="string">&quot;password&quot;</span>:<span class="string">&quot;123456&quot;</span>,<span class="string">&quot;username&quot;</span>:<span class="string">&quot;root&quot;</span>&#125;</span><br><span class="line">é›†åˆè½¬jsonä¸²ï¼š[&#123;<span class="string">&quot;password&quot;</span>:<span class="string">&quot;123456&quot;</span>,<span class="string">&quot;username&quot;</span>:<span class="string">&quot;zhangsan&quot;</span>&#125;,&#123;<span class="string">&quot;password&quot;</span>:<span class="string">&quot;000&quot;</span>,<span class="string">&quot;username&quot;</span>:<span class="string">&quot;lisi&quot;</span>&#125;]</span><br><span class="line">å¤æ‚javaç±»è½¬æ¢jsonä¸²ï¼š&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;userGroup&quot;</span>,<span class="string">&quot;users&quot;</span>:[&#123;<span class="string">&quot;password&quot;</span>:<span class="string">&quot;123456&quot;</span>,<span class="string">&quot;username&quot;</span>:<span class="string">&quot;zhangsan&quot;</span>&#125;,&#123;<span class="string">&quot;password&quot;</span>:<span class="string">&quot;000&quot;</span>,<span class="string">&quot;username&quot;</span>:<span class="string">&quot;lisi&quot;</span>&#125;]&#125;</span><br></pre></td></tr></table></figure></li><li><p>ååºåˆ—åŒ–ï¼ˆjsonå­—ç¬¦ä¸²è½¬ä¸ºjavaå¯¹è±¡ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * jsonå­—ç¬¦ä¸²è½¬ä¸ºjavaç±»</span></span><br><span class="line"><span class="comment">     * æ³¨ï¼šå­—ç¬¦ä¸²ä¸­ä½¿ç”¨åŒå¼•å·éœ€è¦è½¬ä¹‰ (&quot; --&gt; \&quot;),è¿™é‡Œä½¿ç”¨çš„æ˜¯å•å¼•å·,æ˜“è¯»æ€§ä¼šå¥½å¾ˆå¤šã€‚</span></span><br><span class="line"><span class="comment">     * jsonä¸²ä»¥â€œ&#123;&#125;â€åŒ…è£¹ï¼Œè½¬æ¢ä¸ºjavaç±»æ—¶ï¼Œä½¿ç”¨ï¼šparseObject();</span></span><br><span class="line"><span class="comment">     * jsonä¸²ä»¥â€œ[]â€åŒ…è£¹ï¼Œè½¬æ¢ä¸ºjavaç±»æ—¶ï¼Œä½¿ç”¨ï¼šparseArray();</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">jsonToObj</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="comment">/* jsonå­—ç¬¦ä¸²è½¬ç®€å•javaå¯¹è±¡</span></span><br><span class="line"><span class="comment">         * å­—ç¬¦ä¸²ï¼š&#123;&quot;password&quot;:&quot;123456&quot;,&quot;username&quot;:&quot;dmego&quot;&#125;</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">jsonStr1</span> <span class="operator">=</span> <span class="string">&quot;&#123;&#x27;password&#x27;:&#x27;123456&#x27;,&#x27;username&#x27;:&#x27;ggf&#x27;&#125;&quot;</span>;</span><br><span class="line">    <span class="comment">// è°ƒç”¨parseObject()</span></span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> JSON.parseObject(jsonStr1, User.class);</span><br><span class="line">    System.out.println(<span class="string">&quot;jsonå­—ç¬¦ä¸²è½¬ç®€å•javaå¯¹è±¡:&quot;</span>+user.toString());</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * jsonå­—ç¬¦ä¸²è½¬List&lt;Object&gt;å¯¹è±¡</span></span><br><span class="line"><span class="comment">         * å­—ç¬¦ä¸²ï¼š[&#123;&quot;password&quot;:&quot;123123&quot;,&quot;username&quot;:&quot;zhangsan&quot;&#125;,</span></span><br><span class="line"><span class="comment">         *        &#123;&quot;password&quot;:&quot;321321&quot;,&quot;username&quot;:&quot;lisi&quot;&#125;]</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">jsonStr2</span> <span class="operator">=</span> <span class="string">&quot;[&#123;&#x27;password&#x27;:&#x27;123123&#x27;,&#x27;username&#x27;:&#x27;zhangsan&#x27;&#125;,&#123;&#x27;password&#x27;:&#x27;321321&#x27;,&#x27;username&#x27;:&#x27;lisi&#x27;&#125;]&quot;</span>;</span><br><span class="line">    <span class="comment">// è°ƒç”¨parseArray()å°†å­—ç¬¦ä¸²è½¬ä¸ºé›†åˆ</span></span><br><span class="line">    List&lt;User&gt; users = JSON.parseArray(jsonStr2, User.class);</span><br><span class="line">    System.out.println(<span class="string">&quot;jsonå­—ç¬¦ä¸²è½¬List&lt;Object&gt;å¯¹è±¡:&quot;</span>+users.toString());</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*jsonå­—ç¬¦ä¸²è½¬å¤æ‚javaå¯¹è±¡</span></span><br><span class="line"><span class="comment">         * å­—ç¬¦ä¸²ï¼š&#123;&quot;name&quot;:&quot;userGroup&quot;,&quot;users&quot;:[&#123;&quot;password&quot;:&quot;123123&quot;,&quot;username&quot;:&quot;zhangsan&quot;&#125;,&#123;&quot;password&quot;:&quot;321321&quot;,&quot;username&quot;:&quot;lisi&quot;&#125;]&#125;</span></span><br><span class="line"><span class="comment">         * */</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">jsonStr3</span> <span class="operator">=</span> <span class="string">&quot;&#123;&#x27;name&#x27;:&#x27;userGroup&#x27;,&#x27;users&#x27;:[&#123;&#x27;password&#x27;:&#x27;123123&#x27;,&#x27;username&#x27;:&#x27;zhangsan&#x27;&#125;,&#123;&#x27;password&#x27;:&#x27;321321&#x27;,&#x27;username&#x27;:&#x27;lisi&#x27;&#125;]&#125;&quot;</span>;</span><br><span class="line">    <span class="type">UserGroup</span> <span class="variable">userGroup</span> <span class="operator">=</span> JSON.parseObject(jsonStr3, UserGroup.class);</span><br><span class="line">    System.out.println(<span class="string">&quot;jsonå­—ç¬¦ä¸²è½¬å¤æ‚javaå¯¹è±¡:&quot;</span>+userGroup);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="3-Kryo"><a href="#3-Kryo" class="headerlink" title="3. Kryo"></a>3. Kryo</h3><p>å‚è€ƒåšå®¢ï¼š<a href="https://juejin.cn/post/7107064264786968612">Javaé«˜æ€§èƒ½åºåˆ—åŒ–å·¥å…·Kryoåºåˆ—åŒ– - æ˜é‡‘ (juejin.cn)</a></p><ul><li><p>å¼•å…¥Kryo</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;com.esotericsoftware&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;kryo&lt;/artifactId&gt;</span><br><span class="line">  &lt;version&gt;5.2.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></li><li><p>åŸºæœ¬ä½¿ç”¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.esotericsoftware.kryo.Kryo;</span><br><span class="line"><span class="keyword">import</span> com.esotericsoftware.kryo.io.Input;</span><br><span class="line"><span class="keyword">import</span> com.esotericsoftware.kryo.io.Output;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloKryo</span> &#123;</span><br><span class="line">   <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">       <span class="type">Kryo</span> <span class="variable">kryo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Kryo</span>();</span><br><span class="line">       kryo.register(SomeClass.class);</span><br><span class="line"></span><br><span class="line">       <span class="type">SomeClass</span> <span class="variable">object</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SomeClass</span>();</span><br><span class="line">       object.value = <span class="string">&quot;Hello Kryo!&quot;</span>;</span><br><span class="line"></span><br><span class="line">       <span class="type">Output</span> <span class="variable">output</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Output</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;file.bin&quot;</span>));</span><br><span class="line">       kryo.writeObject(output, object);</span><br><span class="line">       output.close();</span><br><span class="line"></span><br><span class="line">       <span class="type">Input</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Input</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;file.bin&quot;</span>));</span><br><span class="line">       <span class="type">SomeClass</span> <span class="variable">object2</span> <span class="operator">=</span> kryo.readObject(input, SomeClass.class);</span><br><span class="line">       input.close();</span><br><span class="line">       System.out.println(object2.value);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">static</span> <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SomeClass</span> &#123;</span><br><span class="line">       String value;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="4-Jackson"><a href="#4-Jackson" class="headerlink" title="4. Jackson"></a>4. Jackson</h3><p>å‚è€ƒåšå®¢ï¼š<a href="https://juejin.cn/post/6844904166809157639">Jacksonä½¿ç”¨è¯¦è§£ - æ˜é‡‘ (juejin.cn)</a></p><ul><li><p>å¼•å…¥Jackson</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;</span><br><span class="line">  &lt;version&gt;2.9.6&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure></li></ul><h2 id="å¸¸ç”¨jsonç±»åº“çš„æ¯”è¾ƒ"><a href="#å¸¸ç”¨jsonç±»åº“çš„æ¯”è¾ƒ" class="headerlink" title="å¸¸ç”¨jsonç±»åº“çš„æ¯”è¾ƒ"></a>å¸¸ç”¨jsonç±»åº“çš„æ¯”è¾ƒ</h2><h3 id="1-è€ƒè™‘è§’åº¦"><a href="#1-è€ƒè™‘è§’åº¦" class="headerlink" title="1. è€ƒè™‘è§’åº¦"></a>1. è€ƒè™‘è§’åº¦</h3><p>é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„JSONåº“è¦ä»å¤šä¸ªæ–¹é¢è¿›è¡Œè€ƒè™‘ï¼š</p><ol><li>å­—ç¬¦ä¸²è§£ææˆJSONæ€§èƒ½</li><li>å­—ç¬¦ä¸²è§£ææˆJavaBeanæ€§èƒ½</li><li>JavaBeanæ„é€ JSONæ€§èƒ½</li><li>é›†åˆæ„é€ JSONæ€§èƒ½</li><li>æ˜“ç”¨æ€§</li></ol><h3 id="2-Gson"><a href="#2-Gson" class="headerlink" title="2. Gson"></a><strong>2. Gson</strong></h3><p>é¡¹ç›®åœ°å€ï¼š<a href="https://link.zhihu.com/?target=https://github.com/google/gson">https://github.com/google/gson</a></p><p>Gsonæ˜¯ç›®å‰åŠŸèƒ½æœ€å…¨çš„Jsonè§£æç¥å™¨ï¼ŒGsonå½“åˆæ˜¯ä¸ºå› åº”Googleå…¬å¸å†…éƒ¨éœ€æ±‚è€Œç”±Googleè‡ªè¡Œç ”å‘è€Œæ¥ï¼Œä½†è‡ªä»åœ¨2008å¹´äº”æœˆå…¬å¼€å‘å¸ƒç¬¬ä¸€ç‰ˆåå·²è¢«è®¸å¤šå…¬å¸æˆ–ç”¨æˆ·åº”ç”¨ã€‚Gsonçš„åº”ç”¨ä¸»è¦ä¸ºtoJsonä¸fromJsonä¸¤ä¸ªè½¬æ¢å‡½æ•°ï¼Œæ— ä¾èµ–ï¼Œä¸éœ€è¦é¢å¤–çš„jarï¼Œèƒ½å¤Ÿç›´æ¥è·‘åœ¨JDKä¸Šã€‚åœ¨ä½¿ç”¨è¿™ç§å¯¹è±¡è½¬æ¢ä¹‹å‰ï¼Œéœ€å…ˆåˆ›å»ºå¥½å¯¹è±¡çš„ç±»å‹ä»¥åŠå…¶æˆå‘˜æ‰èƒ½æˆåŠŸçš„å°†JSONå­—ç¬¦ä¸²æˆåŠŸè½¬æ¢æˆç›¸å¯¹åº”çš„å¯¹è±¡ã€‚ç±»é‡Œé¢åªè¦æœ‰getå’Œsetæ–¹æ³•ï¼ŒGsonå®Œå…¨å¯ä»¥å®ç°å¤æ‚ç±»å‹çš„jsonåˆ°beanæˆ–beanåˆ°jsonçš„è½¬æ¢ï¼Œæ˜¯JSONè§£æçš„ç¥å™¨ã€‚</p><h3 id="3-FastJson"><a href="#3-FastJson" class="headerlink" title="3. FastJson"></a><strong>3. FastJson</strong></h3><p>é¡¹ç›®åœ°å€ï¼š<a href="https://link.zhihu.com/?target=https://github.com/alibaba/fastjson">https://github.com/alibaba/fastjson</a></p><p>Fastjsonæ˜¯ä¸€ä¸ªJavaè¯­è¨€ç¼–å†™çš„é«˜æ€§èƒ½çš„JSONå¤„ç†å™¨,ç”±é˜¿é‡Œå·´å·´å…¬å¸å¼€å‘ã€‚æ— ä¾èµ–ï¼Œä¸éœ€è¦é¢å¤–çš„jarï¼Œèƒ½å¤Ÿç›´æ¥è·‘åœ¨JDKä¸Šã€‚FastJsonåœ¨å¤æ‚ç±»å‹çš„Beanè½¬æ¢Jsonä¸Šä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼Œå¯èƒ½ä¼šå‡ºç°å¼•ç”¨çš„ç±»å‹ï¼Œå¯¼è‡´Jsonè½¬æ¢å‡ºé”™ï¼Œéœ€è¦åˆ¶å®šå¼•ç”¨ã€‚FastJsoné‡‡ç”¨ç‹¬åˆ›çš„ç®—æ³•ï¼Œå°†parseçš„é€Ÿåº¦æå‡åˆ°æè‡´ï¼Œè¶…è¿‡æ‰€æœ‰jsonåº“ã€‚</p><h3 id="4-Kryo"><a href="#4-Kryo" class="headerlink" title="4. Kryo"></a>4. Kryo</h3><p>Kryo æ˜¯ä¸€ä¸ªå¿«é€Ÿåºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–å·¥å…·ï¼Œä¾èµ–äºå­—èŠ‚ç ç”Ÿæˆæœºåˆ¶ï¼ˆåº•å±‚ä½¿ç”¨äº† ASM åº“)ï¼Œå› æ­¤åœ¨åºåˆ—åŒ–é€Ÿåº¦ä¸Šæœ‰ä¸€å®šçš„ä¼˜åŠ¿ï¼Œä½†æ­£å› å¦‚æ­¤ï¼Œå…¶ä½¿ç”¨ä¹Ÿåªèƒ½é™åˆ¶åœ¨åŸºäº JVM çš„è¯­è¨€ä¸Šã€‚</p><p>å’Œ Hessian ç±»ä¼¼ï¼ŒKryo åºåˆ—åŒ–å‡ºçš„ç»“æœï¼Œæ˜¯å…¶è‡ªå®šä¹‰çš„ã€ç‹¬æœ‰çš„ä¸€ç§æ ¼å¼ã€‚ç”±äºå…¶åºåˆ—åŒ–å‡ºçš„ç»“æœæ˜¯äºŒè¿›åˆ¶çš„ï¼Œä¹Ÿå³ byte[]ï¼Œå› æ­¤åƒ Redis è¿™æ ·å¯ä»¥å­˜å‚¨äºŒè¿›åˆ¶æ•°æ®çš„å­˜å‚¨å¼•æ“æ˜¯å¯ä»¥ç›´æ¥å°† Kryo åºåˆ—åŒ–å‡ºæ¥çš„æ•°æ®å­˜è¿›å»ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€‰æ‹©è½¬æ¢æˆ String çš„å½¢å¼å­˜å‚¨åœ¨å…¶ä»–å­˜å‚¨å¼•æ“ä¸­ï¼ˆæ€§èƒ½æœ‰æŸè€—ï¼‰ã€‚</p><h3 id="5-Jackson"><a href="#5-Jackson" class="headerlink" title="5. Jackson"></a><strong>5. Jackson</strong></h3><p>é¡¹ç›®åœ°å€ï¼š<a href="https://link.zhihu.com/?target=https://github.com/FasterXML/jackson">https://github.com/FasterXML/jackson</a></p><p>Jacksonæ˜¯å½“å‰ç”¨çš„æ¯”è¾ƒå¹¿æ³›çš„ï¼Œç”¨æ¥åºåˆ—åŒ–å’Œååºåˆ—åŒ–jsonçš„Javaå¼€æºæ¡†æ¶ã€‚Jacksonç¤¾åŒºç›¸å¯¹æ¯”è¾ƒæ´»è·ƒï¼Œæ›´æ–°é€Ÿåº¦ä¹Ÿæ¯”è¾ƒå¿«ï¼Œ ä»Githubä¸­çš„ç»Ÿè®¡æ¥çœ‹ï¼ŒJacksonæ˜¯æœ€æµè¡Œçš„jsonè§£æå™¨ä¹‹ä¸€ï¼ŒSpring MVCçš„é»˜è®¤jsonè§£æå™¨ä¾¿æ˜¯Jacksonã€‚</p><p>Jacksonä¼˜ç‚¹å¾ˆå¤šï¼š</p><ol><li>Jackson æ‰€ä¾èµ–çš„jaråŒ…è¾ƒå°‘ï¼Œç®€å•æ˜“ç”¨ã€‚</li><li>ä¸å…¶ä»– Java çš„ json çš„æ¡†æ¶ Gson ç­‰ç›¸æ¯”ï¼ŒJackson è§£æå¤§çš„ json æ–‡ä»¶é€Ÿåº¦æ¯”è¾ƒå¿«ã€‚</li><li>Jackson è¿è¡Œæ—¶å ç”¨å†…å­˜æ¯”è¾ƒä½ï¼Œæ€§èƒ½æ¯”è¾ƒå¥½</li><li>Jackson æœ‰çµæ´»çš„ APIï¼Œå¯ä»¥å¾ˆå®¹æ˜“è¿›è¡Œæ‰©å±•å’Œå®šåˆ¶ã€‚</li></ol><p>ç›®å‰æœ€æ–°ç‰ˆæœ¬æ˜¯2.9.4ï¼ŒJackson çš„æ ¸å¿ƒæ¨¡å—ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼š</p><ol><li>jackson-core æ ¸å¿ƒåŒ…ï¼Œæä¾›åŸºäºâ€æµæ¨¡å¼â€è§£æçš„ç›¸å…³ APIï¼Œå®ƒåŒ…æ‹¬ JsonPaser å’Œ JsonGeneratorã€‚Jackson å†…éƒ¨å®ç°æ­£æ˜¯é€šè¿‡é«˜æ€§èƒ½çš„æµæ¨¡å¼ API çš„ JsonGenerator å’Œ JsonParser æ¥ç”Ÿæˆå’Œè§£æ jsonã€‚</li><li>jackson-annotations æ³¨è§£åŒ…ï¼Œæä¾›æ ‡å‡†æ³¨è§£åŠŸèƒ½ï¼›</li><li>jackson-databind æ•°æ®ç»‘å®šåŒ…ï¼Œæä¾›åŸºäºâ€å¯¹è±¡ç»‘å®šâ€ è§£æçš„ç›¸å…³ APIï¼ˆ ObjectMapper ï¼‰å’Œâ€æ ‘æ¨¡å‹â€ è§£æçš„ç›¸å…³ APIï¼ˆJsonNodeï¼‰ï¼›åŸºäºâ€å¯¹è±¡ç»‘å®šâ€ è§£æçš„ API å’Œâ€æ ‘æ¨¡å‹â€è§£æçš„ API ä¾èµ–åŸºäºâ€æµæ¨¡å¼â€è§£æçš„ APIã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å“ˆå¸Œè¡¨</title>
      <link href="/2023/01/05/%E5%93%88%E5%B8%8C%E8%A1%A8/"/>
      <url>/2023/01/05/%E5%93%88%E5%B8%8C%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<h3 id="åº”ç”¨åœºæ™¯ï¼š"><a href="#åº”ç”¨åœºæ™¯ï¼š" class="headerlink" title="åº”ç”¨åœºæ™¯ï¼š"></a>åº”ç”¨åœºæ™¯ï¼š</h3><p><strong>å½“æˆ‘ä»¬é‡åˆ°äº†è¦å¿«é€Ÿåˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å‡ºç°é›†åˆé‡Œçš„æ—¶å€™ï¼Œå°±è¦è€ƒè™‘å“ˆå¸Œæ³•</strong>ã€‚</p><p>ä½†æ˜¯å“ˆå¸Œæ³•ä¹Ÿæ˜¯<strong>ç‰ºç‰²äº†ç©ºé—´æ¢å–äº†æ—¶é—´</strong>ï¼Œå› ä¸ºæˆ‘ä»¬è¦ä½¿ç”¨é¢å¤–çš„æ•°ç»„ï¼Œsetæˆ–è€…æ˜¯mapæ¥å­˜æ”¾æ•°æ®ï¼Œæ‰èƒ½å®ç°å¿«é€Ÿçš„æŸ¥æ‰¾ã€‚</p><p>å¦‚æœåœ¨åšé¢è¯•é¢˜ç›®çš„æ—¶å€™é‡åˆ°éœ€è¦åˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦å‡ºç°è¿‡çš„åœºæ™¯ä¹Ÿåº”è¯¥ç¬¬ä¸€æ—¶é—´æƒ³åˆ°å“ˆå¸Œæ³•ï¼</p><h3 id="ä¾‹é¢˜1ï¼šæœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯242"><a href="#ä¾‹é¢˜1ï¼šæœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯242" class="headerlink" title="ä¾‹é¢˜1ï¼šæœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯242"></a>ä¾‹é¢˜1ï¼šæœ‰æ•ˆçš„å­—æ¯å¼‚ä½è¯242</h3><p>éšæƒ³å½•ï¼Œç”¨æ•°ç»„æ¨¡æ‹Ÿå“ˆå¸Œï¼Œæ•°ç»„çš„0åˆ°25ä½å­˜å‚¨å­—æ¯ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²è®©æ•°ç»„å¯¹åº”çš„ä½ç½®++ï¼Œç¬¬äºŒä¸ªå­—ç¬¦ä¸²è®©å¯¹åº”çš„ä½ç½®â€“ï¼Œæœ€ååˆ¤æ–­æ•°ç»„æ˜¯å¦éƒ½ä¸º0ï¼Œå¦‚æœæ˜¯ï¼Œè¯´æ˜æ˜¯å­—æ¯å¼‚ä½è¯ï¼Œå¦åˆ™è¯´æ˜ä¸æ˜¯ã€‚</p><blockquote><p>éœ€è¦æŠŠå­—ç¬¦æ˜ å°„åˆ°æ•°ç»„ä¹Ÿå°±æ˜¯å“ˆå¸Œè¡¨çš„ç´¢å¼•ä¸‹æ ‡ä¸Šï¼Œ<strong>å› ä¸ºå­—ç¬¦aåˆ°å­—ç¬¦zçš„ASCIIæ˜¯26ä¸ªè¿ç»­çš„æ•°å€¼ï¼Œæ‰€ä»¥å­—ç¬¦aæ˜ å°„ä¸ºä¸‹æ ‡0ï¼Œç›¸åº”çš„å­—ç¬¦zæ˜ å°„ä¸ºä¸‹æ ‡25ã€‚</strong></p><p>å†éå† å­—ç¬¦ä¸²sçš„æ—¶å€™ï¼Œ<strong>åªéœ€è¦å°† s[i] - â€˜aâ€™ æ‰€åœ¨çš„å…ƒç´ åš+1 æ“ä½œå³å¯ï¼Œå¹¶ä¸éœ€è¦è®°ä½å­—ç¬¦açš„ASCIIï¼Œåªè¦æ±‚å‡ºä¸€ä¸ªç›¸å¯¹æ•°å€¼å°±å¯ä»¥äº†ã€‚</strong> è¿™æ ·å°±å°†å­—ç¬¦ä¸²sä¸­å­—ç¬¦å‡ºç°çš„æ¬¡æ•°ï¼Œç»Ÿè®¡å‡ºæ¥äº†ã€‚</p><p>é‚£çœ‹ä¸€ä¸‹å¦‚ä½•æ£€æŸ¥å­—ç¬¦ä¸²tä¸­æ˜¯å¦å‡ºç°äº†è¿™äº›å­—ç¬¦ï¼ŒåŒæ ·åœ¨éå†å­—ç¬¦ä¸²tçš„æ—¶å€™ï¼Œå¯¹tä¸­å‡ºç°çš„å­—ç¬¦æ˜ å°„å“ˆå¸Œè¡¨ç´¢å¼•ä¸Šçš„æ•°å€¼å†åš-1çš„æ“ä½œã€‚</p><p>é‚£ä¹ˆæœ€åæ£€æŸ¥ä¸€ä¸‹ï¼Œ<strong>recordæ•°ç»„å¦‚æœæœ‰çš„å…ƒç´ ä¸ä¸ºé›¶0ï¼Œè¯´æ˜å­—ç¬¦ä¸²så’Œtä¸€å®šæ˜¯è°å¤šäº†å­—ç¬¦æˆ–è€…è°å°‘äº†å­—ç¬¦ï¼Œreturn falseã€‚</strong></p><p>æœ€åå¦‚æœrecordæ•°ç»„æ‰€æœ‰å…ƒç´ éƒ½ä¸ºé›¶0ï¼Œè¯´æ˜å­—ç¬¦ä¸²så’Œtæ˜¯å­—æ¯å¼‚ä½è¯ï¼Œreturn trueã€‚</p><p>æ—¶é—´å¤æ‚åº¦ä¸ºO(n)ï¼Œç©ºé—´ä¸Šå› ä¸ºå®šä¹‰æ˜¯çš„ä¸€ä¸ªå¸¸é‡å¤§å°çš„è¾…åŠ©æ•°ç»„ï¼Œæ‰€ä»¥ç©ºé—´å¤æ‚åº¦ä¸ºO(1)ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isAnagram</span><span class="params">(String s, String t)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] hash = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">26</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; s.length(); i++)&#123;</span><br><span class="line">            hash[s.charAt(i) - <span class="string">&#x27;a&#x27;</span>] ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; t.length(); i++)&#123;</span><br><span class="line">            hash[t.charAt(i) - <span class="string">&#x27;a&#x27;</span>] --;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(hash[i] != <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¾‹é¢˜2ï¼šä¸¤ä¸ªæ•°ç»„çš„äº¤é›†349"><a href="#ä¾‹é¢˜2ï¼šä¸¤ä¸ªæ•°ç»„çš„äº¤é›†349" class="headerlink" title="ä¾‹é¢˜2ï¼šä¸¤ä¸ªæ•°ç»„çš„äº¤é›†349"></a>ä¾‹é¢˜2ï¼šä¸¤ä¸ªæ•°ç»„çš„äº¤é›†349</h3><p>è§£æ³•1ï¼šæ•°ç»„</p><ul><li>ç¬¬ä¸€ä¸ªæ•°ç»„ä¸­å‡ºç°çš„æ•°å¯¹åº”æ•°ç»„ä½ç½®å€¼æ”¹ä¸º1</li><li>å¦‚æœæ•°ç»„2çš„æ•°å€¼åœ¨hashæ•°ç»„ä¸­çš„å€¼ä¸º1ï¼Œè¯´æ˜åœ¨æ•°ç»„1ä¸­å‡ºç°è¿‡ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœä¸­</li><li>å°†seté›†åˆé€šè¿‡streamæµè½¬æ¢ä¸ºæ•°ç»„</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] intersection(<span class="type">int</span>[] nums1, <span class="type">int</span>[] nums2) &#123;</span><br><span class="line">        <span class="type">int</span>[] hash = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">1010</span>];</span><br><span class="line">        Set&lt;Integer&gt; result = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//ç¬¬ä¸€ä¸ªæ•°ç»„ä¸­å‡ºç°çš„æ•°å¯¹åº”æ•°ç»„ä½ç½®å€¼æ”¹ä¸º1</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums1.length; i++) &#123;</span><br><span class="line">            hash[nums1[i]] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; nums2.length; i++) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœæ•°ç»„2çš„æ•°ä¸º1ï¼Œè¯´æ˜åœ¨æ•°ç»„1ä¸­å‡ºç°è¿‡ï¼Œå°†å…¶æ·»åŠ åˆ°ç»“æœä¸­</span></span><br><span class="line">            <span class="keyword">if</span> (hash[nums2[i]] == <span class="number">1</span>)&#123;</span><br><span class="line">                result.add(nums2[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å°†seté›†åˆè½¬æ¢ä¸ºæ•°ç»„</span></span><br><span class="line">        <span class="keyword">return</span> result.stream().mapToInt(x -&gt; x).toArray();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£æ³•2ï¼šsetä½œä¸ºå“ˆå¸Œç»“æ„å­˜å‚¨å…ƒç´ </p><ul><li>å…ˆå®šä¹‰ä¸€ä¸ªsetç»“æ„çš„å“ˆå¸Œè¡¨å­˜å‚¨æ•°ç»„1ä¸­çš„å…ƒç´ </li><li>å¦‚æœå“ˆå¸Œè¡¨ä¸­åŒ…å«æ•°ç»„2ä¸­çš„å…ƒç´ ï¼Œåˆ™å°†æ•°ç»„2çš„è¿™ä¸ªå…ƒç´ æ”¾å…¥ç»“æœsetä¸­ï¼Œæ–¹ä¾¿å»é‡</li><li>é€šè¿‡streamæµå°†seté›†åˆè½¬æ¢ä¸ºæ•°ç»„è¾“å‡º</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] intersection(<span class="type">int</span>[] nums1, <span class="type">int</span>[] nums2) &#123;</span><br><span class="line">        HashSet&lt;Integer&gt; hashSet = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">        HashSet&lt;Integer&gt; result = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å…ˆå®šä¹‰ä¸€ä¸ªsetç»“æ„çš„å“ˆå¸Œè¡¨å­˜å‚¨æ•°ç»„1ä¸­çš„å…ƒç´ </span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num1 : nums1) &#123;</span><br><span class="line">            hashSet.add(num1);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœå“ˆå¸Œè¡¨ä¸­åŒ…å«æ•°ç»„2ä¸­çš„å…ƒç´ ï¼Œåˆ™å°†æ•°ç»„2çš„è¿™ä¸ªå…ƒç´ æ”¾å…¥ç»“æœsetä¸­ï¼Œæ–¹ä¾¿å»é‡</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> num2 : nums2) &#123;</span><br><span class="line">            <span class="keyword">if</span> (hashSet.contains(num2))&#123;</span><br><span class="line">                result.add(num2);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é€šè¿‡streamæµå°†seté›†åˆè½¬æ¢ä¸ºæ•°ç»„è¾“å‡º</span></span><br><span class="line">        <span class="keyword">return</span> result.stream().mapToInt(x -&gt; x).toArray();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é“¾è¡¨</title>
      <link href="/2022/12/26/%E9%93%BE%E8%A1%A8/"/>
      <url>/2022/12/26/%E9%93%BE%E8%A1%A8/</url>
      
        <content type="html"><![CDATA[<p>æ€ç»´å¯¼å›¾ï¼š</p><p><img src="/2022/12/26/%E9%93%BE%E8%A1%A8/%E9%93%BE%E8%A1%A8.png"></p><h3 id="ä¾‹é¢˜1ï¼šç§»é™¤é“¾è¡¨å…ƒç´ 203"><a href="#ä¾‹é¢˜1ï¼šç§»é™¤é“¾è¡¨å…ƒç´ 203" class="headerlink" title="ä¾‹é¢˜1ï¼šç§»é™¤é“¾è¡¨å…ƒç´ 203"></a>ä¾‹é¢˜1ï¼šç§»é™¤é“¾è¡¨å…ƒç´ 203</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ·»åŠ è™šæ‹Ÿå¤´èŠ‚ç‚¹æ–¹å¼</span></span><br><span class="line"><span class="comment"> * æ—¶é—´å¤æ‚åº¦ O(n)</span></span><br><span class="line"><span class="comment"> * ç©ºé—´å¤æ‚åº¦ O(1)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> head</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> val</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">removeElements</span><span class="params">(ListNode head, <span class="type">int</span> val)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (head == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å› ä¸ºåˆ é™¤å¯èƒ½æ¶‰åŠåˆ°å¤´èŠ‚ç‚¹ï¼Œæ‰€ä»¥è®¾ç½®dummyèŠ‚ç‚¹ï¼Œç»Ÿä¸€æ“ä½œ</span></span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">dummy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(-<span class="number">1</span>, head);</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> dummy;<span class="comment">//ä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆ</span></span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> head;<span class="comment">//å½“å‰èŠ‚ç‚¹çš„æŒ‡é’ˆ</span></span><br><span class="line">    <span class="keyword">while</span> (cur != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (cur.val == val) &#123;<span class="comment">//å¦‚æœæ˜¯è¦åˆ é™¤çš„å…ƒç´ ï¼Œè®©ä¸Šä¸€ä¸ªèŠ‚ç‚¹çš„nextæŒ‡é’ˆæŒ‡å‘å½“å‰èŠ‚ç‚¹çš„next</span></span><br><span class="line">            pre.next = cur.next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            pre = cur;<span class="comment">//å¦‚æœä¸æ˜¯è¦åˆ é™¤çš„å…ƒç´ ï¼Œè®©ä¸Šä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘æœ¬èŠ‚ç‚¹</span></span><br><span class="line">        &#125;</span><br><span class="line">        cur = cur.next;<span class="comment">//ä¸ç®¡æ€æ ·ï¼ŒæŒ‡é’ˆéƒ½è¦æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//æœ€åè¿”å›è™šæ‹Ÿå¤´ç»“ç‚¹çš„nextï¼Œå› ä¸ºheadèŠ‚ç‚¹å¯èƒ½å·²ç»è¢«åˆ é™¤äº†</span></span><br><span class="line">    <span class="keyword">return</span> dummy.next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">removeElements</span><span class="params">(ListNode head, <span class="type">int</span> val)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">dummyhead</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(-<span class="number">1</span>,head);</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> dummyhead;</span><br><span class="line">        <span class="keyword">while</span>(cur.next != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(cur.next.val == val)&#123;</span><br><span class="line">                cur.next = cur.next.next;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                cur = cur.next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dummyhead.next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¸æ·»åŠ è™šæ‹ŸèŠ‚ç‚¹æ–¹å¼</span></span><br><span class="line"><span class="comment"> * æ—¶é—´å¤æ‚åº¦ O(n)</span></span><br><span class="line"><span class="comment"> * ç©ºé—´å¤æ‚åº¦ O(1)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> head</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> val</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">removeElements</span><span class="params">(ListNode head, <span class="type">int</span> val)</span> &#123;</span><br><span class="line">    <span class="keyword">while</span> (head != <span class="literal">null</span> &amp;&amp; head.val == val) &#123;</span><br><span class="line">        head = head.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å·²ç»ä¸ºnullï¼Œæå‰é€€å‡º</span></span><br><span class="line">    <span class="keyword">if</span> (head == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å·²ç¡®å®šå½“å‰head.val != val</span></span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> head;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> head.next;</span><br><span class="line">    <span class="keyword">while</span> (cur != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (cur.val == val) &#123;</span><br><span class="line">            pre.next = cur.next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            pre = cur;</span><br><span class="line">        &#125;</span><br><span class="line">        cur = cur.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¸æ·»åŠ è™šæ‹ŸèŠ‚ç‚¹and pre Nodeæ–¹å¼</span></span><br><span class="line"><span class="comment"> * æ—¶é—´å¤æ‚åº¦ O(n)</span></span><br><span class="line"><span class="comment"> * ç©ºé—´å¤æ‚åº¦ O(1)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> head</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> val</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> ListNode <span class="title function_">removeElements</span><span class="params">(ListNode head, <span class="type">int</span> val)</span> &#123;</span><br><span class="line">    <span class="keyword">while</span>(head!=<span class="literal">null</span> &amp;&amp; head.val==val)&#123;</span><br><span class="line">        head = head.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">ListNode</span> <span class="variable">curr</span> <span class="operator">=</span> head;</span><br><span class="line">    <span class="keyword">while</span>(curr!=<span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="keyword">while</span>(curr.next!=<span class="literal">null</span> &amp;&amp; curr.next.val == val)&#123;</span><br><span class="line">            curr.next = curr.next.next;</span><br><span class="line">        &#125;</span><br><span class="line">        curr = curr.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¾‹é¢˜2ï¼šè®¾è®¡é“¾è¡¨707"><a href="#ä¾‹é¢˜2ï¼šè®¾è®¡é“¾è¡¨707" class="headerlink" title="ä¾‹é¢˜2ï¼šè®¾è®¡é“¾è¡¨707"></a>ä¾‹é¢˜2ï¼šè®¾è®¡é“¾è¡¨707</h3><blockquote><p>é‡ç‚¹ï¼šæ‰¾åˆ°æ’å…¥çš„ä½ç½®ï¼Œå‰é©±</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å•é“¾è¡¨æ–¹å¼è®¾è®¡é“¾è¡¨</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyLinkedList</span> &#123;</span><br><span class="line">    <span class="comment">//å®šä¹‰é“¾è¡¨çš„å¤§å°</span></span><br><span class="line">    <span class="type">int</span> size;</span><br><span class="line">    <span class="comment">//å®šä¹‰è™šæ‹Ÿå¤´ç»“ç‚¹</span></span><br><span class="line">    ListNode dummy;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åˆå§‹åŒ–é“¾è¡¨</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MyLinkedList</span><span class="params">()</span> &#123;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">        dummy = <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//æŸ¥è¯¢èŠ‚ç‚¹å€¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">get</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">currentNode</span> <span class="operator">=</span> dummy;</span><br><span class="line">        <span class="keyword">if</span>(index &lt; <span class="number">0</span> || index &gt;= size)&#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ‰¾åˆ°è¦æŸ¥è¯¢æ•°å€¼å¤§å°çš„ä½ç½®</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;= index; i++)&#123;</span><br><span class="line">            currentNode = currentNode.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//è¿”å›ç»“æœå€¼</span></span><br><span class="line">        <span class="keyword">return</span> currentNode.val;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addAtHead</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">        addAtIndex(<span class="number">0</span>,val);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addAtTail</span><span class="params">(<span class="type">int</span> val)</span> &#123;</span><br><span class="line">        addAtIndex(size,val);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// é“¾è¡¨åœ¨æŒ‡å®šä½ç½®æ’å…¥èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addAtIndex</span><span class="params">(<span class="type">int</span> index, <span class="type">int</span> val)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(index &gt; size)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(index &lt; <span class="number">0</span>)&#123;</span><br><span class="line">            index = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        size++;</span><br><span class="line">        <span class="comment">// æ‰¾åˆ°è¦æ’å…¥å…ƒç´ çš„å‰é©±ï¼Œç¡®å®šæ’å…¥ä½ç½®</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">pred</span> <span class="operator">=</span> dummy;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index; i++)&#123;</span><br><span class="line">            pred = pred.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">newNode</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(val);</span><br><span class="line">        newNode.next = pred.next;</span><br><span class="line">        pred.next = newNode;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// é“¾è¡¨åœ¨æŒ‡å®šä½ç½®åˆ é™¤èŠ‚ç‚¹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteAtIndex</span><span class="params">(<span class="type">int</span> index)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(index &lt; <span class="number">0</span> || index &gt;= size)&#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        size --;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">pred</span> <span class="operator">=</span> dummy;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; index; i++)&#123;</span><br><span class="line">            pred = pred.next;</span><br><span class="line">        &#125;</span><br><span class="line">        pred.next = pred.next.next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¾‹é¢˜3ï¼šç¿»è½¬é“¾è¡¨206"><a href="#ä¾‹é¢˜3ï¼šç¿»è½¬é“¾è¡¨206" class="headerlink" title="ä¾‹é¢˜3ï¼šç¿»è½¬é“¾è¡¨206"></a>ä¾‹é¢˜3ï¼šç¿»è½¬é“¾è¡¨206</h3><p>æ–¹æ³•1ï¼šåŒæŒ‡é’ˆ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">reverseList</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">        <span class="comment">//é¦–å…ˆå®šä¹‰ä¸€ä¸ªcuræŒ‡é’ˆï¼ŒæŒ‡å‘å¤´ç»“ç‚¹</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="comment">//å†å®šä¹‰ä¸€ä¸ªpreæŒ‡é’ˆï¼Œåˆå§‹åŒ–ä¸ºnullã€‚</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">pre</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">while</span>(cur != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//å¼€å§‹é“¾è¡¨ç¿»è½¬ï¼Œ</span></span><br><span class="line">            <span class="comment">//é¦–å…ˆè¦æŠŠ cur-&gt;next èŠ‚ç‚¹ç”¨tmpæŒ‡é’ˆä¿å­˜ä¸€ä¸‹</span></span><br><span class="line">            <span class="type">ListNode</span> <span class="variable">temp</span> <span class="operator">=</span> cur.next;</span><br><span class="line">            <span class="comment">//æ¥ä¸‹æ¥è¦æ”¹å˜ cur-&gt;next çš„æŒ‡å‘</span></span><br><span class="line">            cur.next = pre;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//å¾ªç¯ç»§ç»­ç§»åŠ¨preå’ŒcuræŒ‡é’ˆ</span></span><br><span class="line">            pre = cur;</span><br><span class="line">            cur = temp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//preæŒ‡é’ˆå°±æŒ‡å‘äº†æ–°çš„å¤´ç»“ç‚¹</span></span><br><span class="line">        <span class="keyword">return</span> pre;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ–¹æ³•2ï¼šé€’å½’</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">reverseList</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> reverse(head,<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">reverse</span><span class="params">(ListNode cur,ListNode pre)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(cur == <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> pre;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">temp</span> <span class="operator">=</span> cur.next;</span><br><span class="line">        cur.next = pre;</span><br><span class="line">        <span class="keyword">return</span> reverse(temp,cur);       </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¾‹é¢˜4ï¼šä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹24"><a href="#ä¾‹é¢˜4ï¼šä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹24" class="headerlink" title="ä¾‹é¢˜4ï¼šä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹24"></a>ä¾‹é¢˜4ï¼šä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹24</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">swapPairs</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">        <span class="comment">//å®šä¹‰è™šæ‹Ÿå¤´ç»“ç‚¹å¹¶æŒ‡å®šå…¶nextæŒ‡é’ˆä¸ºhead</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">dummyhead</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">        dummyhead.next = head;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å®šä¹‰ä¸€ä¸ªæŒ‡å‘å½“å‰èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œåˆå§‹æŒ‡å‘è™šæ‹Ÿå¤´ç»“ç‚¹</span></span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">cur</span> <span class="operator">=</span> dummyhead;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç»ˆæ­¢æ¡ä»¶ï¼Œé¡ºåºä¸èƒ½åï¼Œé¿å…å‡ºç°ç©ºæŒ‡é’ˆ</span></span><br><span class="line">        <span class="keyword">while</span>(cur.next != <span class="literal">null</span> &amp;&amp; cur.next.next != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="comment">//å®šä¹‰ä¸¤ä¸ªä¸´æ—¶èŠ‚ç‚¹ï¼Œç”¨æ¥å­˜å‚¨ç¬¬ä¸€ä¸ªå’Œç¬¬ä¸‰ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">            <span class="type">ListNode</span> <span class="variable">temp</span> <span class="operator">=</span> cur.next;</span><br><span class="line">            <span class="type">ListNode</span> <span class="variable">temp1</span> <span class="operator">=</span> cur.next.next.next;</span><br><span class="line">            cur.next = cur.next.next;<span class="comment">//æ­¥éª¤1ï¼Œç”±è™šæ‹Ÿå¤´ç»“ç‚¹æŒ‡å‘2èŠ‚ç‚¹</span></span><br><span class="line">            cur.next.next = temp;<span class="comment">//æ­¥éª¤2ï¼Œç”±2èŠ‚ç‚¹æŒ‡å‘1èŠ‚ç‚¹</span></span><br><span class="line">            temp.next = temp1;<span class="comment">//æ­¥éª¤3ï¼Œç”±1èŠ‚ç‚¹æŒ‡å‘3èŠ‚ç‚¹</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">//ç§»åŠ¨curæŒ‡é’ˆ</span></span><br><span class="line">            cur = cur.next.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dummyhead.next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¾‹é¢˜5ï¼šåˆ é™¤é“¾è¡¨ä¸­çš„å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹19"><a href="#ä¾‹é¢˜5ï¼šåˆ é™¤é“¾è¡¨ä¸­çš„å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹19" class="headerlink" title="ä¾‹é¢˜5ï¼šåˆ é™¤é“¾è¡¨ä¸­çš„å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹19"></a>ä¾‹é¢˜5ï¼šåˆ é™¤é“¾è¡¨ä¸­çš„å€’æ•°ç¬¬Nä¸ªèŠ‚ç‚¹19</h3><p>åˆ©ç”¨å¿«æ…¢æŒ‡é’ˆï¼š</p><ol><li>å…ˆè®©å¿«æŒ‡é’ˆç§»åŠ¨n+1æ­¥åï¼Œè®©å¿«æ…¢æŒ‡é’ˆåŒæ—¶ç§»åŠ¨</li><li>å½“å¿«æŒ‡é’ˆç§»åŠ¨åˆ°ç©ºèŠ‚ç‚¹æ—¶ï¼Œæ…¢æŒ‡é’ˆæ­£å¥½ç§»åŠ¨åˆ°è¦åˆ é™¤èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹</li><li>è®©æ…¢æŒ‡é’ˆçš„slow.next &#x3D; slow.next.nextï¼Œåˆ é™¤è¯¥å…ƒç´ </li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">removeNthFromEnd</span><span class="params">(ListNode head, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">dummyhead</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">        dummyhead.next = head;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">fast</span> <span class="operator">=</span> dummyhead;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">slow</span> <span class="operator">=</span> dummyhead;</span><br><span class="line">        </span><br><span class="line">        n++;</span><br><span class="line">        <span class="comment">//å…ˆè®©å¿«æŒ‡é’ˆç§»åŠ¨n+1æ­¥</span></span><br><span class="line">        <span class="keyword">while</span>(n--&gt;<span class="number">0</span> &amp;&amp; fast != <span class="literal">null</span>)&#123;</span><br><span class="line">            fast = fast.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å¿«æ…¢æŒ‡é’ˆåŒæ—¶ç§»åŠ¨åˆ°å¿«æŒ‡é’ˆæŒ‡åˆ°null</span></span><br><span class="line">        <span class="keyword">while</span>(fast != <span class="literal">null</span>)&#123;</span><br><span class="line">            fast = fast.next;</span><br><span class="line">            slow =slow.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æ‰¾åˆ°äº†è¦åˆ é™¤èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ä½ç½®å³ä¸ºslow</span></span><br><span class="line">        slow.next = slow.next.next;</span><br><span class="line">        <span class="keyword">return</span> dummyhead.next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¾‹é¢˜6ï¼šç›¸äº¤é“¾è¡¨160"><a href="#ä¾‹é¢˜6ï¼šç›¸äº¤é“¾è¡¨160" class="headerlink" title="ä¾‹é¢˜6ï¼šç›¸äº¤é“¾è¡¨160"></a>ä¾‹é¢˜6ï¼šç›¸äº¤é“¾è¡¨160</h3><p>è§£æ³•1ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">getIntersectionNode</span><span class="params">(ListNode headA, ListNode headB)</span> &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">p</span> <span class="operator">=</span> headA;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">q</span> <span class="operator">=</span> headB;</span><br><span class="line">        <span class="keyword">while</span>(p != q)&#123;</span><br><span class="line">            <span class="comment">// å¦‚æœæ²¡æœ‰èµ°åˆ°ç¬¬ä¸€ä¸ªé“¾è¡¨çš„æœ«å°¾ï¼Œåˆ™åç§»ä¸€ä½ï¼Œå¦åˆ™æŒ‡å‘å¦ä¸€ä¸ªé“¾è¡¨çš„å¤´</span></span><br><span class="line">            <span class="keyword">if</span>(p != <span class="literal">null</span>)&#123;</span><br><span class="line">                p = p.next;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                p = headB;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//p = p != null ? p.next : headB;</span></span><br><span class="line">            q = q != <span class="literal">null</span> ? q.next : headA;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§£æ³•2ï¼š</p><p>å…ˆè®¡ç®—ä¸¤ä¸ªé“¾è¡¨çš„é•¿åº¦ï¼Œå°†é•¿é“¾è¡¨å…ˆç§»åŠ¨åˆ°å’ŒçŸ­é“¾è¡¨ç›¸åŒçš„ä½ç½®ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦ä¸¤ä¸ªèŠ‚ç‚¹ç›¸ç­‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">getIntersectionNode</span><span class="params">(ListNode headA, ListNode headB)</span> &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">curA</span> <span class="operator">=</span> headA;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">curB</span> <span class="operator">=</span> headB;</span><br><span class="line">        <span class="type">int</span> <span class="variable">lenA</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">lenB</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//è®¡ç®—å‡ºé“¾è¡¨Aå’ŒBçš„é•¿åº¦</span></span><br><span class="line">        <span class="keyword">while</span>(curA != <span class="literal">null</span>)&#123;</span><br><span class="line">            lenA++;</span><br><span class="line">            curA = curA.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(curB != <span class="literal">null</span>)&#123;</span><br><span class="line">            lenB++;</span><br><span class="line">            curB = curB.next;</span><br><span class="line">        &#125;</span><br><span class="line">        curA = headA;</span><br><span class="line">        curB = headB;</span><br><span class="line">        <span class="comment">//è®©curAæŒ‡å‘é•¿çš„ä¸€ä¸ªé“¾è¡¨,äº¤æ¢é¡ºåº</span></span><br><span class="line">        <span class="keyword">if</span>(lenA &lt; lenB)&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">tempLen</span> <span class="operator">=</span> lenB;</span><br><span class="line">            lenB = lenA;</span><br><span class="line">            lenA  = tempLen;</span><br><span class="line">            </span><br><span class="line">            <span class="type">ListNode</span> <span class="variable">tempNode</span> <span class="operator">=</span> curB;</span><br><span class="line">            curB = curA;</span><br><span class="line">            curA = tempNode;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ±‚å‡ºé•¿åº¦å·®</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">gap</span> <span class="operator">=</span> lenA - lenB;</span><br><span class="line">        <span class="comment">//è®©curAå’ŒcurBåœ¨åŒä¸€èµ·ç‚¹ä¸Šï¼ˆæœ«å°¾ä½ç½®å¯¹é½ï¼‰</span></span><br><span class="line">        <span class="keyword">while</span>(gap-- &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            curA = curA.next;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//éå†curA å’Œ curBï¼Œé‡åˆ°ç›¸åŒåˆ™ç›´æ¥è¿”å›</span></span><br><span class="line">        <span class="keyword">while</span>(curA != <span class="literal">null</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(curA == curB)&#123;</span><br><span class="line">                <span class="keyword">return</span> curA;</span><br><span class="line">            &#125;</span><br><span class="line">            curA = curA.next;</span><br><span class="line">            curB = curB.next;   </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ä¾‹é¢˜7ï¼šç¯å½¢é“¾è¡¨â…¡-142"><a href="#ä¾‹é¢˜7ï¼šç¯å½¢é“¾è¡¨â…¡-142" class="headerlink" title="ä¾‹é¢˜7ï¼šç¯å½¢é“¾è¡¨â…¡ 142"></a>ä¾‹é¢˜7ï¼šç¯å½¢é“¾è¡¨â…¡ 142</h3><p>ä¸»è¦è€ƒå¯Ÿä¸¤çŸ¥è¯†ç‚¹ï¼š</p><ul><li><p>åˆ¤æ–­é“¾è¡¨æ˜¯å¦ç¯</p><p>é€šè¿‡å®šä¹‰å¿«æ…¢æŒ‡é’ˆï¼Œè®©å¿«æŒ‡é’ˆç§»åŠ¨é€Ÿåº¦æ˜¯æ…¢æŒ‡é’ˆçš„ä¸¤å€ï¼Œè‹¥å¿«æ…¢æŒ‡é’ˆå¯ä»¥ç›¸é‡ï¼Œè¯´æ˜ä¸€å®šæœ‰ç¯</p></li><li><p>å¦‚æœæœ‰ç¯ï¼Œå¦‚ä½•æ‰¾åˆ°è¿™ä¸ªç¯çš„å…¥å£</p><p>å¿«æ…¢æŒ‡é’ˆç›¸é‡åï¼Œå®šä¹‰ä¸¤ä¸ªæŒ‡é’ˆï¼Œä¸€ä¸ªæŒ‡å‘ç›¸é‡ç‚¹ï¼Œå¦ä¸€ä¸ªæŒ‡å‘headï¼Œä¸¤ä¸ªæŒ‡é’ˆç›¸é‡çš„ç‚¹å³æ˜¯ç¯çš„å…¥å£</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> ListNode <span class="title function_">detectCycle</span><span class="params">(ListNode head)</span> &#123;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">fast</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="type">ListNode</span> <span class="variable">slow</span> <span class="operator">=</span> head;</span><br><span class="line">        <span class="keyword">while</span>(fast != <span class="literal">null</span> &amp;&amp; fast.next != <span class="literal">null</span>)&#123;</span><br><span class="line">            fast = fast.next.next;</span><br><span class="line">            slow = slow.next;</span><br><span class="line">            <span class="keyword">if</span>(fast == slow)&#123;</span><br><span class="line">                <span class="type">ListNode</span> <span class="variable">index1</span> <span class="operator">=</span> fast;</span><br><span class="line">                <span class="type">ListNode</span> <span class="variable">index2</span> <span class="operator">=</span> head;</span><br><span class="line">                <span class="keyword">while</span>(index1 != index2)&#123;</span><br><span class="line">                    index1 = index1.next;</span><br><span class="line">                    index2 = index2.next;                   </span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> index1;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å»ºé€ è€…æ¨¡å¼</title>
      <link href="/2022/12/23/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/"/>
      <url>/2022/12/23/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="4-å»ºé€ è€…æ¨¡å¼"><a href="#4-å»ºé€ è€…æ¨¡å¼" class="headerlink" title="4. å»ºé€ è€…æ¨¡å¼"></a>4. å»ºé€ è€…æ¨¡å¼</h2><h3 id="4-1-æ¦‚è¿°"><a href="#4-1-æ¦‚è¿°" class="headerlink" title="4.1 æ¦‚è¿°"></a>4.1 æ¦‚è¿°</h3><p>å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚</p><img src="/2022/12/23/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/../../java/èµ„æ–™/javaè®¾è®¡æ¨¡å¼ï¼ˆå›¾è§£+æ¡†æ¶æºç åˆ†æ+å®æˆ˜ï¼‰/Javaè®¾è®¡æ¨¡å¼èµ„æ–™day02/ç¬”è®°/img/image-20200413225341516.png" style="zoom:60%;"><ul><li>åˆ†ç¦»äº†éƒ¨ä»¶çš„æ„é€ (ç”±Builderæ¥è´Ÿè´£)å’Œè£…é…(ç”±Directorè´Ÿè´£)ã€‚ ä»è€Œå¯ä»¥æ„é€ å‡ºå¤æ‚çš„å¯¹è±¡ã€‚è¿™ä¸ªæ¨¡å¼é€‚ç”¨äºï¼šæŸä¸ªå¯¹è±¡çš„æ„å»ºè¿‡ç¨‹å¤æ‚çš„æƒ…å†µã€‚</li><li>ç”±äºå®ç°äº†æ„å»ºå’Œè£…é…çš„è§£è€¦ã€‚ä¸åŒçš„æ„å»ºå™¨ï¼Œç›¸åŒçš„è£…é…ï¼Œä¹Ÿå¯ä»¥åšå‡ºä¸åŒçš„å¯¹è±¡ï¼›ç›¸åŒçš„æ„å»ºå™¨ï¼Œä¸åŒçš„è£…é…é¡ºåºä¹Ÿå¯ä»¥åšå‡ºä¸åŒçš„å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯å®ç°äº†æ„å»ºç®—æ³•ã€è£…é…ç®—æ³•çš„è§£è€¦ï¼Œå®ç°äº†æ›´å¥½çš„å¤ç”¨ã€‚</li><li>å»ºé€ è€…æ¨¡å¼å¯ä»¥å°†éƒ¨ä»¶å’Œå…¶ç»„è£…è¿‡ç¨‹åˆ†å¼€ï¼Œä¸€æ­¥ä¸€æ­¥åˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ã€‚ç”¨æˆ·åªéœ€è¦æŒ‡å®šå¤æ‚å¯¹è±¡çš„ç±»å‹å°±å¯ä»¥å¾—åˆ°è¯¥å¯¹è±¡ï¼Œè€Œæ— é¡»çŸ¥é“å…¶å†…éƒ¨çš„å…·ä½“æ„é€ ç»†èŠ‚ã€‚</li></ul><h3 id="4-2-ç»“æ„"><a href="#4-2-ç»“æ„" class="headerlink" title="4.2 ç»“æ„"></a>4.2 ç»“æ„</h3><p>å»ºé€ è€…ï¼ˆBuilderï¼‰æ¨¡å¼åŒ…å«å¦‚ä¸‹è§’è‰²ï¼š</p><ul><li><p>æŠ½è±¡å»ºé€ è€…ç±»ï¼ˆBuilderï¼‰ï¼šè¿™ä¸ªæ¥å£è§„å®šè¦å®ç°å¤æ‚å¯¹è±¡çš„é‚£äº›éƒ¨åˆ†çš„åˆ›å»ºï¼Œå¹¶ä¸æ¶‰åŠå…·ä½“çš„éƒ¨ä»¶å¯¹è±¡çš„åˆ›å»ºã€‚ </p></li><li><p>å…·ä½“å»ºé€ è€…ç±»ï¼ˆConcreteBuilderï¼‰ï¼šå®ç° Builder æ¥å£ï¼Œå®Œæˆå¤æ‚äº§å“çš„å„ä¸ªéƒ¨ä»¶çš„å…·ä½“åˆ›å»ºæ–¹æ³•ã€‚åœ¨æ„é€ è¿‡ç¨‹å®Œæˆåï¼Œæä¾›äº§å“çš„å®ä¾‹ã€‚ </p></li><li><p>äº§å“ç±»ï¼ˆProductï¼‰ï¼šè¦åˆ›å»ºçš„å¤æ‚å¯¹è±¡ã€‚</p></li><li><p>æŒ‡æŒ¥è€…ç±»ï¼ˆDirectorï¼‰ï¼šè°ƒç”¨å…·ä½“å»ºé€ è€…æ¥åˆ›å»ºå¤æ‚å¯¹è±¡çš„å„ä¸ªéƒ¨åˆ†ï¼Œåœ¨æŒ‡å¯¼è€…ä¸­ä¸æ¶‰åŠå…·ä½“äº§å“çš„ä¿¡æ¯ï¼Œåªè´Ÿè´£ä¿è¯å¯¹è±¡å„éƒ¨åˆ†å®Œæ•´åˆ›å»ºæˆ–æŒ‰æŸç§é¡ºåºåˆ›å»ºã€‚</p></li></ul><p>ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/2022/12/23/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/../../java/èµ„æ–™/javaè®¾è®¡æ¨¡å¼ï¼ˆå›¾è§£+æ¡†æ¶æºç åˆ†æ+å®æˆ˜ï¼‰/Javaè®¾è®¡æ¨¡å¼èµ„æ–™day02/ç¬”è®°/img/å»ºé€ è€…æ¨¡å¼.png" style="zoom:80%;"><h3 id="4-3-å®ä¾‹"><a href="#4-3-å®ä¾‹" class="headerlink" title="4.3 å®ä¾‹"></a>4.3 å®ä¾‹</h3><p><strong>åˆ›å»ºå…±äº«å•è½¦</strong></p><p>ç”Ÿäº§è‡ªè¡Œè½¦æ˜¯ä¸€ä¸ªå¤æ‚çš„è¿‡ç¨‹ï¼Œå®ƒåŒ…å«äº†è½¦æ¶ï¼Œè½¦åº§ç­‰ç»„ä»¶çš„ç”Ÿäº§ã€‚è€Œè½¦æ¶åˆæœ‰ç¢³çº¤ç»´ï¼Œé“åˆé‡‘ç­‰æè´¨çš„ï¼Œè½¦åº§æœ‰æ©¡èƒ¶ï¼ŒçœŸçš®ç­‰æè´¨ã€‚å¯¹äºè‡ªè¡Œè½¦çš„ç”Ÿäº§å°±å¯ä»¥ä½¿ç”¨å»ºé€ è€…æ¨¡å¼ã€‚</p><p>è¿™é‡ŒBikeæ˜¯äº§å“ï¼ŒåŒ…å«è½¦æ¶ï¼Œè½¦åº§ç­‰ç»„ä»¶ï¼›Builderæ˜¯æŠ½è±¡å»ºé€ è€…ï¼ŒMobikeBuilderå’ŒOfoBuilderæ˜¯å…·ä½“çš„å»ºé€ è€…ï¼›Directoræ˜¯æŒ‡æŒ¥è€…ã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/2022/12/23/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F/../../java/èµ„æ–™/javaè®¾è®¡æ¨¡å¼ï¼ˆå›¾è§£+æ¡†æ¶æºç åˆ†æ+å®æˆ˜ï¼‰/Javaè®¾è®¡æ¨¡å¼èµ„æ–™day02/ç¬”è®°/img/å»ºé€ è€…æ¨¡å¼1.png" style="zoom:80%;"><p>å…·ä½“çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è‡ªè¡Œè½¦ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Bike</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String frame;</span><br><span class="line">    <span class="keyword">private</span> String seat;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getFrame</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> frame;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFrame</span><span class="params">(String frame)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.frame = frame;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getSeat</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> seat;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSeat</span><span class="params">(String seat)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.seat = seat;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŠ½è±¡ builder ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">Bike</span> <span class="variable">mBike</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bike</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">buildFrame</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">buildSeat</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> Bike <span class="title function_">createBike</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ‘©æ‹œå•è½¦Builderç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MobikeBuilder</span> <span class="keyword">extends</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">buildFrame</span><span class="params">()</span> &#123;</span><br><span class="line">        mBike.setFrame(<span class="string">&quot;é“åˆé‡‘è½¦æ¶&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">buildSeat</span><span class="params">()</span> &#123;</span><br><span class="line">        mBike.setSeat(<span class="string">&quot;çœŸçš®è½¦åº§&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Bike <span class="title function_">createBike</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mBike;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ofoå•è½¦Builderç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OfoBuilder</span> <span class="keyword">extends</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">buildFrame</span><span class="params">()</span> &#123;</span><br><span class="line">        mBike.setFrame(<span class="string">&quot;ç¢³çº¤ç»´è½¦æ¶&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">buildSeat</span><span class="params">()</span> &#123;</span><br><span class="line">        mBike.setSeat(<span class="string">&quot;æ©¡èƒ¶è½¦åº§&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Bike <span class="title function_">createBike</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mBike;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æŒ‡æŒ¥è€…ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Director</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Builder mBuilder;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Director</span><span class="params">(Builder builder)</span> &#123;</span><br><span class="line">        mBuilder = builder;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Bike <span class="title function_">construct</span><span class="params">()</span> &#123;</span><br><span class="line">        mBuilder.buildFrame();</span><br><span class="line">        mBuilder.buildSeat();</span><br><span class="line">        <span class="keyword">return</span> mBuilder.createBike();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        showBike(<span class="keyword">new</span> <span class="title class_">OfoBuilder</span>());</span><br><span class="line">        showBike(<span class="keyword">new</span> <span class="title class_">MobikeBuilder</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">showBike</span><span class="params">(Builder builder)</span> &#123;</span><br><span class="line">        <span class="type">Director</span> <span class="variable">director</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Director</span>(builder);</span><br><span class="line">        <span class="type">Bike</span> <span class="variable">bike</span> <span class="operator">=</span> director.construct();</span><br><span class="line">        System.out.println(bike.getFrame());</span><br><span class="line">        System.out.println(bike.getSeat());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ³¨æ„ï¼š</strong></p><p>ä¸Šé¢ç¤ºä¾‹æ˜¯ Builderæ¨¡å¼çš„å¸¸è§„ç”¨æ³•ï¼ŒæŒ‡æŒ¥è€…ç±» Director åœ¨å»ºé€ è€…æ¨¡å¼ä¸­å…·æœ‰å¾ˆé‡è¦çš„ä½œç”¨ï¼Œå®ƒç”¨äºæŒ‡å¯¼å…·ä½“æ„å»ºè€…å¦‚ä½•æ„å»ºäº§å“ï¼Œæ§åˆ¶è°ƒç”¨å…ˆåæ¬¡åºï¼Œå¹¶å‘è°ƒç”¨è€…è¿”å›å®Œæ•´çš„äº§å“ç±»ï¼Œä½†æ˜¯æœ‰äº›æƒ…å†µä¸‹éœ€è¦ç®€åŒ–ç³»ç»Ÿç»“æ„ï¼Œå¯ä»¥æŠŠæŒ‡æŒ¥è€…ç±»å’ŒæŠ½è±¡å»ºé€ è€…è¿›è¡Œç»“åˆ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æŠ½è±¡ builder ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="type">Bike</span> <span class="variable">mBike</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Bike</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">buildFrame</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">buildSeat</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> Bike <span class="title function_">createBike</span><span class="params">()</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> Bike <span class="title function_">construct</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.buildFrame();</span><br><span class="line">        <span class="built_in">this</span>.BuildSeat();</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.createBike();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>è¯´æ˜ï¼š</strong></p><p>è¿™æ ·åšç¡®å®ç®€åŒ–äº†ç³»ç»Ÿç»“æ„ï¼Œä½†åŒæ—¶ä¹ŸåŠ é‡äº†æŠ½è±¡å»ºé€ è€…ç±»çš„èŒè´£ï¼Œä¹Ÿä¸æ˜¯å¤ªç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ï¼Œå¦‚æœconstruct() è¿‡äºå¤æ‚ï¼Œå»ºè®®è¿˜æ˜¯å°è£…åˆ° Director ä¸­ã€‚</p><h3 id="4-4-ä¼˜ç¼ºç‚¹"><a href="#4-4-ä¼˜ç¼ºç‚¹" class="headerlink" title="4.4 ä¼˜ç¼ºç‚¹"></a>4.4 ä¼˜ç¼ºç‚¹</h3><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>å»ºé€ è€…æ¨¡å¼çš„å°è£…æ€§å¾ˆå¥½ã€‚ä½¿ç”¨å»ºé€ è€…æ¨¡å¼å¯ä»¥æœ‰æ•ˆçš„å°è£…å˜åŒ–ï¼Œåœ¨ä½¿ç”¨å»ºé€ è€…æ¨¡å¼çš„åœºæ™¯ä¸­ï¼Œä¸€èˆ¬äº§å“ç±»å’Œå»ºé€ è€…ç±»æ˜¯æ¯”è¾ƒç¨³å®šçš„ï¼Œå› æ­¤ï¼Œå°†ä¸»è¦çš„ä¸šåŠ¡é€»è¾‘å°è£…åœ¨æŒ‡æŒ¥è€…ç±»ä¸­å¯¹æ•´ä½“è€Œè¨€å¯ä»¥å–å¾—æ¯”è¾ƒå¥½çš„ç¨³å®šæ€§ã€‚</li><li>åœ¨å»ºé€ è€…æ¨¡å¼ä¸­ï¼Œå®¢æˆ·ç«¯ä¸å¿…çŸ¥é“äº§å“å†…éƒ¨ç»„æˆçš„ç»†èŠ‚ï¼Œå°†äº§å“æœ¬èº«ä¸äº§å“çš„åˆ›å»ºè¿‡ç¨‹è§£è€¦ï¼Œä½¿å¾—ç›¸åŒçš„åˆ›å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„äº§å“å¯¹è±¡ã€‚</li><li>å¯ä»¥æ›´åŠ ç²¾ç»†åœ°æ§åˆ¶äº§å“çš„åˆ›å»ºè¿‡ç¨‹ ã€‚å°†å¤æ‚äº§å“çš„åˆ›å»ºæ­¥éª¤åˆ†è§£åœ¨ä¸åŒçš„æ–¹æ³•ä¸­ï¼Œä½¿å¾—åˆ›å»ºè¿‡ç¨‹æ›´åŠ æ¸…æ™°ï¼Œä¹Ÿæ›´æ–¹ä¾¿ä½¿ç”¨ç¨‹åºæ¥æ§åˆ¶åˆ›å»ºè¿‡ç¨‹ã€‚</li><li>å»ºé€ è€…æ¨¡å¼å¾ˆå®¹æ˜“è¿›è¡Œæ‰©å±•ã€‚å¦‚æœæœ‰æ–°çš„éœ€æ±‚ï¼Œé€šè¿‡å®ç°ä¸€ä¸ªæ–°çš„å»ºé€ è€…ç±»å°±å¯ä»¥å®Œæˆï¼ŒåŸºæœ¬ä¸Šä¸ç”¨ä¿®æ”¹ä¹‹å‰å·²ç»æµ‹è¯•é€šè¿‡çš„ä»£ç ï¼Œå› æ­¤ä¹Ÿå°±ä¸ä¼šå¯¹åŸæœ‰åŠŸèƒ½å¼•å…¥é£é™©ã€‚ç¬¦åˆå¼€é—­åŸåˆ™ã€‚</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><p>é€ è€…æ¨¡å¼æ‰€åˆ›å»ºçš„äº§å“ä¸€èˆ¬å…·æœ‰è¾ƒå¤šçš„å…±åŒç‚¹ï¼Œå…¶ç»„æˆéƒ¨åˆ†ç›¸ä¼¼ï¼Œå¦‚æœäº§å“ä¹‹é—´çš„å·®å¼‚æ€§å¾ˆå¤§ï¼Œåˆ™ä¸é€‚åˆä½¿ç”¨å»ºé€ è€…æ¨¡å¼ï¼Œå› æ­¤å…¶ä½¿ç”¨èŒƒå›´å—åˆ°ä¸€å®šçš„é™åˆ¶ã€‚</p><h3 id="4-5-ä½¿ç”¨åœºæ™¯"><a href="#4-5-ä½¿ç”¨åœºæ™¯" class="headerlink" title="4.5 ä½¿ç”¨åœºæ™¯"></a>4.5 ä½¿ç”¨åœºæ™¯</h3><p>å»ºé€ è€…ï¼ˆBuilderï¼‰æ¨¡å¼åˆ›å»ºçš„æ˜¯å¤æ‚å¯¹è±¡ï¼Œå…¶äº§å“çš„å„ä¸ªéƒ¨åˆ†ç»å¸¸é¢ä¸´ç€å‰§çƒˆçš„å˜åŒ–ï¼Œä½†å°†å®ƒä»¬ç»„åˆåœ¨ä¸€èµ·çš„ç®—æ³•å´ç›¸å¯¹ç¨³å®šï¼Œæ‰€ä»¥å®ƒé€šå¸¸åœ¨ä»¥ä¸‹åœºåˆä½¿ç”¨ã€‚</p><ul><li>åˆ›å»ºçš„å¯¹è±¡è¾ƒå¤æ‚ï¼Œç”±å¤šä¸ªéƒ¨ä»¶æ„æˆï¼Œå„éƒ¨ä»¶é¢ä¸´ç€å¤æ‚çš„å˜åŒ–ï¼Œä½†æ„ä»¶é—´çš„å»ºé€ é¡ºåºæ˜¯ç¨³å®šçš„ã€‚</li><li>åˆ›å»ºå¤æ‚å¯¹è±¡çš„ç®—æ³•ç‹¬ç«‹äºè¯¥å¯¹è±¡çš„ç»„æˆéƒ¨åˆ†ä»¥åŠå®ƒä»¬çš„è£…é…æ–¹å¼ï¼Œå³äº§å“çš„æ„å»ºè¿‡ç¨‹å’Œæœ€ç»ˆçš„è¡¨ç¤ºæ˜¯ç‹¬ç«‹çš„ã€‚</li></ul><h3 id="4-6-æ¨¡å¼æ‰©å±•"><a href="#4-6-æ¨¡å¼æ‰©å±•" class="headerlink" title="4.6 æ¨¡å¼æ‰©å±•"></a>4.6 æ¨¡å¼æ‰©å±•</h3><p>å»ºé€ è€…æ¨¡å¼é™¤äº†ä¸Šé¢çš„ç”¨é€”å¤–ï¼Œåœ¨å¼€å‘ä¸­è¿˜æœ‰ä¸€ä¸ªå¸¸ç”¨çš„ä½¿ç”¨æ–¹å¼ï¼Œå°±æ˜¯å½“ä¸€ä¸ªç±»æ„é€ å™¨éœ€è¦ä¼ å…¥å¾ˆå¤šå‚æ•°æ—¶ï¼Œå¦‚æœåˆ›å»ºè¿™ä¸ªç±»çš„å®ä¾‹ï¼Œä»£ç å¯è¯»æ€§ä¼šéå¸¸å·®ï¼Œè€Œä¸”å¾ˆå®¹æ˜“å¼•å…¥é”™è¯¯ï¼Œæ­¤æ—¶å°±å¯ä»¥åˆ©ç”¨å»ºé€ è€…æ¨¡å¼è¿›è¡Œé‡æ„ã€‚</p><p>é‡æ„å‰ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Phone</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String cpu;</span><br><span class="line">    <span class="keyword">private</span> String screen;</span><br><span class="line">    <span class="keyword">private</span> String memory;</span><br><span class="line">    <span class="keyword">private</span> String mainboard;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Phone</span><span class="params">(String cpu, String screen, String memory, String mainboard)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.cpu = cpu;</span><br><span class="line">        <span class="built_in">this</span>.screen = screen;</span><br><span class="line">        <span class="built_in">this</span>.memory = memory;</span><br><span class="line">        <span class="built_in">this</span>.mainboard = mainboard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getCpu</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> cpu;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setCpu</span><span class="params">(String cpu)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.cpu = cpu;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getScreen</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> screen;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setScreen</span><span class="params">(String screen)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.screen = screen;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMemory</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> memory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMemory</span><span class="params">(String memory)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.memory = memory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMainboard</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mainboard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMainboard</span><span class="params">(String mainboard)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.mainboard = mainboard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Phone&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;cpu=&#x27;&quot;</span> + cpu + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, screen=&#x27;&quot;</span> + screen + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, memory=&#x27;&quot;</span> + memory + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, mainboard=&#x27;&quot;</span> + mainboard + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">//æ„å»ºPhoneå¯¹è±¡</span></span><br><span class="line">        <span class="type">Phone</span> <span class="variable">phone</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Phone</span>(<span class="string">&quot;intel&quot;</span>,<span class="string">&quot;ä¸‰æ˜Ÿå±å¹•&quot;</span>,<span class="string">&quot;é‡‘å£«é¡¿&quot;</span>,<span class="string">&quot;åç¡•&quot;</span>);</span><br><span class="line">        System.out.println(phone);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢åœ¨å®¢æˆ·ç«¯ä»£ç ä¸­æ„å»ºPhoneå¯¹è±¡ï¼Œä¼ é€’äº†å››ä¸ªå‚æ•°ï¼Œå¦‚æœå‚æ•°æ›´å¤šå‘¢ï¼Ÿä»£ç çš„å¯è¯»æ€§åŠä½¿ç”¨çš„æˆæœ¬å°±æ˜¯æ¯”è¾ƒé«˜ã€‚</p><p>é‡æ„åä»£ç ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Phone</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String cpu;</span><br><span class="line">    <span class="keyword">private</span> String screen;</span><br><span class="line">    <span class="keyword">private</span> String memory;</span><br><span class="line">    <span class="keyword">private</span> String mainboard;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å°†æ„é€ æ–¹æ³•ç§æœ‰ï¼Œä¸è®©å¤–éƒ¨ç›´æ¥åˆ›å»ºPhoneå¯¹è±¡</span></span><br><span class="line">    <span class="comment">//å¿…é¡»è¦é€šè¿‡Builderä¸­çš„buildæ–¹æ³•æ‰å¯ä»¥åˆ›å»ºPhoneå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Phone</span><span class="params">(Builder builder)</span> &#123;</span><br><span class="line">        cpu = builder.cpu;</span><br><span class="line">        screen = builder.screen;</span><br><span class="line">        memory = builder.memory;</span><br><span class="line">        mainboard = builder.mainboard;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Builder</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String cpu;</span><br><span class="line">        <span class="keyword">private</span> String screen;</span><br><span class="line">        <span class="keyword">private</span> String memory;</span><br><span class="line">        <span class="keyword">private</span> String mainboard;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Builder</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> Builder <span class="title function_">cpu</span><span class="params">(String val)</span> &#123;</span><br><span class="line">            cpu = val;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> Builder <span class="title function_">screen</span><span class="params">(String val)</span> &#123;</span><br><span class="line">            screen = val;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> Builder <span class="title function_">memory</span><span class="params">(String val)</span> &#123;</span><br><span class="line">            memory = val;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> Builder <span class="title function_">mainboard</span><span class="params">(String val)</span> &#123;</span><br><span class="line">            mainboard = val;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> Phone <span class="title function_">build</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Phone</span>(<span class="built_in">this</span>);&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Phone&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;cpu=&#x27;&quot;</span> + cpu + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, screen=&#x27;&quot;</span> + screen + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, memory=&#x27;&quot;</span> + memory + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, mainboard=&#x27;&quot;</span> + mainboard + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Client</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Phone</span> <span class="variable">phone</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Phone</span>.Builder()</span><br><span class="line">                .cpu(<span class="string">&quot;intel&quot;</span>)</span><br><span class="line">                .mainboard(<span class="string">&quot;åç¡•&quot;</span>)</span><br><span class="line">                .memory(<span class="string">&quot;é‡‘å£«é¡¿&quot;</span>)</span><br><span class="line">                .screen(<span class="string">&quot;ä¸‰æ˜Ÿ&quot;</span>)</span><br><span class="line">                .build();</span><br><span class="line">        System.out.println(phone);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡æ„åçš„ä»£ç åœ¨ä½¿ç”¨èµ·æ¥æ›´æ–¹ä¾¿ï¼ŒæŸç§ç¨‹åº¦ä¸Šä¹Ÿå¯ä»¥æé«˜å¼€å‘æ•ˆç‡ã€‚ä»è½¯ä»¶è®¾è®¡ä¸Šï¼Œå¯¹ç¨‹åºå‘˜çš„è¦æ±‚æ¯”è¾ƒé«˜ã€‚</p><h2 id="åˆ›å»ºè€…æ¨¡å¼å¯¹æ¯”"><a href="#åˆ›å»ºè€…æ¨¡å¼å¯¹æ¯”" class="headerlink" title="åˆ›å»ºè€…æ¨¡å¼å¯¹æ¯”"></a>åˆ›å»ºè€…æ¨¡å¼å¯¹æ¯”</h2><h3 id="1-å·¥å‚æ–¹æ³•æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼"><a href="#1-å·¥å‚æ–¹æ³•æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼" class="headerlink" title="1 å·¥å‚æ–¹æ³•æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼"></a>1 å·¥å‚æ–¹æ³•æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼</h3><p>å·¥å‚æ–¹æ³•æ¨¡å¼æ³¨é‡çš„æ˜¯æ•´ä½“å¯¹è±¡çš„åˆ›å»ºæ–¹å¼ï¼›è€Œå»ºé€ è€…æ¨¡å¼æ³¨é‡çš„æ˜¯éƒ¨ä»¶æ„å»ºçš„è¿‡ç¨‹ï¼Œæ„åœ¨é€šè¿‡ä¸€æ­¥ä¸€æ­¥åœ°ç²¾ç¡®æ„é€ åˆ›å»ºå‡ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ã€‚</p><p>æˆ‘ä»¬ä¸¾ä¸ªç®€å•ä¾‹å­æ¥è¯´æ˜ä¸¤è€…çš„å·®å¼‚ï¼Œå¦‚è¦åˆ¶é€ ä¸€ä¸ªè¶…äººï¼Œå¦‚æœä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œç›´æ¥äº§ç”Ÿå‡ºæ¥çš„å°±æ˜¯ä¸€ä¸ªåŠ›å¤§æ— ç©·ã€èƒ½å¤Ÿé£ç¿”ã€å†…è£¤å¤–ç©¿çš„è¶…äººï¼›è€Œå¦‚æœä½¿ç”¨å»ºé€ è€…æ¨¡å¼ï¼Œåˆ™éœ€è¦ç»„è£…æ‰‹ã€å¤´ã€è„šã€èº¯å¹²ç­‰éƒ¨åˆ†ï¼Œç„¶åå†æŠŠå†…è£¤å¤–ç©¿ï¼Œäºæ˜¯ä¸€ä¸ªè¶…äººå°±è¯ç”Ÿäº†ã€‚</p><h3 id="2-æŠ½è±¡å·¥å‚æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼"><a href="#2-æŠ½è±¡å·¥å‚æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼" class="headerlink" title="2 æŠ½è±¡å·¥å‚æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼"></a>2 æŠ½è±¡å·¥å‚æ¨¡å¼VSå»ºé€ è€…æ¨¡å¼</h3><p>æŠ½è±¡å·¥å‚æ¨¡å¼å®ç°å¯¹äº§å“å®¶æ—çš„åˆ›å»ºï¼Œä¸€ä¸ªäº§å“å®¶æ—æ˜¯è¿™æ ·çš„ä¸€ç³»åˆ—äº§å“ï¼šå…·æœ‰ä¸åŒåˆ†ç±»ç»´åº¦çš„äº§å“ç»„åˆï¼Œé‡‡ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼åˆ™æ˜¯ä¸éœ€è¦å…³å¿ƒæ„å»ºè¿‡ç¨‹ï¼Œåªå…³å¿ƒä»€ä¹ˆäº§å“ç”±ä»€ä¹ˆå·¥å‚ç”Ÿäº§å³å¯ã€‚</p><p>å»ºé€ è€…æ¨¡å¼åˆ™æ˜¯è¦æ±‚æŒ‰ç…§æŒ‡å®šçš„è“å›¾å»ºé€ äº§å“ï¼Œå®ƒçš„ä¸»è¦ç›®çš„æ˜¯é€šè¿‡ç»„è£…é›¶é…ä»¶è€Œäº§ç”Ÿä¸€ä¸ªæ–°äº§å“ã€‚</p><p>å¦‚æœå°†æŠ½è±¡å·¥å‚æ¨¡å¼çœ‹æˆæ±½è½¦é…ä»¶ç”Ÿäº§å·¥å‚ï¼Œç”Ÿäº§ä¸€ä¸ªäº§å“æ—çš„äº§å“ï¼Œé‚£ä¹ˆå»ºé€ è€…æ¨¡å¼å°±æ˜¯ä¸€ä¸ªæ±½è½¦ç»„è£…å·¥å‚ï¼Œé€šè¿‡å¯¹éƒ¨ä»¶çš„ç»„è£…å¯ä»¥è¿”å›ä¸€è¾†å®Œæ•´çš„æ±½è½¦ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸå‹æ¨¡å¼</title>
      <link href="/2022/12/23/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/"/>
      <url>/2022/12/23/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="3-åŸå‹æ¨¡å¼"><a href="#3-åŸå‹æ¨¡å¼" class="headerlink" title="3 åŸå‹æ¨¡å¼"></a>3 åŸå‹æ¨¡å¼</h2><h3 id="3-1-æ¦‚è¿°"><a href="#3-1-æ¦‚è¿°" class="headerlink" title="3.1 æ¦‚è¿°"></a>3.1 æ¦‚è¿°</h3><p>ç”¨ä¸€ä¸ªå·²ç»åˆ›å»ºçš„å®ä¾‹ä½œä¸ºåŸå‹ï¼Œé€šè¿‡å¤åˆ¶è¯¥åŸå‹å¯¹è±¡æ¥åˆ›å»ºä¸€ä¸ªå’ŒåŸå‹å¯¹è±¡ç›¸åŒçš„æ–°å¯¹è±¡ã€‚</p><h3 id="3-2-ç»“æ„"><a href="#3-2-ç»“æ„" class="headerlink" title="3.2 ç»“æ„"></a>3.2 ç»“æ„</h3><p>åŸå‹æ¨¡å¼åŒ…å«å¦‚ä¸‹è§’è‰²ï¼š</p><ul><li>æŠ½è±¡åŸå‹ç±»ï¼šè§„å®šäº†å…·ä½“åŸå‹å¯¹è±¡å¿…é¡»å®ç°çš„çš„ clone() æ–¹æ³•ã€‚</li><li>å…·ä½“åŸå‹ç±»ï¼šå®ç°æŠ½è±¡åŸå‹ç±»çš„ clone() æ–¹æ³•ï¼Œå®ƒæ˜¯å¯è¢«å¤åˆ¶çš„å¯¹è±¡ã€‚</li><li>è®¿é—®ç±»ï¼šä½¿ç”¨å…·ä½“åŸå‹ç±»ä¸­çš„ clone() æ–¹æ³•æ¥å¤åˆ¶æ–°çš„å¯¹è±¡ã€‚</li></ul><p>æ¥å£ç±»å›¾å¦‚ä¸‹ï¼š</p><p><img src="/2022/12/23/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/../../java/%E8%B5%84%E6%96%99/java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%EF%BC%88%E5%9B%BE%E8%A7%A3+%E6%A1%86%E6%9E%B6%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90+%E5%AE%9E%E6%88%98%EF%BC%89/Java%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E8%B5%84%E6%96%99day02/%E7%AC%94%E8%AE%B0/img/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F.png"></p><h3 id="3-3-å®ç°"><a href="#3-3-å®ç°" class="headerlink" title="3.3 å®ç°"></a>3.3 å®ç°</h3><p>åŸå‹æ¨¡å¼çš„å…‹éš†åˆ†ä¸ºæµ…å…‹éš†å’Œæ·±å…‹éš†ã€‚</p><blockquote><p>æµ…å…‹éš†ï¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œæ–°å¯¹è±¡çš„å±æ€§å’ŒåŸæ¥å¯¹è±¡å®Œå…¨ç›¸åŒï¼Œå¯¹äºéåŸºæœ¬ç±»å‹å±æ€§ï¼Œä»æŒ‡å‘åŸæœ‰å±æ€§æ‰€æŒ‡å‘çš„å¯¹è±¡çš„å†…å­˜åœ°å€ã€‚</p><p>æ·±å…‹éš†ï¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå±æ€§ä¸­å¼•ç”¨çš„å…¶ä»–å¯¹è±¡ä¹Ÿä¼šè¢«å…‹éš†ï¼Œä¸å†æŒ‡å‘åŸæœ‰å¯¹è±¡åœ°å€ã€‚</p></blockquote><p>Javaä¸­çš„Objectç±»ä¸­æä¾›äº† <code>clone()</code> æ–¹æ³•æ¥å®ç°æµ…å…‹éš†ã€‚ Cloneable æ¥å£æ˜¯ä¸Šé¢çš„ç±»å›¾ä¸­çš„æŠ½è±¡åŸå‹ç±»ï¼Œè€Œå®ç°äº†Cloneableæ¥å£çš„å­å®ç°ç±»å°±æ˜¯å…·ä½“çš„åŸå‹ç±»ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><p><strong>Realizetypeï¼ˆå…·ä½“çš„åŸå‹ç±»ï¼‰ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Realizetype</span> <span class="keyword">implements</span> <span class="title class_">Cloneable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Realizetype</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…·ä½“çš„åŸå‹å¯¹è±¡åˆ›å»ºå®Œæˆï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Realizetype <span class="title function_">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;å…·ä½“åŸå‹å¤åˆ¶æˆåŠŸï¼&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> (Realizetype) <span class="built_in">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>PrototypeTestï¼ˆæµ‹è¯•è®¿é—®ç±»ï¼‰ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PrototypeTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        <span class="type">Realizetype</span> <span class="variable">r1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Realizetype</span>();</span><br><span class="line">        <span class="type">Realizetype</span> <span class="variable">r2</span> <span class="operator">=</span> r1.clone();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;å¯¹è±¡r1å’Œr2æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Ÿ&quot;</span> + (r1 == r2));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-4-æ¡ˆä¾‹"><a href="#3-4-æ¡ˆä¾‹" class="headerlink" title="3.4 æ¡ˆä¾‹"></a>3.4 æ¡ˆä¾‹</h3><p><strong>ç”¨åŸå‹æ¨¡å¼ç”Ÿæˆâ€œä¸‰å¥½å­¦ç”Ÿâ€å¥–çŠ¶</strong></p><p>åŒä¸€å­¦æ ¡çš„â€œä¸‰å¥½å­¦ç”Ÿâ€å¥–çŠ¶é™¤äº†è·å¥–äººå§“åä¸åŒï¼Œå…¶ä»–éƒ½ç›¸åŒï¼Œå¯ä»¥ä½¿ç”¨åŸå‹æ¨¡å¼å¤åˆ¶å¤šä¸ªâ€œä¸‰å¥½å­¦ç”Ÿâ€å¥–çŠ¶å‡ºæ¥ï¼Œç„¶ååœ¨ä¿®æ”¹å¥–çŠ¶ä¸Šçš„åå­—å³å¯ã€‚</p><p>ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/2022/12/23/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/../../java/èµ„æ–™/javaè®¾è®¡æ¨¡å¼ï¼ˆå›¾è§£+æ¡†æ¶æºç åˆ†æ+å®æˆ˜ï¼‰/Javaè®¾è®¡æ¨¡å¼èµ„æ–™day02/ç¬”è®°/img/åŸå‹æ¨¡å¼1.png" style="zoom:80%;"><p>ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¥–çŠ¶ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Citation</span> <span class="keyword">implements</span> <span class="title class_">Cloneable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(name + <span class="string">&quot;åŒå­¦ï¼šåœ¨2020å­¦å¹´ç¬¬ä¸€å­¦æœŸä¸­è¡¨ç°ä¼˜ç§€ï¼Œè¢«è¯„ä¸ºä¸‰å¥½å­¦ç”Ÿã€‚ç‰¹å‘æ­¤çŠ¶ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Citation <span class="title function_">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        <span class="keyword">return</span> (Citation) <span class="built_in">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•è®¿é—®ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CitationTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        <span class="type">Citation</span> <span class="variable">c1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Citation</span>();</span><br><span class="line">        c1.setName(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¤åˆ¶å¥–çŠ¶</span></span><br><span class="line">        <span class="type">Citation</span> <span class="variable">c2</span> <span class="operator">=</span> c1.clone();</span><br><span class="line">        <span class="comment">//å°†å¥–çŠ¶çš„åå­—ä¿®æ”¹æå››</span></span><br><span class="line">        c2.setName(<span class="string">&quot;æå››&quot;</span>);</span><br><span class="line"></span><br><span class="line">        c1.show();</span><br><span class="line">        c2.show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-5-ä½¿ç”¨åœºæ™¯"><a href="#3-5-ä½¿ç”¨åœºæ™¯" class="headerlink" title="3.5 ä½¿ç”¨åœºæ™¯"></a>3.5 ä½¿ç”¨åœºæ™¯</h3><ul><li>å¯¹è±¡çš„åˆ›å»ºéå¸¸å¤æ‚ï¼Œå¯ä»¥ä½¿ç”¨åŸå‹æ¨¡å¼å¿«æ·çš„åˆ›å»ºå¯¹è±¡ã€‚</li><li>æ€§èƒ½å’Œå®‰å…¨è¦æ±‚æ¯”è¾ƒé«˜ã€‚</li></ul><h3 id="3-6-æ‰©å±•ï¼ˆæ·±å…‹éš†ï¼‰"><a href="#3-6-æ‰©å±•ï¼ˆæ·±å…‹éš†ï¼‰" class="headerlink" title="3.6 æ‰©å±•ï¼ˆæ·±å…‹éš†ï¼‰"></a>3.6 æ‰©å±•ï¼ˆæ·±å…‹éš†ï¼‰</h3><p>å°†ä¸Šé¢çš„â€œä¸‰å¥½å­¦ç”Ÿâ€å¥–çŠ¶çš„æ¡ˆä¾‹ä¸­Citationç±»çš„nameå±æ€§ä¿®æ”¹ä¸ºStudentç±»å‹çš„å±æ€§ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å¥–çŠ¶ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Citation</span> <span class="keyword">implements</span> <span class="title class_">Cloneable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Student stu;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Student <span class="title function_">getStu</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> stu;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setStu</span><span class="params">(Student stu)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.stu = stu;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">show</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(stu.getName() + <span class="string">&quot;åŒå­¦ï¼šåœ¨2020å­¦å¹´ç¬¬ä¸€å­¦æœŸä¸­è¡¨ç°ä¼˜ç§€ï¼Œè¢«è¯„ä¸ºä¸‰å¥½å­¦ç”Ÿã€‚ç‰¹å‘æ­¤çŠ¶ï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Citation <span class="title function_">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line">        <span class="keyword">return</span> (Citation) <span class="built_in">super</span>.clone();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å­¦ç”Ÿç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(String name, String address)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getAddress</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> address;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAddress</span><span class="params">(String address)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.address = address;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æµ‹è¯•ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CitationTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> CloneNotSupportedException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Citation</span> <span class="variable">c1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Citation</span>();</span><br><span class="line">        <span class="type">Student</span> <span class="variable">stu</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="string">&quot;è¥¿å®‰&quot;</span>);</span><br><span class="line">        c1.setStu(stu);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¤åˆ¶å¥–çŠ¶</span></span><br><span class="line">        <span class="type">Citation</span> <span class="variable">c2</span> <span class="operator">=</span> c1.clone();</span><br><span class="line">        <span class="comment">//è·å–c2å¥–çŠ¶æ‰€å±å­¦ç”Ÿå¯¹è±¡</span></span><br><span class="line">        <span class="type">Student</span> <span class="variable">stu1</span> <span class="operator">=</span> c2.getStu();</span><br><span class="line">        stu1.setName(<span class="string">&quot;æå››&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­stuå¯¹è±¡å’Œstu1å¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">        System.out.println(<span class="string">&quot;stuå’Œstu1æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Ÿ&quot;</span> + (stu == stu1));</span><br><span class="line"></span><br><span class="line">        c1.show();</span><br><span class="line">        c2.show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœä¸ºï¼š</p><img src="/2022/12/23/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/../../java/èµ„æ–™/javaè®¾è®¡æ¨¡å¼ï¼ˆå›¾è§£+æ¡†æ¶æºç åˆ†æ+å®æˆ˜ï¼‰/Javaè®¾è®¡æ¨¡å¼èµ„æ–™day02/ç¬”è®°/img/åŸå‹æ¨¡å¼2.png" style="zoom:80%;"><p><font color="red">è¯´æ˜ï¼š</font></p><p>â€‹stuå¯¹è±¡å’Œstu1å¯¹è±¡æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šäº§ç”Ÿå°†stu1å¯¹è±¡ä¸­nameå±æ€§å€¼æ”¹ä¸ºâ€œæå››â€ï¼Œä¸¤ä¸ªCitationï¼ˆå¥–çŠ¶ï¼‰å¯¹è±¡ä¸­æ˜¾ç¤ºçš„éƒ½æ˜¯æå››ã€‚è¿™å°±æ˜¯æµ…å…‹éš†çš„æ•ˆæœï¼Œå¯¹å…·ä½“åŸå‹ç±»ï¼ˆCitationï¼‰ä¸­çš„å¼•ç”¨ç±»å‹çš„å±æ€§è¿›è¡Œå¼•ç”¨çš„å¤åˆ¶ã€‚è¿™ç§æƒ…å†µéœ€è¦ä½¿ç”¨æ·±å…‹éš†ï¼Œè€Œè¿›è¡Œæ·±å…‹éš†éœ€è¦ä½¿ç”¨å¯¹è±¡æµã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CitationTest1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Citation</span> <span class="variable">c1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Citation</span>();</span><br><span class="line">        <span class="type">Student</span> <span class="variable">stu</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="string">&quot;è¥¿å®‰&quot;</span>);</span><br><span class="line">        c1.setStu(stu);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡è¾“å‡ºæµå¯¹è±¡</span></span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;C:\\Users\\Think\\Desktop\\b.txt&quot;</span>));</span><br><span class="line">        <span class="comment">//å°†c1å¯¹è±¡å†™å‡ºåˆ°æ–‡ä»¶ä¸­</span></span><br><span class="line">        oos.writeObject(c1);</span><br><span class="line">        oos.close();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡å‡ºå…¥æµå¯¹è±¡</span></span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;C:\\Users\\Think\\Desktop\\b.txt&quot;</span>));</span><br><span class="line">        <span class="comment">//è¯»å–å¯¹è±¡</span></span><br><span class="line">        <span class="type">Citation</span> <span class="variable">c2</span> <span class="operator">=</span> (Citation) ois.readObject();</span><br><span class="line">        <span class="comment">//è·å–c2å¥–çŠ¶æ‰€å±å­¦ç”Ÿå¯¹è±¡</span></span><br><span class="line">        <span class="type">Student</span> <span class="variable">stu1</span> <span class="operator">=</span> c2.getStu();</span><br><span class="line">        stu1.setName(<span class="string">&quot;æå››&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­stuå¯¹è±¡å’Œstu1å¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">        System.out.println(<span class="string">&quot;stuå’Œstu1æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Ÿ&quot;</span> + (stu == stu1));</span><br><span class="line"></span><br><span class="line">        c1.show();</span><br><span class="line">        c2.show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœä¸ºï¼š</p><img src="/2022/12/23/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F/../../java/èµ„æ–™/javaè®¾è®¡æ¨¡å¼ï¼ˆå›¾è§£+æ¡†æ¶æºç åˆ†æ+å®æˆ˜ï¼‰/Javaè®¾è®¡æ¨¡å¼èµ„æ–™day02/ç¬”è®°/img/åŸå‹æ¨¡å¼3.png" style="zoom:80%;"><blockquote><p>æ³¨æ„ï¼šCitationç±»å’ŒStudentç±»å¿…é¡»å®ç°Serializableæ¥å£ï¼Œå¦åˆ™ä¼šæŠ›NotSerializableExceptionå¼‚å¸¸ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å‚æ¨¡å¼</title>
      <link href="/2022/12/23/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
      <url>/2022/12/23/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="2-å·¥å‚æ¨¡å¼"><a href="#2-å·¥å‚æ¨¡å¼" class="headerlink" title="2 å·¥å‚æ¨¡å¼"></a>2 å·¥å‚æ¨¡å¼</h2><h3 id="2-1-æ¦‚è¿°"><a href="#2-1-æ¦‚è¿°" class="headerlink" title="2.1 æ¦‚è¿°"></a>2.1 æ¦‚è¿°</h3><p>éœ€æ±‚ï¼šè®¾è®¡ä¸€ä¸ªå’–å•¡åº—ç‚¹é¤ç³»ç»Ÿã€‚  </p><p>è®¾è®¡ä¸€ä¸ªå’–å•¡ç±»ï¼ˆCoffeeï¼‰ï¼Œå¹¶å®šä¹‰å…¶ä¸¤ä¸ªå­ç±»ï¼ˆç¾å¼å’–å•¡ã€AmericanCoffeeã€‘å’Œæ‹¿é“å’–å•¡ã€LatteCoffeeã€‘ï¼‰ï¼›å†è®¾è®¡ä¸€ä¸ªå’–å•¡åº—ç±»ï¼ˆCoffeeStoreï¼‰ï¼Œå’–å•¡åº—å…·æœ‰ç‚¹å’–å•¡çš„åŠŸèƒ½ã€‚</p><p>å…·ä½“ç±»çš„è®¾è®¡å¦‚ä¸‹ï¼š</p><img src="/2022/12/23/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/../../java/èµ„æ–™/javaè®¾è®¡æ¨¡å¼ï¼ˆå›¾è§£+æ¡†æ¶æºç åˆ†æ+å®æˆ˜ï¼‰/Javaè®¾è®¡æ¨¡å¼èµ„æ–™day02/ç¬”è®°/img/å·¥å‚è®¾è®¡æ¨¡å¼å¼•å…¥.png" style="zoom:80%;"><p>åœ¨javaä¸­ï¼Œä¸‡ç‰©çš†å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡éƒ½éœ€è¦åˆ›å»ºï¼Œå¦‚æœåˆ›å»ºçš„æ—¶å€™ç›´æ¥newè¯¥å¯¹è±¡ï¼Œå°±ä¼šå¯¹è¯¥å¯¹è±¡è€¦åˆä¸¥é‡ï¼Œå‡å¦‚æˆ‘ä»¬è¦æ›´æ¢å¯¹è±¡ï¼Œæ‰€æœ‰newå¯¹è±¡çš„åœ°æ–¹éƒ½éœ€è¦ä¿®æ”¹ä¸€éï¼Œè¿™æ˜¾ç„¶è¿èƒŒäº†è½¯ä»¶è®¾è®¡çš„å¼€é—­åŸåˆ™ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨å·¥å‚æ¥ç”Ÿäº§å¯¹è±¡ï¼Œæˆ‘ä»¬å°±åªå’Œå·¥å‚æ‰“äº¤é“å°±å¯ä»¥äº†ï¼Œå½»åº•å’Œå¯¹è±¡è§£è€¦ï¼Œå¦‚æœè¦æ›´æ¢å¯¹è±¡ï¼Œç›´æ¥åœ¨å·¥å‚é‡Œæ›´æ¢è¯¥å¯¹è±¡å³å¯ï¼Œè¾¾åˆ°äº†ä¸å¯¹è±¡è§£è€¦çš„ç›®çš„ï¼›æ‰€ä»¥è¯´ï¼Œå·¥å‚æ¨¡å¼æœ€å¤§çš„ä¼˜ç‚¹å°±æ˜¯ï¼š<strong>è§£è€¦</strong>ã€‚</p><p>åœ¨æœ¬æ•™ç¨‹ä¸­ä¼šä»‹ç»ä¸‰ç§å·¥å‚çš„ä½¿ç”¨</p><ul><li>ç®€å•å·¥å‚æ¨¡å¼ï¼ˆä¸å±äºGOFçš„23ç§ç»å…¸è®¾è®¡æ¨¡å¼ï¼‰  </li><li>å·¥å‚æ–¹æ³•æ¨¡å¼</li><li>æŠ½è±¡å·¥å‚æ¨¡å¼</li></ul><h3 id="2-2-ç®€å•å·¥å‚æ¨¡å¼"><a href="#2-2-ç®€å•å·¥å‚æ¨¡å¼" class="headerlink" title="2.2 ç®€å•å·¥å‚æ¨¡å¼"></a>2.2 ç®€å•å·¥å‚æ¨¡å¼</h3><p>ç®€å•å·¥å‚ä¸æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œåè€Œæ¯”è¾ƒåƒæ˜¯ä¸€ç§ç¼–ç¨‹ä¹ æƒ¯ã€‚</p><h4 id="2-2-1-ç»“æ„"><a href="#2-2-1-ç»“æ„" class="headerlink" title="2.2.1 ç»“æ„"></a>2.2.1 ç»“æ„</h4><p>ç®€å•å·¥å‚åŒ…å«å¦‚ä¸‹è§’è‰²ï¼š</p><ul><li>æŠ½è±¡äº§å“ ï¼šå®šä¹‰äº†äº§å“çš„è§„èŒƒï¼Œæè¿°äº†äº§å“çš„ä¸»è¦ç‰¹æ€§å’ŒåŠŸèƒ½ã€‚</li><li>å…·ä½“äº§å“ ï¼šå®ç°æˆ–è€…ç»§æ‰¿æŠ½è±¡äº§å“çš„å­ç±»</li><li>å…·ä½“å·¥å‚ ï¼šæä¾›äº†åˆ›å»ºäº§å“çš„æ–¹æ³•ï¼Œè°ƒç”¨è€…é€šè¿‡è¯¥æ–¹æ³•æ¥è·å–äº§å“ã€‚</li></ul><h4 id="2-2-2-å®ç°"><a href="#2-2-2-å®ç°" class="headerlink" title="2.2.2 å®ç°"></a>2.2.2 å®ç°</h4><p>ç°åœ¨ä½¿ç”¨ç®€å•å·¥å‚å¯¹ä¸Šé¢æ¡ˆä¾‹è¿›è¡Œæ”¹è¿›ï¼Œç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/2022/12/23/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/../../java/èµ„æ–™/javaè®¾è®¡æ¨¡å¼ï¼ˆå›¾è§£+æ¡†æ¶æºç åˆ†æ+å®æˆ˜ï¼‰/Javaè®¾è®¡æ¨¡å¼èµ„æ–™day02/ç¬”è®°/img/ç®€å•å·¥å‚æ¨¡å¼.png" style="zoom:70%;"><p>å·¥å‚ç±»ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleCoffeeFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Coffee <span class="title function_">createCoffee</span><span class="params">(String type)</span> &#123;</span><br><span class="line">        <span class="type">Coffee</span> <span class="variable">coffee</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;americano&quot;</span>.equals(type)) &#123;</span><br><span class="line">            coffee = <span class="keyword">new</span> <span class="title class_">AmericanoCoffee</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;latte&quot;</span>.equals(type)) &#123;</span><br><span class="line">            coffee = <span class="keyword">new</span> <span class="title class_">LatteCoffee</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> coffee;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å·¥å‚ï¼ˆfactoryï¼‰å¤„ç†åˆ›å»ºå¯¹è±¡çš„ç»†èŠ‚ï¼Œä¸€æ—¦æœ‰äº†SimpleCoffeeFactoryï¼ŒCoffeeStoreç±»ä¸­çš„orderCoffee()å°±å˜æˆæ­¤å¯¹è±¡çš„å®¢æˆ·ï¼ŒåæœŸå¦‚æœéœ€è¦Coffeeå¯¹è±¡ç›´æ¥ä»å·¥å‚ä¸­è·å–å³å¯ã€‚è¿™æ ·ä¹Ÿå°±è§£é™¤äº†å’ŒCoffeeå®ç°ç±»çš„è€¦åˆï¼ŒåŒæ—¶åˆäº§ç”Ÿäº†æ–°çš„è€¦åˆï¼ŒCoffeeStoreå¯¹è±¡å’ŒSimpleCoffeeFactoryå·¥å‚å¯¹è±¡çš„è€¦åˆï¼Œå·¥å‚å¯¹è±¡å’Œå•†å“å¯¹è±¡çš„è€¦åˆã€‚</p><p>åæœŸå¦‚æœå†åŠ æ–°å“ç§çš„å’–å•¡ï¼Œæˆ‘ä»¬åŠ¿å¿…è¦éœ€æ±‚ä¿®æ”¹SimpleCoffeeFactoryçš„ä»£ç ï¼Œè¿åäº†å¼€é—­åŸåˆ™ã€‚å·¥å‚ç±»çš„å®¢æˆ·ç«¯å¯èƒ½æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚åˆ›å»ºç¾å›¢å¤–å–ï¼Œç”œå“åº—ç‚¹å’–å•¡ç­‰ï¼Œè¿™æ ·åªéœ€è¦ä¿®æ”¹å·¥å‚ç±»çš„ä»£ç ï¼Œçœå»å…¶ä»–çš„ä¿®æ”¹æ“ä½œã€‚</p><h4 id="2-2-4-ä¼˜ç¼ºç‚¹"><a href="#2-2-4-ä¼˜ç¼ºç‚¹" class="headerlink" title="2.2.4 ä¼˜ç¼ºç‚¹"></a>2.2.4 ä¼˜ç¼ºç‚¹</h4><p><strong>ä¼˜ç‚¹ï¼š</strong></p><p>å°è£…äº†åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹ï¼Œå¯ä»¥é€šè¿‡å‚æ•°ç›´æ¥è·å–å¯¹è±¡ã€‚æŠŠå¯¹è±¡çš„åˆ›å»ºå’Œä¸šåŠ¡é€»è¾‘å±‚åˆ†å¼€ï¼Œè¿™æ ·ä»¥åå°±é¿å…äº†ä¿®æ”¹å®¢æˆ·ä»£ç ï¼Œå¦‚æœè¦å®ç°æ–°äº§å“ç›´æ¥ä¿®æ”¹å·¥å‚ç±»ï¼Œè€Œä¸éœ€è¦åœ¨åŸä»£ç ä¸­ä¿®æ”¹ï¼Œè¿™æ ·å°±é™ä½äº†å®¢æˆ·ä»£ç ä¿®æ”¹çš„å¯èƒ½æ€§ï¼Œæ›´åŠ å®¹æ˜“æ‰©å±•ã€‚</p><p><strong>ç¼ºç‚¹ï¼š</strong></p><p>å¢åŠ æ–°äº§å“æ—¶è¿˜æ˜¯éœ€è¦ä¿®æ”¹å·¥å‚ç±»çš„ä»£ç ï¼Œè¿èƒŒäº†â€œå¼€é—­åŸåˆ™â€ã€‚</p><h4 id="2-2-3-æ‰©å±•"><a href="#2-2-3-æ‰©å±•" class="headerlink" title="2.2.3 æ‰©å±•"></a>2.2.3 æ‰©å±•</h4><p><strong>é™æ€å·¥å‚</strong></p><p>è¿™æ ·å°±æ— éœ€åˆ›å»ºå·¥å‚ï¼Œç›´æ¥è°ƒç”¨å…¶é™æ€æ–¹æ³•å³å¯ï¼Œ</p><p>åœ¨å¼€å‘ä¸­ä¹Ÿæœ‰ä¸€éƒ¨åˆ†äººå°†å·¥å‚ç±»ä¸­çš„åˆ›å»ºå¯¹è±¡çš„åŠŸèƒ½å®šä¹‰ä¸ºé™æ€çš„ï¼Œè¿™ä¸ªå°±æ˜¯é™æ€å·¥å‚æ¨¡å¼ï¼Œå®ƒä¹Ÿä¸æ˜¯23ç§è®¾è®¡æ¨¡å¼ä¸­çš„ã€‚ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleCoffeeFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Coffee <span class="title function_">createCoffee</span><span class="params">(String type)</span> &#123;</span><br><span class="line">        <span class="type">Coffee</span> <span class="variable">coffee</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;americano&quot;</span>.equals(type)) &#123;</span><br><span class="line">            coffee = <span class="keyword">new</span> <span class="title class_">AmericanoCoffee</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;latte&quot;</span>.equals(type)) &#123;</span><br><span class="line">            coffee = <span class="keyword">new</span> <span class="title class_">LatteCoffee</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> coffe;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-3-å·¥å‚æ–¹æ³•æ¨¡å¼"><a href="#2-3-å·¥å‚æ–¹æ³•æ¨¡å¼" class="headerlink" title="2.3 å·¥å‚æ–¹æ³•æ¨¡å¼"></a>2.3 å·¥å‚æ–¹æ³•æ¨¡å¼</h3><p>é’ˆå¯¹ä¸Šä¾‹ä¸­çš„ç¼ºç‚¹ï¼Œä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼å°±å¯ä»¥å®Œç¾çš„è§£å†³ï¼Œå®Œå…¨éµå¾ªå¼€é—­åŸåˆ™ã€‚</p><h4 id="2-3-1-æ¦‚å¿µ"><a href="#2-3-1-æ¦‚å¿µ" class="headerlink" title="2.3.1 æ¦‚å¿µ"></a>2.3.1 æ¦‚å¿µ</h4><p>å®šä¹‰ä¸€ä¸ªç”¨äºåˆ›å»ºå¯¹è±¡çš„æ¥å£ï¼Œè®©å­ç±»å†³å®šå®ä¾‹åŒ–å“ªä¸ªäº§å“ç±»å¯¹è±¡ã€‚å·¥å‚æ–¹æ³•ä½¿ä¸€ä¸ªäº§å“ç±»çš„å®ä¾‹åŒ–å»¶è¿Ÿåˆ°å…¶å·¥å‚çš„å­ç±»ã€‚</p><h4 id="2-3-2-ç»“æ„"><a href="#2-3-2-ç»“æ„" class="headerlink" title="2.3.2 ç»“æ„"></a>2.3.2 ç»“æ„</h4><p>å·¥å‚æ–¹æ³•æ¨¡å¼çš„ä¸»è¦è§’è‰²ï¼š</p><ul><li>æŠ½è±¡å·¥å‚ï¼ˆAbstract Factoryï¼‰ï¼šæä¾›äº†åˆ›å»ºäº§å“çš„æ¥å£ï¼Œè°ƒç”¨è€…é€šè¿‡å®ƒè®¿é—®å…·ä½“å·¥å‚çš„å·¥å‚æ–¹æ³•æ¥åˆ›å»ºäº§å“ã€‚</li><li>å…·ä½“å·¥å‚ï¼ˆConcreteFactoryï¼‰ï¼šä¸»è¦æ˜¯å®ç°æŠ½è±¡å·¥å‚ä¸­çš„æŠ½è±¡æ–¹æ³•ï¼Œå®Œæˆå…·ä½“äº§å“çš„åˆ›å»ºã€‚</li><li>æŠ½è±¡äº§å“ï¼ˆProductï¼‰ï¼šå®šä¹‰äº†äº§å“çš„è§„èŒƒï¼Œæè¿°äº†äº§å“çš„ä¸»è¦ç‰¹æ€§å’ŒåŠŸèƒ½ã€‚</li><li>å…·ä½“äº§å“ï¼ˆConcreteProductï¼‰ï¼šå®ç°äº†æŠ½è±¡äº§å“è§’è‰²æ‰€å®šä¹‰çš„æ¥å£ï¼Œç”±å…·ä½“å·¥å‚æ¥åˆ›å»ºï¼Œå®ƒåŒå…·ä½“å·¥å‚ä¹‹é—´ä¸€ä¸€å¯¹åº”ã€‚</li></ul><h4 id="2-3-3-å®ç°"><a href="#2-3-3-å®ç°" class="headerlink" title="2.3.3 å®ç°"></a>2.3.3 å®ç°</h4><p>ä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼å¯¹ä¸Šä¾‹è¿›è¡Œæ”¹è¿›ï¼Œç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/2022/12/23/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/../../java/èµ„æ–™/javaè®¾è®¡æ¨¡å¼ï¼ˆå›¾è§£+æ¡†æ¶æºç åˆ†æ+å®æˆ˜ï¼‰/Javaè®¾è®¡æ¨¡å¼èµ„æ–™day02/ç¬”è®°/img/å·¥å‚æ–¹æ³•æ¨¡å¼.png" style="zoom:70%;"><p>ä»£ç å¦‚ä¸‹ï¼š</p><p>æŠ½è±¡å·¥å‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CoffeeFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    Coffee <span class="title function_">createCoffee</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“å·¥å‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LatteCoffeeFactory</span> <span class="keyword">implements</span> <span class="title class_">CoffeeFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Coffee <span class="title function_">createCoffee</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LatteCoffee</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AmericanCoffeeFactory</span> <span class="keyword">implements</span> <span class="title class_">CoffeeFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Coffee <span class="title function_">createCoffee</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AmericanCoffee</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å’–å•¡åº—ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CoffeeStore</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> CoffeeFactory factory;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CoffeeStore</span><span class="params">(CoffeeFactory factory)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.factory = factory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Coffee <span class="title function_">orderCoffee</span><span class="params">(String type)</span> &#123;</span><br><span class="line">        <span class="type">Coffee</span> <span class="variable">coffee</span> <span class="operator">=</span> factory.createCoffee();</span><br><span class="line">        coffee.addMilk();</span><br><span class="line">        coffee.addsugar();</span><br><span class="line">        <span class="keyword">return</span> coffee;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä»¥ä¸Šçš„ç¼–å†™çš„ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œè¦å¢åŠ äº§å“ç±»æ—¶ä¹Ÿè¦ç›¸åº”åœ°å¢åŠ å·¥å‚ç±»ï¼Œä¸éœ€è¦ä¿®æ”¹å·¥å‚ç±»çš„ä»£ç äº†ï¼Œè¿™æ ·å°±è§£å†³äº†ç®€å•å·¥å‚æ¨¡å¼çš„ç¼ºç‚¹ã€‚</p><p>å·¥å‚æ–¹æ³•æ¨¡å¼æ˜¯ç®€å•å·¥å‚æ¨¡å¼çš„è¿›ä¸€æ­¥æŠ½è±¡ã€‚ç”±äºä½¿ç”¨äº†å¤šæ€æ€§ï¼Œå·¥å‚æ–¹æ³•æ¨¡å¼ä¿æŒäº†ç®€å•å·¥å‚æ¨¡å¼çš„ä¼˜ç‚¹ï¼Œè€Œä¸”å…‹æœäº†å®ƒçš„ç¼ºç‚¹ã€‚</p><h4 id="2-3-4-ä¼˜ç¼ºç‚¹"><a href="#2-3-4-ä¼˜ç¼ºç‚¹" class="headerlink" title="2.3.4 ä¼˜ç¼ºç‚¹"></a>2.3.4 ä¼˜ç¼ºç‚¹</h4><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>ç”¨æˆ·åªéœ€è¦çŸ¥é“å…·ä½“å·¥å‚çš„åç§°å°±å¯å¾—åˆ°æ‰€è¦çš„äº§å“ï¼Œæ— é¡»çŸ¥é“äº§å“çš„å…·ä½“åˆ›å»ºè¿‡ç¨‹ï¼›</li><li>åœ¨ç³»ç»Ÿå¢åŠ æ–°çš„äº§å“æ—¶åªéœ€è¦æ·»åŠ å…·ä½“äº§å“ç±»å’Œå¯¹åº”çš„å…·ä½“å·¥å‚ç±»ï¼Œæ— é¡»å¯¹åŸå·¥å‚è¿›è¡Œä»»ä½•ä¿®æ”¹ï¼Œæ»¡è¶³å¼€é—­åŸåˆ™ï¼›</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>æ¯å¢åŠ ä¸€ä¸ªäº§å“å°±è¦å¢åŠ ä¸€ä¸ªå…·ä½“äº§å“ç±»å’Œä¸€ä¸ªå¯¹åº”çš„å…·ä½“å·¥å‚ç±»ï¼Œè¿™å¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ã€‚</li></ul><h3 id="2-4-æŠ½è±¡å·¥å‚æ¨¡å¼"><a href="#2-4-æŠ½è±¡å·¥å‚æ¨¡å¼" class="headerlink" title="2.4 æŠ½è±¡å·¥å‚æ¨¡å¼"></a>2.4 æŠ½è±¡å·¥å‚æ¨¡å¼</h3><p>å‰é¢ä»‹ç»çš„å·¥å‚æ–¹æ³•æ¨¡å¼ä¸­è€ƒè™‘çš„æ˜¯ä¸€ç±»äº§å“çš„ç”Ÿäº§ï¼Œå¦‚ç•œç‰§åœºåªå…»åŠ¨ç‰©ã€ç”µè§†æœºå‚åªç”Ÿäº§ç”µè§†æœºã€ä¼ æ™ºæ’­å®¢åªåŸ¹å…»è®¡ç®—æœºè½¯ä»¶ä¸“ä¸šçš„å­¦ç”Ÿç­‰ã€‚</p><p>è¿™äº›å·¥å‚åªç”Ÿäº§åŒç§ç±»äº§å“ï¼ŒåŒç§ç±»äº§å“ç§°ä¸ºåŒç­‰çº§äº§å“ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼šå·¥å‚æ–¹æ³•æ¨¡å¼åªè€ƒè™‘ç”Ÿäº§åŒç­‰çº§çš„äº§å“ï¼Œä½†æ˜¯åœ¨ç°å®ç”Ÿæ´»ä¸­è®¸å¤šå·¥å‚æ˜¯ç»¼åˆå‹çš„å·¥å‚ï¼Œèƒ½ç”Ÿäº§å¤šç­‰çº§ï¼ˆç§ç±»ï¼‰ çš„äº§å“ï¼Œå¦‚ç”µå™¨å‚æ—¢ç”Ÿäº§ç”µè§†æœºåˆç”Ÿäº§æ´—è¡£æœºæˆ–ç©ºè°ƒï¼Œå¤§å­¦æ—¢æœ‰è½¯ä»¶ä¸“ä¸šåˆæœ‰ç”Ÿç‰©ä¸“ä¸šç­‰ã€‚</p><p>æœ¬èŠ‚è¦ä»‹ç»çš„æŠ½è±¡å·¥å‚æ¨¡å¼å°†è€ƒè™‘å¤šç­‰çº§äº§å“çš„ç”Ÿäº§ï¼Œå°†åŒä¸€ä¸ªå…·ä½“å·¥å‚æ‰€ç”Ÿäº§çš„ä½äºä¸åŒç­‰çº§çš„ä¸€ç»„äº§å“ç§°ä¸ºä¸€ä¸ªäº§å“æ—ï¼Œä¸‹å›¾æ‰€ç¤ºæ¨ªè½´æ˜¯äº§å“ç­‰çº§ï¼Œä¹Ÿå°±æ˜¯åŒä¸€ç±»äº§å“ï¼›çºµè½´æ˜¯äº§å“æ—ï¼Œä¹Ÿå°±æ˜¯åŒä¸€å“ç‰Œçš„äº§å“ï¼ŒåŒä¸€å“ç‰Œçš„äº§å“äº§è‡ªåŒä¸€ä¸ªå·¥å‚ã€‚</p><img src="/2022/12/23/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/../../java/èµ„æ–™/javaè®¾è®¡æ¨¡å¼ï¼ˆå›¾è§£+æ¡†æ¶æºç åˆ†æ+å®æˆ˜ï¼‰/Javaè®¾è®¡æ¨¡å¼èµ„æ–™day02/ç¬”è®°/img/image-20200401214509176.png" style="zoom:67%;"><img src="/2022/12/23/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/../../java/èµ„æ–™/javaè®¾è®¡æ¨¡å¼ï¼ˆå›¾è§£+æ¡†æ¶æºç åˆ†æ+å®æˆ˜ï¼‰/Javaè®¾è®¡æ¨¡å¼èµ„æ–™day02/ç¬”è®°/img/image-20200401222951963.png" style="zoom:67%;"><h4 id="2-4-1-æ¦‚å¿µ"><a href="#2-4-1-æ¦‚å¿µ" class="headerlink" title="2.4.1 æ¦‚å¿µ"></a>2.4.1 æ¦‚å¿µ</h4><p>æ˜¯ä¸€ç§ä¸ºè®¿é—®ç±»æä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç»„ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œä¸”è®¿é—®ç±»æ— é¡»æŒ‡å®šæ‰€è¦äº§å“çš„å…·ä½“ç±»å°±èƒ½å¾—åˆ°åŒæ—çš„ä¸åŒç­‰çº§çš„äº§å“çš„æ¨¡å¼ç»“æ„ã€‚</p><p>æŠ½è±¡å·¥å‚æ¨¡å¼æ˜¯å·¥å‚æ–¹æ³•æ¨¡å¼çš„å‡çº§ç‰ˆæœ¬ï¼Œå·¥å‚æ–¹æ³•æ¨¡å¼åªç”Ÿäº§ä¸€ä¸ªç­‰çº§çš„äº§å“ï¼Œè€ŒæŠ½è±¡å·¥å‚æ¨¡å¼å¯ç”Ÿäº§å¤šä¸ªç­‰çº§çš„äº§å“ã€‚</p><h4 id="2-4-2-ç»“æ„"><a href="#2-4-2-ç»“æ„" class="headerlink" title="2.4.2 ç»“æ„"></a>2.4.2 ç»“æ„</h4><p>æŠ½è±¡å·¥å‚æ¨¡å¼çš„ä¸»è¦è§’è‰²å¦‚ä¸‹ï¼š</p><ul><li>æŠ½è±¡å·¥å‚ï¼ˆAbstract Factoryï¼‰ï¼šæä¾›äº†åˆ›å»ºäº§å“çš„æ¥å£ï¼Œå®ƒåŒ…å«å¤šä¸ªåˆ›å»ºäº§å“çš„æ–¹æ³•ï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªä¸åŒç­‰çº§çš„äº§å“ã€‚</li><li>å…·ä½“å·¥å‚ï¼ˆConcrete Factoryï¼‰ï¼šä¸»è¦æ˜¯å®ç°æŠ½è±¡å·¥å‚ä¸­çš„å¤šä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå®Œæˆå…·ä½“äº§å“çš„åˆ›å»ºã€‚</li><li>æŠ½è±¡äº§å“ï¼ˆProductï¼‰ï¼šå®šä¹‰äº†äº§å“çš„è§„èŒƒï¼Œæè¿°äº†äº§å“çš„ä¸»è¦ç‰¹æ€§å’ŒåŠŸèƒ½ï¼ŒæŠ½è±¡å·¥å‚æ¨¡å¼æœ‰å¤šä¸ªæŠ½è±¡äº§å“ã€‚</li><li>å…·ä½“äº§å“ï¼ˆConcreteProductï¼‰ï¼šå®ç°äº†æŠ½è±¡äº§å“è§’è‰²æ‰€å®šä¹‰çš„æ¥å£ï¼Œç”±å…·ä½“å·¥å‚æ¥åˆ›å»ºï¼Œå®ƒ åŒå…·ä½“å·¥å‚ä¹‹é—´æ˜¯å¤šå¯¹ä¸€çš„å…³ç³»ã€‚</li></ul><h4 id="2-4-3-å®ç°"><a href="#2-4-3-å®ç°" class="headerlink" title="2.4.3 å®ç°"></a>2.4.3 å®ç°</h4><p>ç°å’–å•¡åº—ä¸šåŠ¡å‘ç”Ÿæ”¹å˜ï¼Œä¸ä»…è¦ç”Ÿäº§å’–å•¡è¿˜è¦ç”Ÿäº§ç”œç‚¹ï¼Œå¦‚ææ‹‰ç±³è‹ã€æŠ¹èŒ¶æ…•æ–¯ç­‰ï¼Œè¦æ˜¯æŒ‰ç…§å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œéœ€è¦å®šä¹‰ææ‹‰ç±³è‹ç±»ã€æŠ¹èŒ¶æ…•æ–¯ç±»ã€ææ‹‰ç±³è‹å·¥å‚ã€æŠ¹èŒ¶æ…•æ–¯å·¥å‚ã€ç”œç‚¹å·¥å‚ç±»ï¼Œå¾ˆå®¹æ˜“å‘ç”Ÿç±»çˆ†ç‚¸æƒ…å†µã€‚å…¶ä¸­æ‹¿é“å’–å•¡ã€ç¾å¼å’–å•¡æ˜¯ä¸€ä¸ªäº§å“ç­‰çº§ï¼Œéƒ½æ˜¯å’–å•¡ï¼›ææ‹‰ç±³è‹ã€æŠ¹èŒ¶æ…•æ–¯ä¹Ÿæ˜¯ä¸€ä¸ªäº§å“ç­‰çº§ï¼›æ‹¿é“å’–å•¡å’Œææ‹‰ç±³è‹æ˜¯åŒä¸€äº§å“æ—ï¼ˆä¹Ÿå°±æ˜¯éƒ½å±äºæ„å¤§åˆ©é£å‘³ï¼‰ï¼Œç¾å¼å’–å•¡å’ŒæŠ¹èŒ¶æ…•æ–¯æ˜¯åŒä¸€äº§å“æ—ï¼ˆä¹Ÿå°±æ˜¯éƒ½å±äºç¾å¼é£å‘³ï¼‰ã€‚æ‰€ä»¥è¿™ä¸ªæ¡ˆä¾‹å¯ä»¥ä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼å®ç°ã€‚ç±»å›¾å¦‚ä¸‹ï¼š</p><img src="/2022/12/23/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/../../java/èµ„æ–™/javaè®¾è®¡æ¨¡å¼ï¼ˆå›¾è§£+æ¡†æ¶æºç åˆ†æ+å®æˆ˜ï¼‰/Javaè®¾è®¡æ¨¡å¼èµ„æ–™day02/ç¬”è®°/img/æŠ½è±¡å·¥å‚æ¨¡å¼.png" style="zoom:67%;"><p>ä»£ç å¦‚ä¸‹ï¼š</p><p>æŠ½è±¡å·¥å‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DessertFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    Coffee <span class="title function_">createCoffee</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    Dessert <span class="title function_">createDessert</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…·ä½“å·¥å‚ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç¾å¼ç”œç‚¹å·¥å‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AmericanDessertFactory</span> <span class="keyword">implements</span> <span class="title class_">DessertFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Coffee <span class="title function_">createCoffee</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">AmericanCoffee</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Dessert <span class="title function_">createDessert</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">MatchaMousse</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//æ„å¤§åˆ©é£å‘³ç”œç‚¹å·¥å‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ItalyDessertFactory</span> <span class="keyword">implements</span> <span class="title class_">DessertFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Coffee <span class="title function_">createCoffee</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">LatteCoffee</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Dessert <span class="title function_">createDessert</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Tiramisu</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœè¦åŠ åŒä¸€ä¸ªäº§å“æ—çš„è¯ï¼Œåªéœ€è¦å†åŠ ä¸€ä¸ªå¯¹åº”çš„å·¥å‚ç±»å³å¯ï¼Œä¸éœ€è¦ä¿®æ”¹å…¶ä»–çš„ç±»ã€‚</p><h4 id="2-4-4-ä¼˜ç¼ºç‚¹"><a href="#2-4-4-ä¼˜ç¼ºç‚¹" class="headerlink" title="2.4.4 ä¼˜ç¼ºç‚¹"></a>2.4.4 ä¼˜ç¼ºç‚¹</h4><p><strong>ä¼˜ç‚¹ï¼š</strong></p><p>å½“ä¸€ä¸ªäº§å“æ—ä¸­çš„å¤šä¸ªå¯¹è±¡è¢«è®¾è®¡æˆä¸€èµ·å·¥ä½œæ—¶ï¼Œå®ƒèƒ½ä¿è¯å®¢æˆ·ç«¯å§‹ç»ˆåªä½¿ç”¨åŒä¸€ä¸ªäº§å“æ—ä¸­çš„å¯¹è±¡ã€‚</p><p>ä¸€ä¸ªäº§å“æ—çš„äº§å“ï¼Œåªéœ€è¦ä¸€ä¸ªæ¥å£æˆ–è€…ç±»ã€‚</p><p><strong>ç¼ºç‚¹ï¼š</strong></p><p>å½“äº§å“æ—ä¸­éœ€è¦å¢åŠ ä¸€ä¸ªæ–°çš„äº§å“æ—¶ï¼Œæ‰€æœ‰çš„å·¥å‚ç±»éƒ½éœ€è¦è¿›è¡Œä¿®æ”¹ã€‚</p><h4 id="2-4-5-ä½¿ç”¨åœºæ™¯"><a href="#2-4-5-ä½¿ç”¨åœºæ™¯" class="headerlink" title="2.4.5 ä½¿ç”¨åœºæ™¯"></a>2.4.5 ä½¿ç”¨åœºæ™¯</h4><ul><li><p>å½“éœ€è¦åˆ›å»ºçš„å¯¹è±¡æ˜¯ä¸€ç³»åˆ—ç›¸äº’å…³è”æˆ–ç›¸äº’ä¾èµ–çš„äº§å“æ—æ—¶ï¼Œå¦‚ç”µå™¨å·¥å‚ä¸­çš„ç”µè§†æœºã€æ´—è¡£æœºã€ç©ºè°ƒç­‰ã€‚</p></li><li><p>ç³»ç»Ÿä¸­æœ‰å¤šä¸ªäº§å“æ—ï¼Œä½†æ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„æŸä¸€æ—äº§å“ã€‚å¦‚æœ‰äººåªå–œæ¬¢ç©¿æŸä¸€ä¸ªå“ç‰Œçš„è¡£æœå’Œé‹ã€‚</p></li><li><p>ç³»ç»Ÿä¸­æä¾›äº†äº§å“çš„ç±»åº“ï¼Œä¸”æ‰€æœ‰äº§å“çš„æ¥å£ç›¸åŒï¼Œå®¢æˆ·ç«¯ä¸ä¾èµ–äº§å“å®ä¾‹çš„åˆ›å»ºç»†èŠ‚å’Œå†…éƒ¨ç»“æ„ã€‚</p></li></ul><p>å¦‚ï¼šè¾“å…¥æ³•æ¢çš®è‚¤ï¼Œä¸€æ•´å¥—ä¸€èµ·æ¢ã€‚ç”Ÿæˆä¸åŒæ“ä½œç³»ç»Ÿçš„ç¨‹åºã€‚</p><h3 id="2-5-æ¨¡å¼æ‰©å±•"><a href="#2-5-æ¨¡å¼æ‰©å±•" class="headerlink" title="2.5 æ¨¡å¼æ‰©å±•"></a>2.5 æ¨¡å¼æ‰©å±•</h3><p><strong>ç®€å•å·¥å‚+é…ç½®æ–‡ä»¶è§£é™¤è€¦åˆ</strong></p><p>å¯ä»¥é€šè¿‡å·¥å‚æ¨¡å¼+é…ç½®æ–‡ä»¶çš„æ–¹å¼è§£é™¤å·¥å‚å¯¹è±¡å’Œäº§å“å¯¹è±¡çš„è€¦åˆã€‚åœ¨å·¥å‚ç±»ä¸­åŠ è½½é…ç½®æ–‡ä»¶ä¸­çš„å…¨ç±»åï¼Œå¹¶é€šè¿‡åå°„çš„æ–¹å¼åˆ›å»ºå¯¹è±¡è¿›è¡Œå­˜å‚¨ï¼Œå®¢æˆ·ç«¯å¦‚æœéœ€è¦å¯¹è±¡ï¼Œç›´æ¥è¿›è¡Œè·å–å³å¯ã€‚</p><p>ç¬¬ä¸€æ­¥ï¼šå®šä¹‰é…ç½®æ–‡ä»¶</p><p>ä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ï¼Œæˆ‘ä»¬ä½¿ç”¨propertiesæ–‡ä»¶ä½œä¸ºé…ç½®æ–‡ä»¶ï¼Œåç§°ä¸ºbean.properties</p><p>æ³¨æ„ï¼šé…ç½®æ–‡ä»¶åº”è¯¥æ”¾åœ¨èµ„æºæ–‡ä»¶ä¸­</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">american</span>=<span class="string">com.itheima.pattern.factory.config_factory.AmericanCoffee</span></span><br><span class="line"><span class="attr">latte</span>=<span class="string">com.itheima.pattern.factory.config_factory.LatteCoffee</span></span><br></pre></td></tr></table></figure><p>ç¬¬äºŒæ­¥ï¼šæ”¹è¿›å·¥å‚ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CoffeeFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String,Coffee&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">p</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> CoffeeFactory.class.getClassLoader().getResourceAsStream(<span class="string">&quot;bean.properties&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            p.load(is);</span><br><span class="line">            <span class="comment">//éå†Propertiesé›†åˆå¯¹è±¡</span></span><br><span class="line">            Set&lt;Object&gt; keys = p.keySet();</span><br><span class="line">            <span class="keyword">for</span> (Object key : keys) &#123;</span><br><span class="line">                <span class="comment">//æ ¹æ®é”®è·å–å€¼ï¼ˆå…¨ç±»åï¼‰</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> p.getProperty((String) key);</span><br><span class="line">                <span class="comment">//è·å–å­—èŠ‚ç å¯¹è±¡</span></span><br><span class="line">                <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(className);</span><br><span class="line">                <span class="type">Coffee</span> <span class="variable">obj</span> <span class="operator">=</span> (Coffee) clazz.newInstance();</span><br><span class="line">                map.put((String)key,obj);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Coffee <span class="title function_">createCoffee</span><span class="params">(String name)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> map.get(name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é™æ€æˆå‘˜å˜é‡ç”¨æ¥å­˜å‚¨åˆ›å»ºçš„å¯¹è±¡ï¼ˆé”®å­˜å‚¨çš„æ˜¯åç§°ï¼Œå€¼å­˜å‚¨çš„æ˜¯å¯¹åº”çš„å¯¹è±¡ï¼‰ï¼Œè€Œè¯»å–é…ç½®æ–‡ä»¶ä»¥åŠåˆ›å»ºå¯¹è±¡å†™åœ¨é™æ€ä»£ç å—ä¸­ï¼Œç›®çš„å°±æ˜¯åªéœ€è¦æ‰§è¡Œä¸€æ¬¡ã€‚</p><h3 id="JDKæºç è§£æ-Collection-iteratoræ–¹æ³•"><a href="#JDKæºç è§£æ-Collection-iteratoræ–¹æ³•" class="headerlink" title="JDKæºç è§£æ-Collection.iteratoræ–¹æ³•"></a>JDKæºç è§£æ-Collection.iteratoræ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Demo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        list.add(<span class="string">&quot;ä»¤ç‹å†²&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;é£æ¸…æ‰¬&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;ä»»æˆ‘è¡Œ&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–è¿­ä»£å™¨å¯¹è±¡</span></span><br><span class="line">        Iterator&lt;String&gt; it = list.iterator();</span><br><span class="line">        <span class="comment">//ä½¿ç”¨è¿­ä»£å™¨éå†</span></span><br><span class="line">        <span class="keyword">while</span>(it.hasNext()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">ele</span> <span class="operator">=</span> it.next();</span><br><span class="line">            System.out.println(ele);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹ä¸Šé¢çš„ä»£ç å¤§å®¶åº”è¯¥å¾ˆç†Ÿï¼Œä½¿ç”¨è¿­ä»£å™¨éå†é›†åˆï¼Œè·å–é›†åˆä¸­çš„å…ƒç´ ã€‚è€Œå•åˆ—é›†åˆè·å–è¿­ä»£å™¨çš„æ–¹æ³•å°±ä½¿ç”¨åˆ°äº†å·¥å‚æ–¹æ³•æ¨¡å¼ã€‚æˆ‘ä»¬çœ‹é€šè¿‡ç±»å›¾çœ‹çœ‹ç»“æ„ï¼š</p><img src="/2022/12/23/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/../../java/èµ„æ–™/javaè®¾è®¡æ¨¡å¼ï¼ˆå›¾è§£+æ¡†æ¶æºç åˆ†æ+å®æˆ˜ï¼‰/Javaè®¾è®¡æ¨¡å¼èµ„æ–™day02/ç¬”è®°/img/JDKæºç è§£æ.png" style="zoom:75%;"><p>Collectionæ¥å£æ˜¯æŠ½è±¡å·¥å‚ç±»ï¼ŒArrayListæ˜¯å…·ä½“çš„å·¥å‚ç±»ï¼›Iteratoræ¥å£æ˜¯æŠ½è±¡å•†å“ç±»ï¼ŒArrayListç±»ä¸­çš„Iterå†…éƒ¨ç±»æ˜¯å…·ä½“çš„å•†å“ç±»ã€‚åœ¨å…·ä½“çš„å·¥å‚ç±»ä¸­iterator()æ–¹æ³•åˆ›å»ºå…·ä½“çš„å•†å“ç±»çš„å¯¹è±¡ã€‚</p><blockquote><p>å¦ï¼š</p><p>â€‹1,DateForamtç±»ä¸­çš„getInstance()æ–¹æ³•ä½¿ç”¨çš„æ˜¯å·¥å‚æ¨¡å¼ï¼›</p><p>â€‹2,Calendarç±»ä¸­çš„getInstance()æ–¹æ³•ä½¿ç”¨çš„æ˜¯å·¥å‚æ¨¡å¼ï¼›</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å•ä¾‹æ¨¡å¼</title>
      <link href="/2022/12/21/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
      <url>/2022/12/21/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<h2 id="1-å•ä¾‹æ¨¡å¼"><a href="#1-å•ä¾‹æ¨¡å¼" class="headerlink" title="1. å•ä¾‹æ¨¡å¼"></a>1. å•ä¾‹æ¨¡å¼</h2><blockquote><p>è¿™ç§æ¨¡å¼æ¶‰åŠåˆ°ä¸€ä¸ªå•ä¸€çš„ç±»ï¼Œè¯¥ç±»è´Ÿè´£åˆ›å»ºè‡ªå·±çš„å¯¹è±¡ï¼ŒåŒæ—¶ç¡®ä¿åªæœ‰å•ä¸ªå¯¹è±¡è¢«åˆ›å»ºã€‚è¿™ä¸ªç±»æä¾›äº†ä¸€ç§è®¿é—®å…¶å”¯ä¸€çš„å¯¹è±¡çš„æ–¹å¼ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ï¼Œä¸éœ€è¦å®ä¾‹åŒ–è¯¥ç±»çš„å¯¹è±¡ã€‚</p></blockquote><p>å•ä¾‹æ¨¡å¼çš„ä¸»è¦æœ‰ä»¥ä¸‹è§’è‰²ï¼š</p><ul><li>å•ä¾‹ç±»ã€‚åªèƒ½åˆ›å»ºä¸€ä¸ªå®ä¾‹çš„ç±»</li><li>è®¿é—®ç±»ã€‚ä½¿ç”¨å•ä¾‹ç±»</li></ul><p>å•ä¾‹è®¾è®¡æ¨¡å¼åˆ†ç±»ä¸¤ç§ï¼š</p><ul><li>é¥¿æ±‰å¼ï¼šç±»åŠ è½½å°±ä¼šå¯¼è‡´è¯¥å•å®ä¾‹å¯¹è±¡è¢«åˆ›å»º</li><li>æ‡’æ±‰å¼ï¼šç±»åŠ è½½ä¸ä¼šå¯¼è‡´è¯¥å•å®ä¾‹å¯¹è±¡è¢«åˆ›å»ºï¼Œè€Œæ˜¯é¦–æ¬¡ä½¿ç”¨è¯¥å¯¹è±¡æ—¶æ‰ä¼šåˆ›å»º</li></ul><h3 id="1-1-é¥¿æ±‰å¼æ„å»º"><a href="#1-1-é¥¿æ±‰å¼æ„å»º" class="headerlink" title="1.1 é¥¿æ±‰å¼æ„å»º"></a>1.1 é¥¿æ±‰å¼æ„å»º</h3><h4 id="1-1-1-é™æ€æˆå‘˜å˜é‡æ–¹å¼"><a href="#1-1-1-é™æ€æˆå‘˜å˜é‡æ–¹å¼" class="headerlink" title="1.1.1 é™æ€æˆå‘˜å˜é‡æ–¹å¼"></a>1.1.1 é™æ€æˆå‘˜å˜é‡æ–¹å¼</h4><p>æ­¥éª¤ï¼š</p><ol><li><p>åˆ›å»ºç§æœ‰æ„é€ æ–¹æ³•ï¼Œè¿™æ ·å°±å¯ä»¥è®©å…¶ä»–ç±»æ— æ³•åˆ›å»ºå¯¹è±¡</p></li><li><p>åœ¨æœ¬ç±»ä¸­æˆå‘˜ä½ç½®åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡</p></li><li><p>æä¾›ä¸€ä¸ªå…¬å…±çš„è®¿é—®æ–¹å¼ï¼Œè®©å¤–ç•Œè·å–è¯¥å¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.pattern.singleton.demo1;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment"> * é¥¿æ±‰å¼ï¼šé™æ€æˆå‘˜å˜é‡æ–¹å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> cfz</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 1. ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * è¿™æ ·å°±å¯ä»¥è®©å…¶ä»–ç±»æ— æ³•åˆ›å»ºå¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 2. åœ¨æœ¬ç±»ä¸­æˆå‘˜ä½ç½®åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Singleton</span> <span class="variable">instance</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 3. æä¾›ä¸€ä¸ªå…¬å…±çš„è®¿é—®æ–¹å¼ï¼Œè®©å¤–ç•Œè·å–è¯¥å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ol><h4 id="1-1-2-é™æ€ä»£ç å—æ–¹å¼"><a href="#1-1-2-é™æ€ä»£ç å—æ–¹å¼" class="headerlink" title="1.1.2 é™æ€ä»£ç å—æ–¹å¼"></a>1.1.2 é™æ€ä»£ç å—æ–¹å¼</h4><p>æ­¥éª¤ï¼š</p><ol><li>åˆ›å»ºç§æœ‰æ„é€ æ–¹æ³•ï¼Œè¿™æ ·å°±å¯ä»¥è®©å…¶ä»–ç±»æ— æ³•åˆ›å»ºå¯¹è±¡</li><li>åœ¨æœ¬ç±»ä¸­æˆå‘˜ä½ç½®åªå£°æ˜Singletonç±»å‹çš„å˜é‡ï¼Œè€Œä¸è¿›è¡Œèµ‹å€¼ï¼ˆå®ä¾‹çš„åˆ›å»ºï¼‰</li><li>åœ¨é™æ€ä»£ç å—ä¸­èµ‹å€¼</li><li>æä¾›ä¸€ä¸ªå…¬å…±çš„è®¿é—®æ–¹å¼ï¼Œè®©å¤–ç•Œè·å–è¯¥å¯¹è±¡</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.itheima.pattern.singleton.demo2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment"> * é¥¿æ±‰å¼ï¼šé™æ€ä»£ç å—æ–¹å¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> cfz</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 1. ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * è¿™æ ·å°±å¯ä»¥è®©å…¶ä»–ç±»æ— æ³•åˆ›å»ºå¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 2. åœ¨æœ¬ç±»ä¸­æˆå‘˜ä½ç½®åªå£°æ˜Singletonç±»å‹çš„å˜é‡ï¼Œè€Œä¸è¿›è¡Œèµ‹å€¼ï¼ˆå®ä¾‹çš„åˆ›å»ºï¼‰</span></span><br><span class="line"><span class="comment">     * åˆå§‹å€¼ä¸ºnull</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 3. åœ¨é™æ€ä»£ç å—ä¸­èµ‹å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        instance = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 4. æä¾›ä¸€ä¸ªå…¬å…±çš„è®¿é—®æ–¹å¼ï¼Œè®©å¤–ç•Œè·å–è¯¥å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><font color="red">è¯´æ˜ï¼š</font></p><p>â€‹è¯¥æ–¹å¼åœ¨æˆå‘˜ä½ç½®å£°æ˜Singletonç±»å‹çš„é™æ€å˜é‡ï¼Œè€Œå¯¹è±¡çš„åˆ›å»ºæ˜¯åœ¨é™æ€ä»£ç å—ä¸­ï¼Œä¹Ÿæ˜¯å¯¹ç€ç±»çš„åŠ è½½è€Œåˆ›å»ºã€‚æ‰€ä»¥å’Œé¥¿æ±‰å¼çš„æ–¹å¼1åŸºæœ¬ä¸Šä¸€æ ·ï¼Œå½“ç„¶è¯¥æ–¹å¼ä¹Ÿå­˜åœ¨å†…å­˜æµªè´¹é—®é¢˜ã€‚</p><h3 id="1-2-æ‡’æ±‰å¼æ„å»º"><a href="#1-2-æ‡’æ±‰å¼æ„å»º" class="headerlink" title="1.2 æ‡’æ±‰å¼æ„å»º"></a>1.2 æ‡’æ±‰å¼æ„å»º</h3><h4 id="1-2-1-çº¿ç¨‹ä¸å®‰å…¨"><a href="#1-2-1-çº¿ç¨‹ä¸å®‰å…¨" class="headerlink" title="1.2.1 çº¿ç¨‹ä¸å®‰å…¨"></a>1.2.1 çº¿ç¨‹ä¸å®‰å…¨</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‡’æ±‰å¼</span></span><br><span class="line"><span class="comment"> *  çº¿ç¨‹ä¸å®‰å…¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœ¨æˆå‘˜ä½ç½®åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font color="red">è¯´æ˜ï¼š</font></p><p>â€‹ä»ä¸Šé¢ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¯¥æ–¹å¼åœ¨æˆå‘˜ä½ç½®å£°æ˜Singletonç±»å‹çš„é™æ€å˜é‡ï¼Œå¹¶æ²¡æœ‰è¿›è¡Œå¯¹è±¡çš„èµ‹å€¼æ“ä½œï¼Œé‚£ä¹ˆä»€ä¹ˆæ—¶å€™èµ‹å€¼çš„å‘¢ï¼Ÿå½“è°ƒç”¨getInstance()æ–¹æ³•è·å–Singletonç±»çš„å¯¹è±¡çš„æ—¶å€™æ‰åˆ›å»ºSingletonç±»çš„å¯¹è±¡ï¼Œè¿™æ ·å°±å®ç°äº†æ‡’åŠ è½½çš„æ•ˆæœã€‚ä½†æ˜¯ï¼Œå¦‚æœæ˜¯å¤šçº¿ç¨‹ç¯å¢ƒï¼Œä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</p><h4 id="1-2-2-çº¿ç¨‹å®‰å…¨"><a href="#1-2-2-çº¿ç¨‹å®‰å…¨" class="headerlink" title="1.2.2 çº¿ç¨‹å®‰å…¨"></a>1.2.2 çº¿ç¨‹å®‰å…¨</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ‡’æ±‰å¼</span></span><br><span class="line"><span class="comment"> *  çº¿ç¨‹å®‰å…¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœ¨æˆå‘˜ä½ç½®åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">synchronized</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font color="red">è¯´æ˜ï¼š</font></p><p>â€‹è¯¥æ–¹å¼ä¹Ÿå®ç°äº†æ‡’åŠ è½½æ•ˆæœï¼ŒåŒæ—¶åˆè§£å†³äº†çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚ä½†æ˜¯åœ¨getInstance()æ–¹æ³•ä¸Šæ·»åŠ äº†synchronizedå…³é”®å­—ï¼Œå¯¼è‡´è¯¥æ–¹æ³•çš„æ‰§è¡Œæ•ˆæœç‰¹åˆ«ä½ã€‚ä»ä¸Šé¢ä»£ç æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œå…¶å®å°±æ˜¯åœ¨åˆå§‹åŒ–instanceçš„æ—¶å€™æ‰ä¼šå‡ºç°çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä¸€æ—¦åˆå§‹åŒ–å®Œæˆå°±ä¸å­˜åœ¨äº†ã€‚</p><h4 id="1-2-3-åŒé‡æ£€æŸ¥é”"><a href="#1-2-3-åŒé‡æ£€æŸ¥é”" class="headerlink" title="1.2.3 åŒé‡æ£€æŸ¥é”"></a>1.2.3 åŒé‡æ£€æŸ¥é”</h4><p>å†æ¥è®¨è®ºä¸€ä¸‹æ‡’æ±‰æ¨¡å¼ä¸­åŠ é”çš„é—®é¢˜ï¼Œå¯¹äº <code>getInstance()</code> æ–¹æ³•æ¥è¯´ï¼Œç»å¤§éƒ¨åˆ†çš„æ“ä½œéƒ½æ˜¯è¯»æ“ä½œï¼Œè¯»æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ²¡å¿…è®©æ¯ä¸ªçº¿ç¨‹å¿…é¡»æŒæœ‰é”æ‰èƒ½è°ƒç”¨è¯¥æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦è°ƒæ•´åŠ é”çš„æ—¶æœºã€‚ç”±æ­¤ä¹Ÿäº§ç”Ÿäº†ä¸€ç§æ–°çš„å®ç°æ¨¡å¼ï¼šåŒé‡æ£€æŸ¥é”æ¨¡å¼ã€‚</p><p>åŒé‡æ£€æŸ¥é”æ¨¡å¼æ˜¯ä¸€ç§éå¸¸å¥½çš„å•ä¾‹å®ç°æ¨¡å¼ï¼Œè§£å†³äº†å•ä¾‹ã€æ€§èƒ½ã€çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä¸Šé¢çš„åŒé‡æ£€æµ‹é”æ¨¡å¼çœ‹ä¸Šå»å®Œç¾æ— ç¼ºï¼Œå…¶å®æ˜¯å­˜åœ¨é—®é¢˜ï¼Œåœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½ä¼šå‡ºç°ç©ºæŒ‡é’ˆé—®é¢˜ï¼Œå‡ºç°é—®é¢˜çš„åŸå› æ˜¯JVMåœ¨å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™ä¼šè¿›è¡Œä¼˜åŒ–å’ŒæŒ‡ä»¤é‡æ’åºæ“ä½œã€‚</p><p>è¦è§£å†³åŒé‡æ£€æŸ¥é”æ¨¡å¼å¸¦æ¥ç©ºæŒ‡é’ˆå¼‚å¸¸çš„é—®é¢˜ï¼Œåªéœ€è¦ä½¿ç”¨ <code>volatile</code> å…³é”®å­—, <code>volatile</code> å…³é”®å­—å¯ä»¥ä¿è¯å¯è§æ€§å’Œæœ‰åºæ€§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åŒé‡æ£€æŸ¥é”æ–¹å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line"><span class="comment">//ç¬¬ä¸€æ¬¡åˆ¤æ–­ï¼Œå¦‚æœinstanceä¸ä¸ºnullï¼Œä¸è¿›å…¥æŠ¢é”é˜¶æ®µï¼Œç›´æ¥è¿”å›å®é™…</span></span><br><span class="line">        <span class="keyword">if</span>(instance == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">                <span class="comment">//æŠ¢åˆ°é”ä¹‹åå†æ¬¡åˆ¤æ–­æ˜¯å¦ä¸ºç©º</span></span><br><span class="line">                <span class="keyword">if</span>(instance == <span class="literal">null</span>) &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font color="red">å°ç»“ï¼š</font></p><p>æ·»åŠ  <code>volatile</code> å…³é”®å­—ä¹‹åçš„åŒé‡æ£€æŸ¥é”æ¨¡å¼æ˜¯ä¸€ç§æ¯”è¾ƒå¥½çš„å•ä¾‹å®ç°æ¨¡å¼ï¼Œèƒ½å¤Ÿä¿è¯åœ¨å¤šçº¿ç¨‹çš„æƒ…å†µä¸‹çº¿ç¨‹å®‰å…¨ä¹Ÿä¸ä¼šæœ‰æ€§èƒ½é—®é¢˜ã€‚</p><h4 id="1-2-4-é™æ€å†…éƒ¨ç±»æ–¹å¼"><a href="#1-2-4-é™æ€å†…éƒ¨ç±»æ–¹å¼" class="headerlink" title="1.2.4 é™æ€å†…éƒ¨ç±»æ–¹å¼"></a>1.2.4 é™æ€å†…éƒ¨ç±»æ–¹å¼</h4><p>é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼ä¸­å®ä¾‹ç”±å†…éƒ¨ç±»åˆ›å»ºï¼Œç”±äº JVM åœ¨åŠ è½½å¤–éƒ¨ç±»çš„è¿‡ç¨‹ä¸­, æ˜¯ä¸ä¼šåŠ è½½é™æ€å†…éƒ¨ç±»çš„, <strong>åªæœ‰å†…éƒ¨ç±»çš„å±æ€§&#x2F;æ–¹æ³•è¢«è°ƒç”¨æ—¶æ‰ä¼šè¢«åŠ è½½, å¹¶åˆå§‹åŒ–å…¶é™æ€å±æ€§</strong>ã€‚é™æ€å±æ€§ç”±äºè¢« <code>static</code> ä¿®é¥°ï¼Œä¿è¯åªè¢«å®ä¾‹åŒ–ä¸€æ¬¡ï¼Œå¹¶ä¸”ä¸¥æ ¼ä¿è¯å®ä¾‹åŒ–é¡ºåºã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é™æ€å†…éƒ¨ç±»æ–¹å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">SingletonHolder</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Singleton</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font color="red">è¯´æ˜ï¼š</font></p><p>â€‹ç¬¬ä¸€æ¬¡åŠ è½½Singletonç±»æ—¶ä¸ä¼šå»åˆå§‹åŒ–INSTANCEï¼Œåªæœ‰ç¬¬ä¸€æ¬¡è°ƒç”¨getInstanceï¼Œè™šæ‹ŸæœºåŠ è½½SingletonHolder</p><p>å¹¶åˆå§‹åŒ–INSTANCEï¼Œè¿™æ ·ä¸ä»…èƒ½ç¡®ä¿çº¿ç¨‹å®‰å…¨ï¼Œä¹Ÿèƒ½ä¿è¯ Singleton ç±»çš„å”¯ä¸€æ€§ã€‚</p><p><font color="red">å°ç»“ï¼š</font></p><p>â€‹é™æ€å†…éƒ¨ç±»å•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§ä¼˜ç§€çš„å•ä¾‹æ¨¡å¼ï¼Œæ˜¯å¼€æºé¡¹ç›®ä¸­æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ç§å•ä¾‹æ¨¡å¼ã€‚åœ¨æ²¡æœ‰åŠ ä»»ä½•é”çš„æƒ…å†µä¸‹ï¼Œä¿è¯äº†å¤šçº¿ç¨‹ä¸‹çš„å®‰å…¨ï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•æ€§èƒ½å½±å“å’Œç©ºé—´çš„æµªè´¹ã€‚</p><ol><li><p>æšä¸¾æ–¹å¼</p><p>æšä¸¾ç±»å®ç°å•ä¾‹æ¨¡å¼æ˜¯æåŠ›æ¨èçš„å•ä¾‹å®ç°æ¨¡å¼ï¼Œå› ä¸ºæšä¸¾ç±»å‹æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¹¶ä¸”åªä¼šè£…è½½ä¸€æ¬¡ï¼Œè®¾è®¡è€…å……åˆ†çš„åˆ©ç”¨äº†æšä¸¾çš„è¿™ä¸ªç‰¹æ€§æ¥å®ç°å•ä¾‹æ¨¡å¼ï¼Œæšä¸¾çš„å†™æ³•éå¸¸ç®€å•ï¼Œè€Œä¸”æšä¸¾ç±»å‹æ˜¯æ‰€ç”¨å•ä¾‹å®ç°ä¸­å”¯ä¸€ä¸€ç§ä¸ä¼šè¢«ç ´åçš„å•ä¾‹å®ç°æ¨¡å¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æšä¸¾æ–¹å¼</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line">    INSTANCE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font color="red">è¯´æ˜ï¼š</font></p><p>â€‹æšä¸¾æ–¹å¼å±äºæ¶æ±‰å¼æ–¹å¼ã€‚</p></li></ol><h3 id="1-3-å­˜åœ¨çš„é—®é¢˜"><a href="#1-3-å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="1.3 å­˜åœ¨çš„é—®é¢˜"></a>1.3 å­˜åœ¨çš„é—®é¢˜</h3><h4 id="1-3-1-é—®é¢˜æ¼”ç¤º"><a href="#1-3-1-é—®é¢˜æ¼”ç¤º" class="headerlink" title="1.3.1 é—®é¢˜æ¼”ç¤º"></a>1.3.1 é—®é¢˜æ¼”ç¤º</h4><p>ç ´åå•ä¾‹æ¨¡å¼ï¼š</p><p>ä½¿ä¸Šé¢å®šä¹‰çš„å•ä¾‹ç±»ï¼ˆSingletonï¼‰å¯ä»¥åˆ›å»ºå¤šä¸ªå¯¹è±¡ï¼Œæšä¸¾æ–¹å¼é™¤å¤–ã€‚æœ‰ä¸¤ç§æ–¹å¼ï¼Œåˆ†åˆ«æ˜¯åºåˆ—åŒ–å’Œåå°„ã€‚</p><ul><li><p>åºåˆ—åŒ–ååºåˆ—åŒ–ï¼ˆååºåˆ—åŒ–è¯»å‡ºæ¥çš„å¯¹è±¡æ˜¯åŸæ¥å¯¹è±¡çš„æ‹·è´ï¼‰</p><p><strong>Singletonç±»ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">SingletonHolder</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Singleton</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Testç±»ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//å¾€æ–‡ä»¶ä¸­å†™å¯¹è±¡</span></span><br><span class="line">        <span class="comment">//writeObject2File();</span></span><br><span class="line">        <span class="comment">//ä»æ–‡ä»¶ä¸­è¯»å–å¯¹è±¡</span></span><br><span class="line">        <span class="type">Singleton</span> <span class="variable">s1</span> <span class="operator">=</span> readObjectFromFile();</span><br><span class="line">        <span class="type">Singleton</span> <span class="variable">s2</span> <span class="operator">=</span> readObjectFromFile();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­ä¸¤ä¸ªååºåˆ—åŒ–åçš„å¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">        System.out.println(s1 == s2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton <span class="title function_">readObjectFromFile</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡è¾“å…¥æµå¯¹è±¡</span></span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;C:\\Users\\Think\\Desktop\\a.txt&quot;</span>));</span><br><span class="line">        <span class="comment">//ç¬¬ä¸€ä¸ªè¯»å–Singletonå¯¹è±¡</span></span><br><span class="line">        <span class="type">Singleton</span> <span class="variable">instance</span> <span class="operator">=</span> (Singleton) ois.readObject();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">writeObject2File</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//è·å–Singletonç±»çš„å¯¹è±¡</span></span><br><span class="line">        <span class="type">Singleton</span> <span class="variable">instance</span> <span class="operator">=</span> Singleton.getInstance();</span><br><span class="line">        <span class="comment">//åˆ›å»ºå¯¹è±¡è¾“å‡ºæµ</span></span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;C:\\Users\\Think\\Desktop\\a.txt&quot;</span>));</span><br><span class="line">        <span class="comment">//å°†instanceå¯¹è±¡å†™å‡ºåˆ°æ–‡ä»¶ä¸­</span></span><br><span class="line">        oos.writeObject(instance);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸Šé¢ä»£ç è¿è¡Œç»“æœæ˜¯<code>false</code>ï¼Œè¡¨æ˜åºåˆ—åŒ–å’Œååºåˆ—åŒ–å·²ç»ç ´åäº†å•ä¾‹è®¾è®¡æ¨¡å¼ã€‚</p></blockquote></li><li><p>åå°„</p><p>é€šè¿‡æš´åŠ›åå°„ç›´æ¥è·å–Singletonç±»çš„ç§æœ‰æ— å‚æ„é€ æ–¹æ³•å¯¹è±¡</p><p><strong>Singletonç±»ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(instance != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> instance;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">            <span class="keyword">if</span>(instance != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> instance;</span><br><span class="line">            &#125;</span><br><span class="line">            instance = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">            <span class="keyword">return</span> instance;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Testç±»ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="comment">//è·å–Singletonç±»çš„å­—èŠ‚ç å¯¹è±¡</span></span><br><span class="line">        <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Singleton.class;</span><br><span class="line">        <span class="comment">//é€šè¿‡æš´åŠ›åå°„ç›´æ¥è·å–Singletonç±»çš„ç§æœ‰æ— å‚æ„é€ æ–¹æ³•å¯¹è±¡</span></span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">constructor</span> <span class="operator">=</span> clazz.getDeclaredConstructor();</span><br><span class="line">        <span class="comment">//å–æ¶ˆè®¿é—®æ£€æŸ¥</span></span><br><span class="line">        constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºSingletonç±»çš„å¯¹è±¡s1</span></span><br><span class="line">        <span class="type">Singleton</span> <span class="variable">s1</span> <span class="operator">=</span> (Singleton) constructor.newInstance();</span><br><span class="line">        <span class="comment">//åˆ›å»ºSingletonç±»çš„å¯¹è±¡s2</span></span><br><span class="line">        <span class="type">Singleton</span> <span class="variable">s2</span> <span class="operator">=</span> (Singleton) constructor.newInstance();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­é€šè¿‡åå°„åˆ›å»ºçš„ä¸¤ä¸ªSingletonå¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">        System.out.println(s1 == s2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸Šé¢ä»£ç è¿è¡Œç»“æœæ˜¯<code>false</code>ï¼Œè¡¨æ˜åºåˆ—åŒ–å’Œååºåˆ—åŒ–å·²ç»ç ´åäº†å•ä¾‹è®¾è®¡æ¨¡å¼</p></blockquote></li></ul><blockquote><p><font color="red">æ³¨æ„ï¼š</font>æšä¸¾æ–¹å¼ä¸ä¼šå‡ºç°è¿™ä¸¤ä¸ªé—®é¢˜ã€‚</p></blockquote><h4 id="1-3-2-é—®é¢˜çš„è§£å†³"><a href="#1-3-2-é—®é¢˜çš„è§£å†³" class="headerlink" title="1.3.2 é—®é¢˜çš„è§£å†³"></a>1.3.2 é—®é¢˜çš„è§£å†³</h4><ul><li><p>åºåˆ—åŒ–ã€ååºåˆ—æ–¹å¼ç ´åå•ä¾‹æ¨¡å¼çš„è§£å†³æ–¹æ³•</p><p>åœ¨Singletonç±»ä¸­æ·»åŠ <code>readResolve()</code>æ–¹æ³•ï¼Œåœ¨ååºåˆ—åŒ–æ—¶è¢«åå°„è°ƒç”¨ï¼Œå¦‚æœå®šä¹‰äº†è¿™ä¸ªæ–¹æ³•ï¼Œå°±è¿”å›è¿™ä¸ªæ–¹æ³•çš„å€¼ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰ï¼Œåˆ™è¿”å›æ–°newå‡ºæ¥çš„å¯¹è±¡ã€‚</p><p><code>readResolve()</code>è¿™æ˜¯ååºåˆ—ä¸­çš„æ–¹æ³•ï¼Œåœ¨è¿™é‡Œå°±ç›¸å½“äºé‡å†™äº†è¯¥æ–¹æ³•ï¼Œåé¢ååºåˆ—åŒ–æ—¶ï¼Œå°±ä¼šè°ƒç”¨æ­¤æ–¹æ³•ã€‚</p><p><strong>Singletonç±»ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">SingletonHolder</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Singleton</span> <span class="variable">INSTANCE</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¸‹é¢æ˜¯ä¸ºäº†è§£å†³åºåˆ—åŒ–ååºåˆ—åŒ–ç ´è§£å•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Object <span class="title function_">readResolve</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.INSTANCE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æºç è§£æï¼š</strong></p><p>ObjectInputStreamç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> Object <span class="title function_">readObject</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// if nested read, passHandle contains handle of enclosing object</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">outerHandle</span> <span class="operator">=</span> passHandle;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> readObject0(<span class="literal">false</span>);<span class="comment">//é‡ç‚¹æŸ¥çœ‹readObject0æ–¹æ³•</span></span><br><span class="line">    .....</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">private</span> Object <span class="title function_">readObject0</span><span class="params">(<span class="type">boolean</span> unshared)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">...</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line"><span class="keyword">switch</span> (tc) &#123;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">case</span> TC_OBJECT:</span><br><span class="line"><span class="keyword">return</span> checkResolve(readOrdinaryObject(unshared));<span class="comment">//é‡ç‚¹æŸ¥çœ‹readOrdinaryObjectæ–¹æ³•</span></span><br><span class="line">...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        depth--;</span><br><span class="line">        bin.setBlockDataMode(oldMode);</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">private</span> Object <span class="title function_">readOrdinaryObject</span><span class="params">(<span class="type">boolean</span> unshared)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">...</span><br><span class="line"><span class="comment">//isInstantiable è¿”å›trueï¼Œæ‰§è¡Œ desc.newInstance()ï¼Œé€šè¿‡åå°„åˆ›å»ºæ–°çš„å•ä¾‹ç±»ï¼Œ</span></span><br><span class="line">    obj = desc.isInstantiable() ? desc.newInstance() : <span class="literal">null</span>; </span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// åœ¨Singletonç±»ä¸­æ·»åŠ  readResolve æ–¹æ³•å desc.hasReadResolveMethod() æ–¹æ³•æ‰§è¡Œç»“æœä¸ºtrue</span></span><br><span class="line">    <span class="keyword">if</span> (obj != <span class="literal">null</span> &amp;&amp; handles.lookupException(passHandle) == <span class="literal">null</span> &amp;&amp; desc.hasReadResolveMethod()) &#123;</span><br><span class="line">    <span class="comment">// é€šè¿‡åå°„è°ƒç”¨ Singleton ç±»ä¸­çš„ readResolve æ–¹æ³•ï¼Œå°†è¿”å›å€¼èµ‹å€¼ç»™repå˜é‡</span></span><br><span class="line">    <span class="comment">// è¿™æ ·å¤šæ¬¡è°ƒç”¨ObjectInputStreamç±»ä¸­çš„readObjectæ–¹æ³•ï¼Œç»§è€Œå°±ä¼šè°ƒç”¨æˆ‘ä»¬å®šä¹‰çš„readResolveæ–¹æ³•ï¼Œæ‰€ä»¥è¿”å›çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</span></span><br><span class="line">    <span class="type">Object</span> <span class="variable">rep</span> <span class="operator">=</span> desc.invokeReadResolve(obj);</span><br><span class="line">     ...</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> obj;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>åå°„æ–¹å¼ç ´è§£å•ä¾‹çš„è§£å†³æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Singleton</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Singleton</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">           åå°„ç ´è§£å•ä¾‹æ¨¡å¼éœ€è¦æ·»åŠ çš„ä»£ç </span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">if</span>(instance != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//å†…éƒ¨ç±»åœ¨ç±»åŠ è½½æ—¶ä¼šåŠ é”</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> Singleton instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å¯¹å¤–æä¾›é™æ€æ–¹æ³•è·å–è¯¥å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Singleton <span class="title function_">getInstance</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(instance != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> instance;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">synchronized</span> (Singleton.class) &#123;</span><br><span class="line">            <span class="keyword">if</span>(instance != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> instance;</span><br><span class="line">            &#125;</span><br><span class="line">            instance = <span class="keyword">new</span> <span class="title class_">Singleton</span>();</span><br><span class="line">            <span class="keyword">return</span> instance;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><font color="red">è¯´æ˜:</font></p><p>â€‹è¿™ç§æ–¹å¼æ¯”è¾ƒå¥½ç†è§£ã€‚å½“é€šè¿‡åå°„æ–¹å¼è°ƒç”¨æ„é€ æ–¹æ³•è¿›è¡Œåˆ›å»ºåˆ›å»ºæ—¶ï¼Œç›´æ¥æŠ›å¼‚å¸¸ã€‚ä¸è¿è¡Œæ­¤ä¸­æ“ä½œã€‚</p></li></ul><h3 id="1-4-JDKæºç è§£æ-Runtimeç±»"><a href="#1-4-JDKæºç è§£æ-Runtimeç±»" class="headerlink" title="1.4 JDKæºç è§£æ-Runtimeç±»"></a>1.4 JDKæºç è§£æ-Runtimeç±»</h3><p>Runtimeç±»å°±æ˜¯ä½¿ç”¨çš„å•ä¾‹è®¾è®¡æ¨¡å¼ã€‚</p><ol><li><p>é€šè¿‡æºä»£ç æŸ¥çœ‹ä½¿ç”¨çš„æ˜¯å“ªå„¿ç§å•ä¾‹æ¨¡å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Runtime</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Runtime</span> <span class="variable">currentRuntime</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Runtime</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns the runtime object associated with the current Java application.</span></span><br><span class="line"><span class="comment">     * Most of the methods of class &lt;code&gt;Runtime&lt;/code&gt; are instance</span></span><br><span class="line"><span class="comment">     * methods and must be invoked with respect to the current runtime object.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>  the &lt;code&gt;Runtime&lt;/code&gt; object associated with the current</span></span><br><span class="line"><span class="comment">     *          Java application.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Runtime <span class="title function_">getRuntime</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> currentRuntime;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** Don&#x27;t let anyone else instantiate this class */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">Runtime</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ä¸Šé¢æºä»£ç ä¸­å¯ä»¥çœ‹å‡ºRuntimeç±»ä½¿ç”¨çš„æ˜¯é¥¿æ±‰å¼ï¼ˆé™æ€å±æ€§ï¼‰æ–¹å¼æ¥å®ç°å•ä¾‹æ¨¡å¼çš„ã€‚</p></li><li><p>ä½¿ç”¨Runtimeç±»ä¸­çš„æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RuntimeDemo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">//è·å–Runtimeç±»å¯¹è±¡</span></span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è¿”å› Java è™šæ‹Ÿæœºä¸­çš„å†…å­˜æ€»é‡ã€‚</span></span><br><span class="line">        System.out.println(runtime.totalMemory());</span><br><span class="line">        <span class="comment">//è¿”å› Java è™šæ‹Ÿæœºè¯•å›¾ä½¿ç”¨çš„æœ€å¤§å†…å­˜é‡ã€‚</span></span><br><span class="line">        System.out.println(runtime.maxMemory());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºä¸€ä¸ªæ–°çš„è¿›ç¨‹æ‰§è¡ŒæŒ‡å®šçš„å­—ç¬¦ä¸²å‘½ä»¤ï¼Œè¿”å›è¿›ç¨‹å¯¹è±¡</span></span><br><span class="line">        <span class="type">Process</span> <span class="variable">process</span> <span class="operator">=</span> runtime.exec(<span class="string">&quot;ipconfig&quot;</span>);</span><br><span class="line">        <span class="comment">//è·å–å‘½ä»¤æ‰§è¡Œåçš„ç»“æœï¼Œé€šè¿‡è¾“å…¥æµè·å–</span></span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> process.getInputStream();</span><br><span class="line">        <span class="type">byte</span>[] arr = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span> * <span class="number">1024</span>* <span class="number">100</span>];</span><br><span class="line">        <span class="type">int</span> <span class="variable">b</span> <span class="operator">=</span> inputStream.read(arr);</span><br><span class="line">        System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(arr,<span class="number">0</span>,b,<span class="string">&quot;gbk&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> è®¾è®¡æ¨¡å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°ç»„</title>
      <link href="/2022/12/21/%E6%95%B0%E7%BB%84/"/>
      <url>/2022/12/21/%E6%95%B0%E7%BB%84/</url>
      
        <content type="html"><![CDATA[<p>æ€ç»´å¯¼å›¾ï¼š</p><p><img src="/2022/12/21/%E6%95%B0%E7%BB%84/%E6%95%B0%E7%BB%84.png"></p><h2 id="1-æ•°ç»„"><a href="#1-æ•°ç»„" class="headerlink" title="1. æ•°ç»„"></a>1. æ•°ç»„</h2><h3 id="1-1-æ•°ç»„ç†è®ºåŸºç¡€"><a href="#1-1-æ•°ç»„ç†è®ºåŸºç¡€" class="headerlink" title="1.1 æ•°ç»„ç†è®ºåŸºç¡€"></a>1.1 æ•°ç»„ç†è®ºåŸºç¡€</h3><p>æ•°ç»„æ˜¯å­˜æ”¾åœ¨è¿ç»­å†…å­˜ç©ºé—´ä¸Šçš„ç›¸åŒç±»å‹æ•°æ®çš„é›†åˆã€‚</p><p>ä¸¤ç‚¹æ³¨æ„ï¼š</p><ol><li>æ•°ç»„ä¸‹æ ‡éƒ½æ˜¯ä»0å¼€å§‹çš„ã€‚</li><li>æ•°ç»„å†…å­˜ç©ºé—´çš„åœ°å€æ˜¯è¿ç»­çš„ã€‚</li></ol><p>æ­£æ˜¯å› ä¸ºæ•°ç»„çš„åœ¨å†…å­˜ç©ºé—´çš„åœ°å€æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨åˆ é™¤æˆ–è€…å¢æ·»å…ƒç´ çš„æ—¶å€™ï¼Œå°±éš¾å…è¦ç§»åŠ¨å…¶ä»–å…ƒç´ çš„åœ°å€ã€‚</p><h3 id="1-2-äºŒåˆ†æŸ¥æ‰¾ï¼ˆ704ï¼‰"><a href="#1-2-äºŒåˆ†æŸ¥æ‰¾ï¼ˆ704ï¼‰" class="headerlink" title="1.2 äºŒåˆ†æŸ¥æ‰¾ï¼ˆ704ï¼‰"></a>1.2 äºŒåˆ†æŸ¥æ‰¾ï¼ˆ704ï¼‰</h3><ol><li><p>yæ€»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">search</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> nums.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (l &lt; r) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (nums[mid] &gt;= target) &#123;</span><br><span class="line">                r = mid;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                l = mid + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (nums[l] != target) &#123;</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> l;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>éšæƒ³å½•</p><p>æ³¨æ„ï¼šæ˜ç¡®åŒºé—´å®šä¹‰ï¼Œè§†ä¸ºä¸å˜é‡ï¼Œwhileä¸­æ˜¯å¦å¸¦ç­‰å·</p><ul><li>æ•´æ•°äºŒåˆ†</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">search</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> target)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> nums.length - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (l &lt;= r) &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœè€ƒè™‘è¶Šç•Œï¼Œå¯èµ‹å€¼ mid = l + (r - l) / 2;</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (nums[mid] &gt; target) &#123;</span><br><span class="line">                r = mid - <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(nums[mid] &lt; target)&#123;</span><br><span class="line">                l = mid + <span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> mid;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å°æ•°äºŒåˆ†</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">mySqrt</span><span class="params">(<span class="type">int</span> x)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> <span class="number">0</span>,r = x;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;r)&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> l + r + <span class="number">1</span>&gt;&gt;<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(mid&lt;x/mid)&#123;</span><br><span class="line">                l = mid;</span><br><span class="line">              &#125;<span class="keyword">else</span> <span class="keyword">if</span>(mid&gt;x/mid)&#123;</span><br><span class="line">                r = mid -<span class="number">1</span>;</span><br><span class="line">              &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                  <span class="keyword">return</span> mid;</span><br><span class="line">              &#125;        </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> l;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¶…æ—¶æœ‰å¯èƒ½æ˜¯å› ä¸ºè¶…è¿‡äº†intçš„èŒƒå›´</span></span><br><span class="line"><span class="comment">// å¯å®šä¹‰ä¸ºlongå‹ long square  = (long) mid*mid;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isPerfectSquare</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">l</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">r</span> <span class="operator">=</span> num;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;=r)&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">mid</span> <span class="operator">=</span> l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            <span class="type">long</span> <span class="variable">square</span>  <span class="operator">=</span> (<span class="type">long</span>) mid*mid;</span><br><span class="line">            <span class="keyword">if</span>(square &lt; num)&#123;</span><br><span class="line">                l = mid + <span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(square &gt; num)&#123;</span><br><span class="line">                r = mid -<span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h3 id="1-3-åŒæŒ‡é’ˆï¼ˆç§»é™¤å…ƒç´ 27ï¼‰"><a href="#1-3-åŒæŒ‡é’ˆï¼ˆç§»é™¤å…ƒç´ 27ï¼‰" class="headerlink" title="1.3 åŒæŒ‡é’ˆï¼ˆç§»é™¤å…ƒç´ 27ï¼‰"></a>1.3 åŒæŒ‡é’ˆï¼ˆç§»é™¤å…ƒç´ 27ï¼‰</h3><blockquote><p>åŒæŒ‡é’ˆæ³•ï¼ˆå¿«æ…¢æŒ‡é’ˆæ³•ï¼‰ï¼š é€šè¿‡ä¸€ä¸ªå¿«æŒ‡é’ˆå’Œæ…¢æŒ‡é’ˆåœ¨ä¸€ä¸ªforå¾ªç¯ä¸‹å®Œæˆä¸¤ä¸ªforå¾ªç¯çš„å·¥ä½œã€‚</p><p>å®šä¹‰å¿«æ…¢æŒ‡é’ˆ</p><ul><li>å¿«æŒ‡é’ˆï¼šå¯»æ‰¾æ–°æ•°ç»„çš„å…ƒç´  ï¼Œæ–°æ•°ç»„å°±æ˜¯ä¸å«æœ‰ç›®æ ‡å…ƒç´ çš„æ•°ç»„</li><li>æ…¢æŒ‡é’ˆï¼šæŒ‡å‘æ›´æ–° æ–°æ•°ç»„ä¸‹æ ‡çš„ä½ç½®</li></ul></blockquote><h4 id="ä¾‹é¢˜ä¸€ï¼šç§»é™¤å…ƒç´ ï¼ˆ27ï¼‰"><a href="#ä¾‹é¢˜ä¸€ï¼šç§»é™¤å…ƒç´ ï¼ˆ27ï¼‰" class="headerlink" title="ä¾‹é¢˜ä¸€ï¼šç§»é™¤å…ƒç´ ï¼ˆ27ï¼‰"></a>ä¾‹é¢˜ä¸€ï¼šç§»é™¤å…ƒç´ ï¼ˆ27ï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç§»é™¤å…ƒç´ ï¼ˆ27ï¼‰</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">removeElement</span><span class="params">(<span class="type">int</span>[] nums, <span class="type">int</span> val)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">slowIndex</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">fastIndex</span>  <span class="operator">=</span> <span class="number">0</span>;fastIndex &lt; nums.length;fastIndex++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[fastIndex]!=val)&#123;</span><br><span class="line">                nums[slowIndex++] = nums[fastIndex];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> slowIndex;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="ä¾‹é¢˜äºŒï¼šåˆ é™¤æœ‰åºæ•°ç»„çš„é‡å¤é¡¹26"><a href="#ä¾‹é¢˜äºŒï¼šåˆ é™¤æœ‰åºæ•°ç»„çš„é‡å¤é¡¹26" class="headerlink" title="ä¾‹é¢˜äºŒï¼šåˆ é™¤æœ‰åºæ•°ç»„çš„é‡å¤é¡¹26"></a>ä¾‹é¢˜äºŒï¼šåˆ é™¤æœ‰åºæ•°ç»„çš„é‡å¤é¡¹26</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ é™¤æœ‰åºæ•°ç»„çš„é‡å¤é¡¹26</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">removeDuplicates</span><span class="params">(<span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">slowIndex</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// å¿«æŒ‡é’ˆä»1å¼€å§‹ï¼Œé¿å…ä¸¤ä¸ªæŒ‡é’ˆå¼€å§‹æŒ‡å‘åŒä¸€ä¸ªä½ç½®</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">fastIndex</span> <span class="operator">=</span> <span class="number">1</span>;fastIndex &lt; nums.length;fastIndex++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[fastIndex] != nums[slowIndex])&#123;</span><br><span class="line">                <span class="comment">// å½“ä¸¤ä¸ªæ•°å€¼ä¸ç›¸ç­‰æ—¶ï¼Œåº”è¯¥æŠŠå¿«æŒ‡é’ˆçš„å€¼èµ‹ç»™æ…¢æŒ‡é’ˆçš„ä¸‹ä¸€ä¸ªä½ç½®ï¼Œæ•…++slowIndex</span></span><br><span class="line">                nums[++slowIndex] = nums[fastIndex];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æœ€åè¿”å›çš„æ˜¯æ•°ç»„çš„é•¿åº¦</span></span><br><span class="line">        <span class="keyword">return</span> slowIndex + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ä¾‹é¢˜ä¸‰ï¼šæ¯”è¾ƒå«é€€æ ¼çš„å­—ç¬¦ä¸²844"><a href="#ä¾‹é¢˜ä¸‰ï¼šæ¯”è¾ƒå«é€€æ ¼çš„å­—ç¬¦ä¸²844" class="headerlink" title="ä¾‹é¢˜ä¸‰ï¼šæ¯”è¾ƒå«é€€æ ¼çš„å­—ç¬¦ä¸²844"></a>ä¾‹é¢˜ä¸‰ï¼šæ¯”è¾ƒå«é€€æ ¼çš„å­—ç¬¦ä¸²844</h4><blockquote><p>æ–¹æ³•1ï¼š</p><p>å€’åºæŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¯ä»¥æ¯”è¾ƒçš„å­—ç¬¦ï¼Œå®šä¹‰ä¸€ä¸ªå˜é‡ç”¨æ¥ä¿å­˜æœ‰å¤šå°‘ä¸ªéœ€è¦è·³è¿‡çš„#å­—ç¬¦</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">backspaceCompare</span><span class="params">(String s, String t)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">sIndex</span> <span class="operator">=</span> s.length() - <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">tIndex</span> <span class="operator">=</span> t.length() - <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">sSkip</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">tSkip</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (sIndex &gt;= <span class="number">0</span> || tIndex &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">//å€’åºæ‰¾åˆ°sç¬¬ä¸€ä¸ªå¯ä»¥æ¯”è¾ƒçš„å­—ç¬¦</span></span><br><span class="line">            <span class="keyword">while</span> (sIndex &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (s.charAt(sIndex) == <span class="string">&#x27;#&#x27;</span>) &#123;</span><br><span class="line">                    sSkip++;</span><br><span class="line">                    sIndex--;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (sSkip &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    sSkip--;</span><br><span class="line">                    sIndex--;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//å€’åºæ‰¾åˆ°tç¬¬ä¸€ä¸ªå¯ä»¥æ¯”è¾ƒçš„å­—ç¬¦</span></span><br><span class="line">            <span class="keyword">while</span> (tIndex &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (t.charAt(tIndex) == <span class="string">&#x27;#&#x27;</span>) &#123;</span><br><span class="line">                    tSkip++;</span><br><span class="line">                    tIndex--;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tSkip &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    tSkip--;</span><br><span class="line">                    tIndex--;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (sIndex &gt;= <span class="number">0</span> &amp;&amp; tIndex &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (s.charAt(sIndex) != t.charAt(tIndex)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// (i &gt;= 0 &amp;&amp; j &gt;= 0) ä¸º false æƒ…å†µä¸º</span></span><br><span class="line">            <span class="comment">// 1. i &lt; 0 &amp;&amp; j &gt;= 0</span></span><br><span class="line">            <span class="comment">// 2. j &lt; 0 &amp;&amp; i &gt;= 0</span></span><br><span class="line">            <span class="comment">// 3. i &lt; 0 &amp;&amp; j &lt; 0</span></span><br><span class="line">            <span class="comment">// å…¶ä¸­ï¼Œç¬¬ 3 ç§æƒ…å†µä¸ºç¬¦åˆé¢˜æ„æƒ…å†µï¼Œå› ä¸ºè¿™ç§æƒ…å†µä¸‹ s å’Œ t éƒ½æ˜¯ index = 0 çš„ä½ç½®ä¸º &#x27;#&#x27; è€Œè¿™ç§æƒ…å†µä¸‹</span></span><br><span class="line">            <span class="comment">// é€€æ ¼ç©ºå­—ç¬¦å³ä¸ºç©ºå­—ç¬¦ï¼Œä¹Ÿç¬¦åˆé¢˜æ„ï¼Œåº”å½“è¿”å› Trueã€‚</span></span><br><span class="line">            <span class="comment">// ä½†æ˜¯ï¼Œæƒ…å†µ 1 å’Œ 2 ä¸ç¬¦åˆé¢˜æ„ï¼Œå› ä¸º s å’Œ t å…¶ä¸­ä¸€ä¸ªæ˜¯åœ¨ index &gt;= 0 å¤„æ‰¾åˆ°äº†å¾…æ¯”è¾ƒå­—ç¬¦ï¼Œå¦ä¸€ä¸ªæ²¡æœ‰æ‰¾åˆ°</span></span><br><span class="line">            <span class="comment">// è¿™ç§æƒ…å†µæ˜¾ç„¶ä¸ç¬¦åˆé¢˜æ„ï¼Œåº”å½“è¿”å› Falseï¼Œä¸‹å¼ä¾¿å¤„ç†è¿™ç§æƒ…å†µã€‚</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(sIndex &gt;= <span class="number">0</span> || tIndex &gt;= <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            sIndex--;</span><br><span class="line">            tIndex--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ–¹æ³•2ï¼šæ ˆ</p><p>æœ€å®¹æ˜“æƒ³åˆ°çš„æ–¹æ³•æ˜¯å°†ç»™å®šçš„å­—ç¬¦ä¸²ä¸­çš„é€€æ ¼ç¬¦å’Œåº”å½“è¢«åˆ é™¤çš„å­—ç¬¦éƒ½å»é™¤ï¼Œè¿˜åŸç»™å®šå­—ç¬¦ä¸²çš„ä¸€èˆ¬å½¢å¼ã€‚ç„¶åç›´æ¥æ¯”è¾ƒä¸¤å­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰å³å¯ã€‚</p><p>å…·ä½“åœ°ï¼Œæˆ‘ä»¬ç”¨æ ˆå¤„ç†éå†è¿‡ç¨‹ï¼Œæ¯æ¬¡æˆ‘ä»¬éå†åˆ°ä¸€ä¸ªå­—ç¬¦ï¼š</p><ul><li><p>å¦‚æœå®ƒæ˜¯é€€æ ¼ç¬¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æ ˆé¡¶å¼¹å‡ºï¼›</p></li><li><p>å¦‚æœå®ƒæ˜¯æ™®é€šå­—ç¬¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†å…¶å‹å…¥æ ˆä¸­ã€‚</p></li></ul></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">backspaceCompare</span><span class="params">(String S, String T)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> build(S).equals(build(T));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">build</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        <span class="type">StringBuffer</span> <span class="variable">ret</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuffer</span>();</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> str.length();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; length; ++i) &#123;</span><br><span class="line">            <span class="type">char</span> <span class="variable">ch</span> <span class="operator">=</span> str.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (ch != <span class="string">&#x27;#&#x27;</span>) &#123;</span><br><span class="line">                ret.append(ch);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (ret.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    ret.deleteCharAt(ret.length() - <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ä¾‹é¢˜å››ï¼šæœ‰åºæ•°ç»„çš„å¹³æ–¹ï¼ˆé‡ç‚¹ï¼‰"><a href="#ä¾‹é¢˜å››ï¼šæœ‰åºæ•°ç»„çš„å¹³æ–¹ï¼ˆé‡ç‚¹ï¼‰" class="headerlink" title="ä¾‹é¢˜å››ï¼šæœ‰åºæ•°ç»„çš„å¹³æ–¹ï¼ˆé‡ç‚¹ï¼‰"></a>ä¾‹é¢˜å››ï¼šæœ‰åºæ•°ç»„çš„å¹³æ–¹ï¼ˆé‡ç‚¹ï¼‰</h4><blockquote><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«æŒ‡å‘ä½ç½® 0 å’Œ nâˆ’1ï¼Œæ¯æ¬¡æ¯”è¾ƒä¸¤ä¸ªæŒ‡é’ˆå¯¹åº”çš„æ•°ï¼Œé€‰æ‹©è¾ƒå¤§çš„é‚£ä¸ªé€†åºæ”¾å…¥ç­”æ¡ˆå¹¶ç§»åŠ¨æŒ‡é’ˆã€‚è¿™ç§æ–¹æ³•æ— éœ€å¤„ç†æŸä¸€æŒ‡é’ˆç§»åŠ¨è‡³è¾¹ç•Œçš„æƒ…å†µã€‚</p><p>ä»£ç æ–¹é¢ï¼š</p><p>forå¾ªç¯ä¸­åˆå§‹å€¼ï¼Œå¾ªç¯æ¡ä»¶ï¼Œæ­¥å¢ï¼ˆå¯ä»¥åœ¨åé¢å†™ï¼‰</p><p>pos &#x3D; nums.length -1 ä»åé¢å¾€å‰å¡«å……æ•°ç»„</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[] sortedSquares(<span class="type">int</span>[] nums) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">length</span> <span class="operator">=</span> nums.length;</span><br><span class="line">        <span class="type">int</span>[] res = <span class="keyword">new</span> <span class="title class_">int</span>[length];</span><br><span class="line">        <span class="comment">//left &lt;= right å¦‚æœä¸åŠ ç­‰å·ï¼Œä¼šå¯¼è‡´ä¸­é—´çš„æ•°æ²¡æœ‰æ”¾å…¥ï¼Œæœ€åè‡ªåŠ¨è¡¥0</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> <span class="number">0</span> ,right = length -<span class="number">1</span> ,pos = length -<span class="number">1</span>;left &lt;= right;)&#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">square1</span> <span class="operator">=</span> nums[left] * nums[left];</span><br><span class="line">            <span class="type">int</span> <span class="variable">square2</span> <span class="operator">=</span> nums[right] * nums[right];</span><br><span class="line">            <span class="comment">//å¦‚æœå·¦è¾¹çš„å¹³æ–¹å€¼å¤§äºå³è¾¹ï¼Œå°†å·¦è¾¹çš„å€¼å…ˆå†™å…¥</span></span><br><span class="line">            <span class="keyword">if</span>(square1 &lt; square2)&#123;</span><br><span class="line">                res[pos] = square2;</span><br><span class="line">                right --;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(square1 &gt;= square2)&#123;</span><br><span class="line">                res[pos] = square1;</span><br><span class="line">                left ++;</span><br><span class="line">            &#125;</span><br><span class="line">            pos --;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-4-æ»‘åŠ¨çª—å£-209"><a href="#1-4-æ»‘åŠ¨çª—å£-209" class="headerlink" title="1.4 æ»‘åŠ¨çª—å£ 209"></a>1.4 æ»‘åŠ¨çª—å£ 209</h3><blockquote><p>æ‰€è°“æ»‘åŠ¨çª—å£ï¼Œå°±æ˜¯ä¸æ–­çš„è°ƒèŠ‚å­åºåˆ—çš„èµ·å§‹ä½ç½®å’Œç»ˆæ­¢ä½ç½®ï¼Œä»è€Œå¾—å‡ºæˆ‘ä»¬è¦æƒ³çš„ç»“æœã€‚</p><p>åªç”¨ä¸€ä¸ªforå¾ªç¯ï¼Œè¡¨ç¤ºæ»‘åŠ¨çª—å£çš„ç»ˆæ­¢ä½ç½®ã€‚</p><p>åœ¨æœ¬é¢˜ä¸­å®ç°æ»‘åŠ¨çª—å£ï¼Œä¸»è¦ç¡®å®šå¦‚ä¸‹ä¸‰ç‚¹ï¼š</p><ul><li>çª—å£å†…æ˜¯ä»€ä¹ˆï¼Ÿ</li><li>å¦‚ä½•ç§»åŠ¨çª—å£çš„èµ·å§‹ä½ç½®ï¼Ÿ</li><li>å¦‚ä½•ç§»åŠ¨çª—å£çš„ç»“æŸä½ç½®ï¼Ÿ</li></ul><p>çª—å£å°±æ˜¯ æ»¡è¶³å…¶å’Œ â‰¥ s çš„é•¿åº¦æœ€å°çš„ è¿ç»­å­æ•°ç»„ã€‚</p><p>çª—å£çš„èµ·å§‹ä½ç½®å¦‚ä½•ç§»åŠ¨ï¼šå¦‚æœå½“å‰çª—å£çš„å€¼å¤§äºsäº†ï¼Œçª—å£å°±è¦å‘å‰ç§»åŠ¨äº†ï¼ˆä¹Ÿå°±æ˜¯è¯¥ç¼©å°äº†ï¼‰ã€‚</p><p>çª—å£çš„ç»“æŸä½ç½®å¦‚ä½•ç§»åŠ¨ï¼šçª—å£çš„ç»“æŸä½ç½®å°±æ˜¯éå†æ•°ç»„çš„æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯forå¾ªç¯é‡Œçš„ç´¢å¼•ã€‚</p><p>æ³¨æ„ï¼šå¯ä»¥é€šè¿‡Integer.MAX_VALUEè®¾ç½®æœ€å¤§å€¼ï¼Œå¦‚æœé€šè¿‡ä¸‰ç›®è¿ç®—ç¬¦åˆ¤æ–­ï¼Œå¦‚æœä»ç„¶æ˜¯Integer.MAX_VALUEï¼Œåˆ™è¿”å›0ï¼Œå¦åˆ™è¿”å›resï¼Œè¿™æ ·å¯ä»¥é¿å…å¤šç”¨forå¾ªç¯è®¡ç®—æ€»çš„æ•°ç»„å†…å…ƒç´ å’Œã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">minSubArrayLen</span><span class="params">(<span class="type">int</span> target, <span class="type">int</span>[] nums)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> <span class="number">0</span>;  <span class="type">int</span> <span class="variable">res</span> <span class="operator">=</span> Integer.MAX_VALUE; <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">end</span> <span class="operator">=</span> <span class="number">0</span>; end &lt; nums.length; end++)&#123;</span><br><span class="line">            sum += nums[end];</span><br><span class="line">            <span class="keyword">while</span>(sum&gt;=target)&#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">subLen</span> <span class="operator">=</span> end - start + <span class="number">1</span>;</span><br><span class="line">                res = res &lt; subLen ? res : subLen;</span><br><span class="line">                <span class="comment">//res = Math.min(res, subLen);</span></span><br><span class="line">                sum = sum - nums[start];</span><br><span class="line">                start ++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res == Integer.MAX_VALUE ? <span class="number">0</span> : res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-5-èºæ—‹çŸ©é˜µ59"><a href="#1-5-èºæ—‹çŸ©é˜µ59" class="headerlink" title="1.5 èºæ—‹çŸ©é˜µ59"></a>1.5 èºæ—‹çŸ©é˜µ59</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span>[][] generateMatrix(<span class="type">int</span> n) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">loop</span> <span class="operator">=</span> <span class="number">0</span>;<span class="comment">//å¾ªç¯æ¬¡æ•°</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> <span class="number">0</span>; <span class="comment">//èµ·å§‹ä½ç½®</span></span><br><span class="line">        <span class="type">int</span> i , j; <span class="comment">//æ¯æ¬¡å¾ªç¯çš„å¼€å§‹ç‚¹(start, start)</span></span><br><span class="line">        <span class="type">int</span>[][] res  = <span class="keyword">new</span> <span class="title class_">int</span>[n][n];</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span>  <span class="operator">=</span> <span class="number">1</span>;<span class="comment">//å¡«å……æ•°å­—</span></span><br><span class="line">        <span class="keyword">while</span>(loop++&lt;(n/<span class="number">2</span>))&#123;</span><br><span class="line">            <span class="keyword">for</span>(j = start; j &lt; n -loop;j++)&#123;</span><br><span class="line">                res[start][j] = count++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(i = start; i &lt; n -loop;i++)&#123;</span><br><span class="line">                res[i][j] = count++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(; j &gt;start;j--)&#123;</span><br><span class="line">                res[i][j] = count++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(; i &gt; start;i--)&#123;</span><br><span class="line">                res[i][j] = count++;</span><br><span class="line">            &#125;</span><br><span class="line">            start++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(n%<span class="number">2</span>!=<span class="number">0</span>)&#123;</span><br><span class="line">            res[start][start] = count;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ideaå¿«æ·é”®</title>
      <link href="/2022/12/21/idea%E5%BF%AB%E6%8D%B7%E9%94%AE/"/>
      <url>/2022/12/21/idea%E5%BF%AB%E6%8D%B7%E9%94%AE/</url>
      
        <content type="html"><![CDATA[<h2 id="1-å•ä¾‹æ¨¡å¼"><a href="#1-å•ä¾‹æ¨¡å¼" class="headerlink" title="1. å•ä¾‹æ¨¡å¼"></a>1. å•ä¾‹æ¨¡å¼</h2><h3 id="1-ç¼–è¾‘ç±»å¿«æ·é”®"><a href="#1-ç¼–è¾‘ç±»å¿«æ·é”®" class="headerlink" title="1. ç¼–è¾‘ç±»å¿«æ·é”®"></a>1. ç¼–è¾‘ç±»å¿«æ·é”®</h3><table><thead><tr><th>å¿«æ·é”®</th><th>ä»‹ç»</th></tr></thead><tbody><tr><td>Ctrl + O</td><td>é‡å†™æ–¹æ³•</td></tr><tr><td>Ctrl + I</td><td>å®ç°æ–¹æ³•</td></tr><tr><td>Ctr + shift + U</td><td>å¤§å°å†™è½¬åŒ–</td></tr><tr><td>Ctrl + Shift + space</td><td>è‡ªåŠ¨è¡¥å…¨ä»£ç </td></tr><tr><td>Alt + å›è½¦</td><td>å¯¼å…¥åŒ…,è‡ªåŠ¨ä¿®æ­£</td></tr><tr><td>Alt + &#x2F;</td><td>ä»£ç æç¤º</td></tr><tr><td>Alt + Insert</td><td>ç”Ÿæˆä»£ç (å¦‚GET,SETæ–¹æ³•,æ„é€ å‡½æ•°ç­‰)</td></tr><tr><td>Ctrl + Alt + L</td><td>æ ¼å¼åŒ–ä»£ç </td></tr><tr><td>Ctrl + Alt + I</td><td>è‡ªåŠ¨ç¼©è¿›</td></tr><tr><td>Ctrl + Alt + T</td><td>ç”Ÿæˆtry catch</td></tr><tr><td>Ctrl + Alt + O</td><td>ä¼˜åŒ–å¯¼å…¥çš„ç±»å’ŒåŒ…</td></tr><tr><td>iter</td><td>ç”Ÿæˆå¢å¼ºforå¾ªç¯</td></tr><tr><td>itar</td><td>ç”Ÿæˆarray forä»£ç å—</td></tr><tr><td>itit</td><td>ç”Ÿæˆiterator è¿­ä»£</td></tr><tr><td>itli</td><td>ç”ŸæˆListçš„éå†</td></tr><tr><td>itco</td><td>ç”ŸæˆCollectionè¿­ä»£</td></tr></tbody></table><h3 id="2-æŸ¥æ‰¾ã€æ›¿æ¢ç±»å¿«æ·é”®"><a href="#2-æŸ¥æ‰¾ã€æ›¿æ¢ç±»å¿«æ·é”®" class="headerlink" title="2.  æŸ¥æ‰¾ã€æ›¿æ¢ç±»å¿«æ·é”®"></a>2.  æŸ¥æ‰¾ã€æ›¿æ¢ç±»å¿«æ·é”®</h3><table><thead><tr><th>å¿«æ·é”®</th><th>ä»‹ç»</th></tr></thead><tbody><tr><td>Ctrl + F</td><td>åœ¨å½“å‰æ–‡ä»¶ä¸­æŸ¥æ‰¾</td></tr><tr><td>Ctrl + Shift + F</td><td>åœ¨æ•´ä¸ªé¡¹ç›®æˆ–è€…æŒ‡å®šçª—å£ä¸­æŸ¥æ‰¾æ–‡æœ¬</td></tr><tr><td>Ctrl + N</td><td>åœ¨é¡¹ç›®ä¸­æŸ¥æ‰¾ç±»</td></tr><tr><td>Ctrl + Shift + N</td><td>æŸ¥æ‰¾æ–‡ä»¶</td></tr><tr><td>Ctrl + R</td><td>åœ¨å½“å‰æ–‡ä»¶è¿›è¡Œæ–‡æœ¬æ›¿æ¢</td></tr><tr><td>Ctrl + Shift+R</td><td>åœ¨æŒ‡å®šçª—å£æ›¿æ¢æ–‡æœ¬</td></tr><tr><td>Ctrl + W</td><td>è‡ªåŠ¨æŒ‰è¯­æ³•é€‰ä¸­ä»£ç </td></tr><tr><td>Ctrl + Shift + W</td><td>åå‘è‡ªåŠ¨æŒ‰è¯­æ³•é€‰ä¸­ä»£ç </td></tr><tr><td>Ctrl + G</td><td>å®šä½è¡Œ</td></tr><tr><td>Ctrlï¼‹Shiftï¼‹Backspace</td><td>è·³è½¬åˆ°ä¸Šä¸€æ¬¡ç¼–è¾‘çš„ä½ç½®</td></tr><tr><td>Ctrl + alt + â†&#x2F;â†’</td><td>å‰åè·³è½¬ç¼–è¾‘è¿‡çš„åœ°æ–¹</td></tr><tr><td>Ctrl + Shift + Alt + N</td><td>æŸ¥æ‰¾ å˜é‡ &#x2F; æ–¹æ³•</td></tr><tr><td>Alt + F7</td><td>æ‰¾åˆ°ä½ çš„å‡½æ•°æˆ–è€…å˜é‡æˆ–è€…ç±»çš„æ‰€æœ‰å¼•ç”¨åˆ°çš„åœ°æ–¹</td></tr><tr><td>Alt + F3</td><td>é«˜äº®æ˜¾ç¤ºæ‰€æœ‰è¯¥é€‰ä¸­æ–‡æœ¬ï¼ŒæŒ‰ Enter é€‰ä¸­ä¸‹ä¸€ä¸ªï¼ŒæŒ‰ Esc é«˜äº®æ¶ˆå¤±</td></tr><tr><td>F4</td><td>åœ¨å½“å‰ç±»ä¸­æŸ¥æ‰¾å˜é‡çš„æ¥æº</td></tr><tr><td>åŒå‡»Shift</td><td>æŸ¥æ‰¾ä»»ä½•å†…å®¹</td></tr></tbody></table><h3 id="3-ç¼–è¯‘ã€è¿è¡Œç±»å¿«æ·é”®"><a href="#3-ç¼–è¯‘ã€è¿è¡Œç±»å¿«æ·é”®" class="headerlink" title="3. ç¼–è¯‘ã€è¿è¡Œç±»å¿«æ·é”®"></a>3. ç¼–è¯‘ã€è¿è¡Œç±»å¿«æ·é”®</h3><table><thead><tr><th>ç¼–è¯‘ã€è¿è¡Œç±»å¿«æ·é”®</th><th>ä»‹ç»</th></tr></thead><tbody><tr><td>Ctrl + F9</td><td>ç¼–è¯‘é¡¹ç›®</td></tr><tr><td>Ctrl + Shift + F9</td><td>ç¼–è¯‘å½“å‰æ–‡ä»¶</td></tr><tr><td>Shift + F10</td><td>æ­£å¸¸å¯åŠ¨</td></tr><tr><td>Alt + Shift + F10</td><td>å¼¹å‡º Run çš„å¯é€‰æ‹©èœå•</td></tr><tr><td>Shift + F9</td><td>debugæ¨¡å¼å¯åŠ¨</td></tr><tr><td>Alt + Shift + F9</td><td>é€‰æ‹© Debug</td></tr></tbody></table><h3 id="4-Debugå¿«æ·é”®"><a href="#4-Debugå¿«æ·é”®" class="headerlink" title="4. Debugå¿«æ·é”®"></a>4. Debugå¿«æ·é”®</h3><table><thead><tr><th align="left"><strong>Debugå¿«æ·é”®</strong></th><th><strong>ä»‹ç»</strong></th></tr></thead><tbody><tr><td align="left">F7</td><td>åœ¨ Debug æ¨¡å¼ä¸‹ï¼Œæ­¥å…¥ï¼Œå¦‚æœå½“å‰è¡Œæ–­ç‚¹æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œåˆ™è¿›å…¥å½“å‰æ–¹æ³•ä½“å†…ï¼Œå¦‚æœè¯¥æ–¹æ³•ä½“è¿˜æœ‰æ–¹æ³•ï¼Œåˆ™ä¸ä¼šè¿›å…¥è¯¥å†…åµŒçš„æ–¹æ³•ä¸­</td></tr><tr><td align="left">Shift + F7</td><td>æ™ºèƒ½æ­¥å…¥</td></tr><tr><td align="left">Alt + Shift + F7</td><td>å¼ºåˆ¶æ­¥å…¥</td></tr><tr><td align="left">F8</td><td>åœ¨ Debug æ¨¡å¼ä¸‹ï¼Œæ­¥è¿‡ï¼Œå¦‚æœå½“å‰è¡Œæ–­ç‚¹æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œåˆ™ä¸è¿›å…¥å½“å‰æ–¹æ³•ä½“å†…</td></tr><tr><td align="left">Shift + F8</td><td>æ­¥å‡º</td></tr><tr><td align="left">Alt + Shift + F8</td><td>å¼ºåˆ¶æ­¥è¿‡</td></tr><tr><td align="left">alt + F8</td><td>åœ¨ Debug æ¨¡å¼ä¸‹ï¼Œé€‰ä¸­æŸ¥çœ‹å€¼</td></tr><tr><td align="left">Ctrl + Shift + F8</td><td>æŸ¥çœ‹æ–­ç‚¹</td></tr><tr><td align="left">F9</td><td>åœ¨ Debug æ¨¡å¼ä¸‹ï¼Œæ¢å¤ç¨‹åºè¿è¡Œã€‚å¦‚æœè¯¥æ–­ç‚¹ä¸‹é¢ä»£ç è¿˜æœ‰æ–­ç‚¹åˆ™åœåœ¨ä¸‹ä¸€ä¸ªæ–­ç‚¹ä¸Š</td></tr><tr><td align="left">Alt +F9</td><td>è¿è¡Œè‡³å…‰æ ‡çš„ä½ç½®</td></tr><tr><td align="left">Ctrl + Alt+ F9</td><td>å¼ºåˆ¶è¿è¡Œè‡³å…‰æ ‡å¤„</td></tr><tr><td align="left">Alt + F10</td><td>å®šä½åˆ°æ–­ç‚¹</td></tr></tbody></table><h3 id="5-é‡æ„å¿«æ·é”®"><a href="#5-é‡æ„å¿«æ·é”®" class="headerlink" title="5. é‡æ„å¿«æ·é”®"></a>5. é‡æ„å¿«æ·é”®</h3><table><thead><tr><th>é‡æ„å¿«æ·é”®</th><th>ä»‹ç»</th></tr></thead><tbody><tr><td>Shift + F6</td><td>é‡å‘½å</td></tr><tr><td>Ctrl + Alt + C</td><td>æŠ½å–å¸¸é‡</td></tr><tr><td>Ctrl + Alt + F</td><td>æŠ½å–å­—æ®µ</td></tr><tr><td>Ctrl + Alt + M</td><td>æŠ½å–æ–¹æ³•</td></tr><tr><td>Ctrl + Alt + P</td><td>æŠ½å–å‚æ•°</td></tr><tr><td>Ctrl + Alt + V</td><td>æŠ½å–å˜é‡</td></tr></tbody></table><h3 id="6-å…¶ä»–ç±»å¿«æ·é”®"><a href="#6-å…¶ä»–ç±»å¿«æ·é”®" class="headerlink" title="6. å…¶ä»–ç±»å¿«æ·é”®"></a>6. å…¶ä»–ç±»å¿«æ·é”®</h3><table><thead><tr><th>å¿«æ·é”®</th><th>å†…å®¹</th></tr></thead><tbody><tr><td>Ctrl + C</td><td>å¤åˆ¶æ–‡ä»¶å</td></tr><tr><td>Ctrl + Shift + C</td><td>å¤åˆ¶æ–‡ä»¶çš„å®Œæ•´è·¯å¾„</td></tr><tr><td>Ctrl + E</td><td>æ˜¾ç¤ºæœ€è¿‘æ‰“å¼€çš„æ–‡ä»¶</td></tr><tr><td>Ctrl + Shift + E</td><td>æ˜¾ç¤ºæœ€è¿‘ä¿®æ”¹çš„æ–‡ä»¶åˆ—è¡¨çš„å¼¹å‡ºå±‚</td></tr><tr><td>Ctrl + P</td><td>æ–¹æ³•å‚æ•°æç¤º</td></tr><tr><td>Ctrl + Q</td><td>å¯ä»¥çœ‹åˆ°å½“å‰æ–¹æ³•çš„å£°æ˜</td></tr><tr><td>Ctrl + Alt + Space</td><td>ç±»åæˆ–æ¥å£åæç¤º</td></tr><tr><td>Ctrl + F12</td><td>æ˜¾ç¤ºå½“å‰æ–‡ä»¶çš„ç»“æ„</td></tr><tr><td>Ctrl + H</td><td>æ˜¾ç¤ºå½“å‰ç±»çš„ç»“æ„å›¾</td></tr><tr><td>Ctrl + Q</td><td>æ˜¾ç¤ºæ³¨é‡Šæ–‡æ¡£ä¿¡æ¯</td></tr><tr><td>è¿æŒ‰ä¸¤æ¬¡Shift</td><td>å¼¹å‡º Search Everywhere å¼¹å‡ºå±‚ï¼ŒæŸ¥æ‰¾ä»»ä»»å†…å®¹</td></tr><tr><td>Ctrl + [</td><td>ç§»åŠ¨å…‰æ ‡åˆ°å½“å‰æ‰€åœ¨ä»£ç çš„èŠ±æ‹¬å·å¼€å§‹ä½ç½®</td></tr><tr><td>Ctrl + ]</td><td>ç§»åŠ¨å…‰æ ‡åˆ°å½“å‰æ‰€åœ¨ä»£ç çš„èŠ±æ‹¬å·ç»“æŸä½ç½®</td></tr><tr><td>Ctrl + K</td><td>ç‰ˆæœ¬æ§åˆ¶æäº¤é¡¹ç›®ï¼Œéœ€è¦æ­¤é¡¹ç›®æœ‰åŠ å…¥åˆ°ç‰ˆæœ¬æ§åˆ¶æ‰èƒ½å¤Ÿä½¿ç”¨</td></tr><tr><td>Ctrl + T</td><td>ç‰ˆæœ¬æ§åˆ¶æ›´æ–°é¡¹ç›®ï¼Œéœ€è¦æ­¤é¡¹ç›®æœ‰åŠ å…¥åˆ°ç‰ˆæœ¬æ§åˆ¶æ‰èƒ½å¤Ÿä½¿ç”¨</td></tr><tr><td>Ctrl + Tab</td><td>åˆ‡æ¢ç¼–è¾‘çª—å£ã€‚å¦‚æœåœ¨åˆ‡æ¢çš„è¿‡ç¨‹åˆæŒ‰Deleteé”®ï¼Œåˆ™æ˜¯å…³é—­å¯¹åº”é€‰ä¸­çš„çª—å£</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> idea </category>
          
      </categories>
      
      
        <tags>
            
            <tag> idea </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxå¸¸ç”¨å‘½ä»¤</title>
      <link href="/2022/12/20/linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/2022/12/20/linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ³¨ï¼šåšå®¢ä»…ç”¨æ¥ä¸ªäººå­¦ä¹ ï¼Œä¸è®¾è®¡å•†ä¸šåŒ–ï¼Œå¦‚æœä¾µæƒè¯·è”ç³»åˆ é™¤æœ¬æ–‡ã€‚</p><p>å‚è€ƒåšå®¢ï¼š<a href="https://blog.eurkon.com/">https://blog.eurkon.com/</a></p></blockquote><h2 id="1-ç³»ç»Ÿä¿¡æ¯"><a href="#1-ç³»ç»Ÿä¿¡æ¯" class="headerlink" title="1. ç³»ç»Ÿä¿¡æ¯"></a>1. ç³»ç»Ÿä¿¡æ¯</h2><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>arch</td><td>æ˜¾ç¤ºæœºå™¨çš„å¤„ç†å™¨æ¶æ„</td></tr><tr><td>uname -m</td><td>æ˜¾ç¤ºæœºå™¨çš„å¤„ç†å™¨æ¶æ„</td></tr><tr><td>uname -r</td><td>æ˜¾ç¤ºæ­£åœ¨ä½¿ç”¨çš„å†…æ ¸ç‰ˆæœ¬</td></tr><tr><td>dmidecode -q</td><td>æ˜¾ç¤ºç¡¬ä»¶ç³»ç»Ÿéƒ¨ä»¶ -ï¼ˆSMBIOS&#x2F;DMIï¼‰</td></tr><tr><td>hdparm -i &#x2F;dev&#x2F;hda</td><td>ç½—åˆ—ä¸€ä¸ªç£ç›˜çš„æ¶æ„ç‰¹æ€§</td></tr><tr><td>hdparm -tT &#x2F;dev&#x2F;sda</td><td>åœ¨ç£ç›˜ä¸Šæ‰§è¡Œæµ‹è¯•æ€§è¯»å–æ“ä½œ</td></tr><tr><td>cat &#x2F;proc&#x2F;cpuinfo</td><td>æ˜¾ç¤º CPU info çš„ä¿¡æ¯</td></tr><tr><td>cat &#x2F;proc&#x2F;interrupts</td><td>æ˜¾ç¤ºä¸­æ–­</td></tr><tr><td>cat &#x2F;proc&#x2F;meminfo</td><td>æ ¡éªŒå†…å­˜ä½¿ç”¨</td></tr><tr><td>cat &#x2F;proc&#x2F;swaps</td><td>æ˜¾ç¤ºå“ªäº› swap è¢«ä½¿ç”¨</td></tr><tr><td>cat &#x2F;proc&#x2F;version</td><td>æ˜¾ç¤ºå†…æ ¸çš„ç‰ˆæœ¬</td></tr><tr><td>cat &#x2F;proc&#x2F;net&#x2F;dev</td><td>æ˜¾ç¤ºç½‘ç»œé€‚é…å™¨åŠç»Ÿè®¡</td></tr><tr><td>cat &#x2F;proc&#x2F;mounts</td><td>æ˜¾ç¤ºå·²åŠ è½½çš„æ–‡ä»¶ç³»ç»Ÿ</td></tr><tr><td>lspci -tv</td><td>ç½—åˆ— PCI è®¾å¤‡</td></tr><tr><td>lsusb -tv</td><td>æ˜¾ç¤º USB è®¾å¤‡</td></tr><tr><td>date</td><td>æ˜¾ç¤ºç³»ç»Ÿæ—¥æœŸ</td></tr><tr><td>cal 2007</td><td>æ˜¾ç¤º 2007 å¹´çš„æ—¥å†è¡¨</td></tr><tr><td>date 041217002007.00</td><td>è®¾ç½®æ—¥æœŸå’Œæ—¶é—´ - æœˆæ—¥æ—¶åˆ†å¹´.ç§’</td></tr><tr><td>clock -w</td><td>å°†æ—¶é—´ä¿®æ”¹ä¿å­˜åˆ° BIOS</td></tr></tbody></table><h2 id="2-ç³»ç»Ÿå…³æœºã€é‡å¯ä»¥åŠç™»å‡º"><a href="#2-ç³»ç»Ÿå…³æœºã€é‡å¯ä»¥åŠç™»å‡º" class="headerlink" title="2. ç³»ç»Ÿå…³æœºã€é‡å¯ä»¥åŠç™»å‡º"></a>2. ç³»ç»Ÿå…³æœºã€é‡å¯ä»¥åŠç™»å‡º</h2><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>shutdown -h now</td><td>å…³é—­ç³»ç»Ÿ</td></tr><tr><td>init 0</td><td>å…³é—­ç³»ç»Ÿ</td></tr><tr><td>telinit 0</td><td>å…³é—­ç³»ç»Ÿ</td></tr><tr><td>shutdown -h hours:minutes &amp;</td><td>æŒ‰é¢„å®šæ—¶é—´å…³é—­ç³»ç»Ÿ</td></tr><tr><td>shutdown -c</td><td>å–æ¶ˆæŒ‰é¢„å®šæ—¶é—´å…³é—­ç³»ç»Ÿ</td></tr><tr><td>shutdown -r now</td><td>é‡å¯</td></tr><tr><td>reboot</td><td>é‡å¯</td></tr><tr><td>logout</td><td>æ³¨é”€</td></tr></tbody></table><h2 id="3-æ–‡ä»¶å’Œç›®å½•"><a href="#3-æ–‡ä»¶å’Œç›®å½•" class="headerlink" title="3. æ–‡ä»¶å’Œç›®å½•"></a>3. æ–‡ä»¶å’Œç›®å½•</h2><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>cd &#x2F;home</td><td>è¿›å…¥ â€˜&#x2F;homeâ€™ ç›®å½•â€™</td></tr><tr><td>cd ..</td><td>è¿”å›ä¸Šä¸€çº§ç›®å½•</td></tr><tr><td>cd ..&#x2F;..</td><td>è¿”å›ä¸Šä¸¤çº§ç›®å½•</td></tr><tr><td>cd</td><td>è¿›å…¥ä¸ªäººçš„ä¸»ç›®å½•</td></tr><tr><td>cd ~user1</td><td>è¿›å…¥ä¸ªäººçš„ä¸»ç›®å½•</td></tr><tr><td>cd -</td><td>è¿”å›ä¸Šæ¬¡æ‰€åœ¨çš„ç›®å½•</td></tr><tr><td>pwd</td><td>æ˜¾ç¤ºå·¥ä½œè·¯å¾„</td></tr><tr><td>ls</td><td>æŸ¥çœ‹ç›®å½•ä¸­çš„æ–‡ä»¶</td></tr><tr><td>ls -F</td><td>æŸ¥çœ‹ç›®å½•ä¸­çš„æ–‡ä»¶</td></tr><tr><td>ls -l</td><td>æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•çš„è¯¦ç»†èµ„æ–™</td></tr><tr><td>ls -a</td><td>æ˜¾ç¤ºéšè—æ–‡ä»¶</td></tr><tr><td>ls <em>[0-9]</em></td><td>æ˜¾ç¤ºåŒ…å«æ•°å­—çš„æ–‡ä»¶åå’Œç›®å½•å</td></tr><tr><td>tree</td><td>æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•ç”±æ ¹ç›®å½•å¼€å§‹çš„æ ‘å½¢ç»“æ„</td></tr><tr><td>lstree</td><td>æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•ç”±æ ¹ç›®å½•å¼€å§‹çš„æ ‘å½¢ç»“æ„</td></tr><tr><td>mkdir dir1</td><td>åˆ›å»ºä¸€ä¸ªå«åš â€˜dir1â€™ çš„ç›®å½•</td></tr><tr><td>mkdir dir1</td><td>dir2 åŒæ—¶åˆ›å»ºä¸¤ä¸ªç›®å½•</td></tr><tr><td>mkdir -p &#x2F;tmp&#x2F;dir1&#x2F;dir2</td><td>åˆ›å»ºä¸€ä¸ªç›®å½•æ ‘</td></tr><tr><td>rm -f file1</td><td>åˆ é™¤ä¸€ä¸ªå«åš â€˜file1â€™ çš„æ–‡ä»¶</td></tr><tr><td>rmdir dir1</td><td>åˆ é™¤ä¸€ä¸ªå«åš â€˜dir1â€™ çš„ç›®å½•</td></tr><tr><td>rm -rf dir1</td><td>åˆ é™¤ä¸€ä¸ªå«åš â€˜dir1â€™ çš„ç›®å½•å¹¶åŒæ—¶åˆ é™¤å…¶å†…å®¹</td></tr><tr><td>rm -rf dir1 dir2</td><td>åŒæ—¶åˆ é™¤ä¸¤ä¸ªç›®å½•åŠå®ƒä»¬çš„å†…å®¹</td></tr><tr><td>mv dir1 new_dir</td><td>é‡å‘½å&#x2F;ç§»åŠ¨ ä¸€ä¸ªç›®å½•</td></tr><tr><td>cp file1 file2</td><td>å¤åˆ¶ä¸€ä¸ªæ–‡ä»¶</td></tr><tr><td>cp dir&#x2F;* .</td><td>å¤åˆ¶ä¸€ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åˆ°å½“å‰å·¥ä½œç›®å½•</td></tr><tr><td>cp -a &#x2F;tmp&#x2F;dir1 .</td><td>å¤åˆ¶ä¸€ä¸ªç›®å½•åˆ°å½“å‰å·¥ä½œç›®å½•</td></tr><tr><td>cp -a dir1 dir2</td><td>å¤åˆ¶ä¸€ä¸ªç›®å½•</td></tr><tr><td>ln -s file1 lnk1</td><td>åˆ›å»ºä¸€ä¸ªæŒ‡å‘æ–‡ä»¶æˆ–ç›®å½•çš„è½¯é“¾æ¥</td></tr><tr><td>ln file1 lnk1</td><td>åˆ›å»ºä¸€ä¸ªæŒ‡å‘æ–‡ä»¶æˆ–ç›®å½•çš„ç‰©ç†é“¾æ¥</td></tr><tr><td>touch -t 0712250000 file1</td><td>ä¿®æ”¹ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•çš„æ—¶é—´æˆ³ - YYMMDDhhmm</td></tr><tr><td>file file1</td><td>å°†æ–‡ä»¶çš„ç±»å‹è¾“å‡ºä¸ºæ–‡æœ¬</td></tr><tr><td>iconv -l</td><td>åˆ—å‡ºå·²çŸ¥çš„ç¼–ç </td></tr><tr><td>iconv -f fromEncoding -t toEncoding inputFile &gt; outputFile</td><td>è½¬æ¢æ–‡ä»¶ç¼–ç ç±»å‹å¹¶åˆ›å»ºæ–°æ–‡ä»¶</td></tr><tr><td>find . -maxdepth 1 -name *.jpg -print -exec convert â€œ{}â€ -resize 80x60 â€œthumbs&#x2F;{}â€</td><td>æ‰¹é‡è°ƒæ•´ â€˜.jpgâ€™ ç»“å°¾çš„æ–‡ä»¶å°ºå¯¸å¤§å°</td></tr></tbody></table><h2 id="4-æ–‡ä»¶æœç´¢"><a href="#4-æ–‡ä»¶æœç´¢" class="headerlink" title="4. æ–‡ä»¶æœç´¢"></a>4. æ–‡ä»¶æœç´¢</h2><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>find &#x2F; -name file1</td><td>ä» â€˜&#x2F;â€˜ å¼€å§‹è¿›å…¥æ ¹æ–‡ä»¶ç³»ç»Ÿæœç´¢æ–‡ä»¶å’Œç›®å½•</td></tr><tr><td>find &#x2F; -user user1</td><td>æœç´¢å±äºç”¨æˆ· â€˜user1â€™ çš„æ–‡ä»¶å’Œç›®å½•</td></tr><tr><td>find &#x2F;home&#x2F;user1 -name *.bin</td><td>åœ¨ç›®å½• â€˜&#x2F;home&#x2F;user1â€™ ä¸­æœç´¢å¸¦æœ‰â€™.binâ€™ ç»“å°¾çš„æ–‡ä»¶</td></tr><tr><td>find &#x2F;usr&#x2F;bin -type f -atime +100</td><td>æœç´¢åœ¨è¿‡å» 100 å¤©å†…æœªè¢«ä½¿ç”¨è¿‡çš„æ‰§è¡Œæ–‡ä»¶</td></tr><tr><td>find &#x2F;usr&#x2F;bin -type f -mtime -10</td><td>æœç´¢åœ¨ 10 å¤©å†…è¢«åˆ›å»ºæˆ–è€…ä¿®æ”¹è¿‡çš„æ–‡ä»¶</td></tr><tr><td>find &#x2F; -name *.rpm -exec chmod 755 â€˜{}â€™</td><td>æœç´¢ä»¥ â€˜.rpmâ€™ ç»“å°¾çš„æ–‡ä»¶å¹¶å®šä¹‰å…¶æƒé™</td></tr><tr><td>find &#x2F; -xdev -name *.rpm</td><td>æœç´¢ä»¥ â€˜.rpmâ€™ ç»“å°¾çš„æ–‡ä»¶ï¼Œå¿½ç•¥å…‰é©±ã€æ·ç›˜ç­‰å¯ç§»åŠ¨è®¾å¤‡</td></tr><tr><td>locate *.ps</td><td>å¯»æ‰¾ä»¥ â€˜.psâ€™ ç»“å°¾çš„æ–‡ä»¶ - å…ˆè¿è¡Œ â€˜updatedbâ€™ å‘½ä»¤</td></tr><tr><td>whereis halt</td><td>æ˜¾ç¤ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ã€æºç æˆ–å¯æ‰§è¡Œæ–‡ä»¶çš„ä½ç½®</td></tr><tr><td>which halt</td><td>æ˜¾ç¤ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶æˆ–å¯æ‰§è¡Œæ–‡ä»¶çš„å®Œæ•´è·¯å¾„</td></tr></tbody></table><h2 id="5-æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ"><a href="#5-æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="5. æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ"></a>5. æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ</h2><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>mount &#x2F;dev&#x2F;hda2 &#x2F;mnt&#x2F;hda2</td><td>æŒ‚è½½ä¸€ä¸ªå«åš hda2 çš„ç›˜ - ç¡®å®šç›®å½• â€˜&#x2F;mnt&#x2F;hda2â€™ å·²ç»å­˜åœ¨</td></tr><tr><td>umount &#x2F;dev&#x2F;hda2</td><td>å¸è½½ä¸€ä¸ªå«åš hda2 çš„ç›˜ - å…ˆä»æŒ‚è½½ç‚¹ â€˜&#x2F;mnt&#x2F;hda2â€™ é€€å‡º</td></tr><tr><td>fuser -km &#x2F;mnt&#x2F;hda2</td><td>å½“è®¾å¤‡ç¹å¿™æ—¶å¼ºåˆ¶å¸è½½</td></tr><tr><td>umount -n &#x2F;mnt&#x2F;hda2</td><td>è¿è¡Œå¸è½½æ“ä½œè€Œä¸å†™å…¥ â€˜&#x2F;etc&#x2F;mtabâ€™ æ–‡ä»¶- å½“æ–‡ä»¶ä¸ºåªè¯»æˆ–å½“ç£ç›˜å†™æ»¡æ—¶éå¸¸æœ‰ç”¨</td></tr><tr><td>mount &#x2F;dev&#x2F;fd0 &#x2F;mnt&#x2F;floppy</td><td>æŒ‚è½½ä¸€ä¸ªè½¯ç›˜</td></tr><tr><td>mount &#x2F;dev&#x2F;cdrom &#x2F;mnt&#x2F;cdrom</td><td>æŒ‚è½½ä¸€ä¸ª cdrom æˆ– dvdrom</td></tr><tr><td>mount &#x2F;dev&#x2F;hdc &#x2F;mnt&#x2F;cdrecorder</td><td>æŒ‚è½½ä¸€ä¸ª cdrw æˆ– dvdrom</td></tr><tr><td>mount &#x2F;dev&#x2F;hdb &#x2F;mnt&#x2F;cdrecorder</td><td>æŒ‚è½½ä¸€ä¸ª cdrw æˆ– dvdrom</td></tr><tr><td>mount -o loop file.iso &#x2F;mnt&#x2F;cdrom</td><td>æŒ‚è½½ä¸€ä¸ªæ–‡ä»¶æˆ– ISO é•œåƒæ–‡ä»¶</td></tr><tr><td>mount -t vfat &#x2F;dev&#x2F;hda5 &#x2F;mnt&#x2F;hda5</td><td>æŒ‚è½½ä¸€ä¸ª Windows FAT32 æ–‡ä»¶ç³»ç»Ÿ</td></tr><tr><td>mount &#x2F;dev&#x2F;sda1 &#x2F;mnt&#x2F;usbdisk</td><td>æŒ‚è½½ä¸€ä¸ª usb æ·ç›˜æˆ–é—ªå­˜è®¾å¤‡</td></tr><tr><td>mount -t smbfs -o username&#x3D;user,password&#x3D;pass &#x2F;&#x2F;WinClient&#x2F;share &#x2F;mnt&#x2F;share</td><td>æŒ‚è½½ä¸€ä¸ª windows ç½‘ç»œå…±äº«</td></tr></tbody></table><h2 id="6-ç£ç›˜ç©ºé—´"><a href="#6-ç£ç›˜ç©ºé—´" class="headerlink" title="6. ç£ç›˜ç©ºé—´"></a>6. ç£ç›˜ç©ºé—´</h2><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>df -h</td><td>æ˜¾ç¤ºå·²ç»æŒ‚è½½çš„åˆ†åŒºåˆ—è¡¨</td></tr><tr><td>ls -lSr | more</td><td>ä»¥å°ºå¯¸å¤§å°æ’åˆ—æ–‡ä»¶å’Œç›®å½•</td></tr><tr><td>du -sh dir1</td><td>ä¼°ç®—ç›®å½• â€˜dir1â€™ å·²ç»ä½¿ç”¨çš„ç£ç›˜ç©ºé—´â€™</td></tr><tr><td>du -sk * | sort -rn</td><td>ä»¥å®¹é‡å¤§å°ä¸ºä¾æ®ä¾æ¬¡æ˜¾ç¤ºæ–‡ä»¶å’Œç›®å½•çš„å¤§å°</td></tr><tr><td>rpm -q -a â€“qf â€˜%10{SIZE}t%{NAME}nâ€™ | sort -k1,1n</td><td>ä»¥å¤§å°ä¸ºä¾æ®ä¾æ¬¡æ˜¾ç¤ºå·²å®‰è£…çš„ rpm åŒ…æ‰€ä½¿ç”¨çš„ç©ºé—´ï¼ˆfedoraï¼ŒRedHat ç±»ç³»ç»Ÿï¼‰</td></tr><tr><td>dpkg-query -W -f&#x3D;â€™${Installed-Size10}t${Package}nâ€™ | sort -k1,1n</td><td>ä»¥å¤§å°ä¸ºä¾æ®æ˜¾ç¤ºå·²å®‰è£…çš„ deb åŒ…æ‰€ä½¿ç”¨çš„ç©ºé—´ï¼ˆubuntuï¼Œdebian ç±»ç³»ç»Ÿï¼‰</td></tr></tbody></table><h2 id="7-ç”¨æˆ·å’Œç¾¤ç»„"><a href="#7-ç”¨æˆ·å’Œç¾¤ç»„" class="headerlink" title="7. ç”¨æˆ·å’Œç¾¤ç»„"></a>7. ç”¨æˆ·å’Œç¾¤ç»„</h2><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>groupadd group_name</td><td>åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·ç»„</td></tr><tr><td>groupdel group_name</td><td>åˆ é™¤ä¸€ä¸ªç”¨æˆ·ç»„</td></tr><tr><td>groupmod -n new_group_name old_group_name</td><td>é‡å‘½åä¸€ä¸ªç”¨æˆ·ç»„</td></tr><tr><td>useradd -c â€œName Surnameâ€ -g admin -d &#x2F;home&#x2F;user1 -s &#x2F;bin&#x2F;bash user1</td><td>åˆ›å»ºä¸€ä¸ªå±äº â€œadminâ€ ç”¨æˆ·ç»„çš„ç”¨æˆ·</td></tr><tr><td>useradd user1</td><td>åˆ›å»ºä¸€ä¸ªæ–°ç”¨æˆ·</td></tr><tr><td>userdel -r user1</td><td>åˆ é™¤ä¸€ä¸ªç”¨æˆ·ï¼ˆâ€™-râ€™ æ’é™¤ä¸»ç›®å½•ï¼‰</td></tr><tr><td>usermod -c â€œUser FTPâ€ -g system -d &#x2F;ftp&#x2F;user1 -s &#x2F;bin&#x2F;nologin user1</td><td>ä¿®æ”¹ç”¨æˆ·å±æ€§</td></tr><tr><td>passwd</td><td>ä¿®æ”¹å¯†ç </td></tr><tr><td>passwd user1</td><td>ä¿®æ”¹ä¸€ä¸ªç”¨æˆ·çš„å¯†ç ï¼ˆåªå…è®¸ root æ‰§è¡Œï¼‰</td></tr><tr><td>chage -E 2005-12-31 user1</td><td>è®¾ç½®ç”¨æˆ·å¯†ç çš„å¤±æ•ˆæœŸé™</td></tr><tr><td>pwck</td><td>æ£€æŸ¥ â€˜&#x2F;etc&#x2F;passwdâ€™ çš„æ–‡ä»¶æ ¼å¼å’Œè¯­æ³•ä¿®æ­£ä»¥åŠå­˜åœ¨çš„ç”¨æˆ·</td></tr><tr><td>grpck</td><td>æ£€æŸ¥ â€˜&#x2F;etc&#x2F;passwdâ€™ çš„æ–‡ä»¶æ ¼å¼å’Œè¯­æ³•ä¿®æ­£ä»¥åŠå­˜åœ¨çš„ç¾¤ç»„</td></tr><tr><td>newgrp group_name</td><td>ç™»é™†è¿›ä¸€ä¸ªæ–°çš„ç¾¤ç»„ä»¥æ”¹å˜æ–°åˆ›å»ºæ–‡ä»¶çš„é¢„è®¾ç¾¤ç»„</td></tr></tbody></table><h2 id="8-æ–‡ä»¶çš„æƒé™"><a href="#8-æ–‡ä»¶çš„æƒé™" class="headerlink" title="8. æ–‡ä»¶çš„æƒé™"></a>8. æ–‡ä»¶çš„æƒé™</h2><p><strong>ä½¿ç”¨ â€œ+â€ è®¾ç½®æƒé™ï¼Œä½¿ç”¨ â€œ-â€œ ç”¨äºå–æ¶ˆ</strong></p><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>ls -lh</td><td>æ˜¾ç¤ºæƒé™</td></tr><tr><td>ls &#x2F;tmp | pr -T5 -W$COLUMNS</td><td>å°†ç»ˆç«¯åˆ’åˆ†æˆ 5 æ æ˜¾ç¤º</td></tr><tr><td>chmod ugo+rwx directory1</td><td>è®¾ç½®ç›®å½•çš„æ‰€æœ‰äººï¼ˆuï¼‰ã€ç¾¤ç»„ï¼ˆgï¼‰ä»¥åŠå…¶ä»–äººï¼ˆoï¼‰ä»¥è¯»ï¼ˆrï¼‰ã€å†™ï¼ˆwï¼‰å’Œæ‰§è¡Œï¼ˆxï¼‰çš„æƒé™</td></tr><tr><td>chmod go-rwx directory1</td><td>åˆ é™¤ç¾¤ç»„ï¼ˆgï¼‰ä¸å…¶ä»–äººï¼ˆoï¼‰å¯¹ç›®å½•çš„è¯»å†™æ‰§è¡Œæƒé™</td></tr><tr><td>chown user1 file1</td><td>æ”¹å˜ä¸€ä¸ªæ–‡ä»¶çš„æ‰€æœ‰äººå±æ€§</td></tr><tr><td>chown -R user1 directory1</td><td>æ”¹å˜ä¸€ä¸ªç›®å½•çš„æ‰€æœ‰äººå±æ€§å¹¶åŒæ—¶æ”¹å˜æ”¹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶çš„å±æ€§</td></tr><tr><td>chgrp group1 file1</td><td>æ”¹å˜æ–‡ä»¶çš„ç¾¤ç»„</td></tr><tr><td>chown user1:group1 file1</td><td>æ”¹å˜ä¸€ä¸ªæ–‡ä»¶çš„æ‰€æœ‰äººå’Œç¾¤ç»„å±æ€§</td></tr><tr><td>find &#x2F; -perm -u+s</td><td>ç½—åˆ—ä¸€ä¸ªç³»ç»Ÿä¸­æ‰€æœ‰ä½¿ç”¨äº† SUID æ§åˆ¶çš„æ–‡ä»¶</td></tr><tr><td>chmod u+s &#x2F;bin&#x2F;file1</td><td>è®¾ç½®ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„ SUID ä½ - è¿è¡Œè¯¥æ–‡ä»¶çš„ç”¨æˆ·ä¹Ÿè¢«èµ‹äºˆå’Œæ‰€æœ‰è€…åŒæ ·çš„æƒé™</td></tr><tr><td>chmod u-s &#x2F;bin&#x2F;file1</td><td>ç¦ç”¨ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„ SUID ä½</td></tr><tr><td>chmod g+s &#x2F;home&#x2F;public</td><td>è®¾ç½®ä¸€ä¸ªç›®å½•çš„ SGID ä½ - ç±»ä¼¼ SUIDï¼Œä¸è¿‡è¿™æ˜¯é’ˆå¯¹ç›®å½•çš„</td></tr><tr><td>chmod g-s &#x2F;home&#x2F;public</td><td>ç¦ç”¨ä¸€ä¸ªç›®å½•çš„ SGID ä½</td></tr><tr><td>chmod o+t &#x2F;home&#x2F;public</td><td>è®¾ç½®ä¸€ä¸ªæ–‡ä»¶çš„ STIKY ä½ - åªå…è®¸åˆæ³•æ‰€æœ‰äººåˆ é™¤æ–‡ä»¶</td></tr><tr><td>chmod o-t &#x2F;home&#x2F;public</td><td>ç¦ç”¨ä¸€ä¸ªç›®å½•çš„ STIKY ä½</td></tr></tbody></table><h2 id="9-æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§"><a href="#9-æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§" class="headerlink" title="9. æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§"></a>9. æ–‡ä»¶çš„ç‰¹æ®Šå±æ€§</h2><p><strong>ä½¿ç”¨ â€œ+â€ è®¾ç½®æƒé™ï¼Œä½¿ç”¨ â€œ-â€œ ç”¨äºå–æ¶ˆ</strong></p><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>chattr +a file1</td><td>åªå…è®¸ä»¥è¿½åŠ æ–¹å¼è¯»å†™æ–‡ä»¶</td></tr><tr><td>chattr +c file1</td><td>å…è®¸è¿™ä¸ªæ–‡ä»¶èƒ½è¢«å†…æ ¸è‡ªåŠ¨å‹ç¼©&#x2F;è§£å‹</td></tr><tr><td>chattr +d file1</td><td>åœ¨è¿›è¡Œæ–‡ä»¶ç³»ç»Ÿå¤‡ä»½æ—¶ï¼Œdump ç¨‹åºå°†å¿½ç•¥è¿™ä¸ªæ–‡ä»¶</td></tr><tr><td>chattr +i file1</td><td>è®¾ç½®æˆä¸å¯å˜çš„æ–‡ä»¶ï¼Œä¸èƒ½è¢«åˆ é™¤ã€ä¿®æ”¹ã€é‡å‘½åæˆ–è€…é“¾æ¥</td></tr><tr><td>chattr +s file1</td><td>å…è®¸ä¸€ä¸ªæ–‡ä»¶è¢«å®‰å…¨åœ°åˆ é™¤</td></tr><tr><td>chattr +S file1</td><td>ä¸€æ—¦åº”ç”¨ç¨‹åºå¯¹è¿™ä¸ªæ–‡ä»¶æ‰§è¡Œäº†å†™æ“ä½œï¼Œä½¿ç³»ç»Ÿç«‹åˆ»æŠŠä¿®æ”¹çš„ç»“æœå†™åˆ°ç£ç›˜</td></tr><tr><td>chattr +u file1</td><td>è‹¥æ–‡ä»¶è¢«åˆ é™¤ï¼Œç³»ç»Ÿä¼šå…è®¸ä½ åœ¨ä»¥åæ¢å¤è¿™ä¸ªè¢«åˆ é™¤çš„æ–‡ä»¶</td></tr><tr><td>lsattr</td><td>æ˜¾ç¤ºç‰¹æ®Šçš„å±æ€§</td></tr></tbody></table><h2 id="10-æ‰“åŒ…å’Œè§£å‹ç¼©æ–‡ä»¶"><a href="#10-æ‰“åŒ…å’Œè§£å‹ç¼©æ–‡ä»¶" class="headerlink" title="10. æ‰“åŒ…å’Œè§£å‹ç¼©æ–‡ä»¶"></a>10. æ‰“åŒ…å’Œè§£å‹ç¼©æ–‡ä»¶</h2><h3 id="10-1-è§£å‹ç¼©"><a href="#10-1-è§£å‹ç¼©" class="headerlink" title="10.1 è§£å‹ç¼©"></a>10.1 è§£å‹ç¼©</h3><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>bunzip2 file1.bz2</td><td>è§£å‹ä¸€ä¸ªå«åš â€˜file1.bz2â€™ çš„æ–‡ä»¶</td></tr><tr><td>bzip2 file1</td><td>å‹ç¼©ä¸€ä¸ªå«åš â€˜file1â€™ çš„æ–‡ä»¶</td></tr><tr><td>gunzip file1.gz</td><td>è§£å‹ä¸€ä¸ªå«åš â€˜file1.gzâ€™ çš„æ–‡ä»¶</td></tr><tr><td>gzip file1</td><td>å‹ç¼©ä¸€ä¸ªå«åš â€˜file1 â€˜çš„æ–‡ä»¶</td></tr><tr><td>gzip -9 file1</td><td>æœ€å¤§ç¨‹åº¦å‹ç¼©</td></tr><tr><td>rar a file1.rar test_file</td><td>åˆ›å»ºä¸€ä¸ªå«åš â€˜file1.rarâ€™ çš„åŒ…</td></tr><tr><td>rar a file1.rar file1 file2 dir1</td><td>åŒæ—¶å‹ç¼© â€˜file1â€™, â€˜file2â€™ ä»¥åŠç›®å½• â€˜dir1â€™</td></tr><tr><td>unrar x file1.rar</td><td>è§£å‹ rar åŒ…</td></tr><tr><td>tar -cvf archive.tar file1</td><td>åˆ›å»ºä¸€ä¸ªéå‹ç¼©çš„ tarball</td></tr><tr><td>tar -cvf archive.tar file1 file2 dir1</td><td>åˆ›å»ºä¸€ä¸ªåŒ…å«äº† â€˜file1â€™, â€˜file2â€™ ä»¥åŠ â€˜dir1â€™ çš„åŒ…</td></tr><tr><td>tar -tf archive.tar</td><td>æ˜¾ç¤ºä¸€ä¸ªåŒ…ä¸­çš„å†…å®¹</td></tr><tr><td>tar -xvf archive.tar</td><td>é‡Šæ”¾ä¸€ä¸ªåŒ…</td></tr><tr><td>tar -xvf archive.tar -C &#x2F;tmp</td><td>å°†å‹ç¼©åŒ…é‡Šæ”¾åˆ° &#x2F;tmp ç›®å½•ä¸‹</td></tr><tr><td>tar -cvfj archive.tar.bz2 dir1</td><td>åˆ›å»ºä¸€ä¸ª bzip2 æ ¼å¼çš„å‹ç¼©åŒ…</td></tr><tr><td>tar -jxvf archive.tar.bz2</td><td>è§£å‹ä¸€ä¸ª bzip2 æ ¼å¼çš„å‹ç¼©åŒ…</td></tr><tr><td>tar -cvfz archive.tar.gz dir1</td><td>åˆ›å»ºä¸€ä¸ª gzip æ ¼å¼çš„å‹ç¼©åŒ…</td></tr><tr><td>tar -zxvf archive.tar.gz</td><td>è§£å‹ä¸€ä¸ª gzip æ ¼å¼çš„å‹ç¼©åŒ…</td></tr><tr><td>zip file1.zip file1</td><td>åˆ›å»ºä¸€ä¸ª zip æ ¼å¼çš„å‹ç¼©åŒ…</td></tr><tr><td>zip -r file1.zip file1 file2 dir1</td><td>å°†å‡ ä¸ªæ–‡ä»¶å’Œç›®å½•åŒæ—¶å‹ç¼©æˆä¸€ä¸ª zip æ ¼å¼çš„å‹ç¼©åŒ…</td></tr><tr><td>unzip file1.zip</td><td>è§£å‹ä¸€ä¸ª zip æ ¼å¼å‹ç¼©åŒ…</td></tr></tbody></table><h3 id="10-2-RPM-åŒ…"><a href="#10-2-RPM-åŒ…" class="headerlink" title="10.2 RPM åŒ…"></a>10.2 RPM åŒ…</h3><p><strong>Fedoraï¼ŒRedHat åŠç±»ä¼¼ç³»ç»Ÿ</strong></p><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>rpm -ivh package.rpm</td><td>å®‰è£…ä¸€ä¸ª rpm åŒ…</td></tr><tr><td>rpm -ivh â€“nodeeps package.rpm</td><td>å®‰è£…ä¸€ä¸ª rpm åŒ…è€Œå¿½ç•¥ä¾èµ–å…³ç³»è­¦å‘Š</td></tr><tr><td>rpm -U package.rpm</td><td>æ›´æ–°ä¸€ä¸ª rpm åŒ…ä½†ä¸æ”¹å˜å…¶é…ç½®æ–‡ä»¶</td></tr><tr><td>rpm -F package.rpm</td><td>æ›´æ–°ä¸€ä¸ªç¡®å®šå·²ç»å®‰è£…çš„ rpm åŒ…</td></tr><tr><td>rpm -e package_name.rpm</td><td>åˆ é™¤ä¸€ä¸ª rpm åŒ…</td></tr><tr><td>rpm -qa</td><td>æ˜¾ç¤ºç³»ç»Ÿä¸­æ‰€æœ‰å·²ç»å®‰è£…çš„ rpm åŒ…</td></tr><tr><td>rpm -qa | grep httpd</td><td>æ˜¾ç¤ºæ‰€æœ‰åç§°ä¸­åŒ…å« â€œhttpdâ€ å­—æ ·çš„ rpm åŒ…</td></tr><tr><td>rpm -qi package_name</td><td>è·å–ä¸€ä¸ªå·²å®‰è£…åŒ…çš„ç‰¹æ®Šä¿¡æ¯</td></tr><tr><td>rpm -qg â€œSystem Environment&#x2F;Daemonsâ€</td><td>æ˜¾ç¤ºä¸€ä¸ªç»„ä»¶çš„ rpm åŒ…</td></tr><tr><td>rpm -ql package_name</td><td>æ˜¾ç¤ºä¸€ä¸ªå·²ç»å®‰è£…çš„ rpm åŒ…æä¾›çš„æ–‡ä»¶åˆ—è¡¨</td></tr><tr><td>rpm -qc package_name</td><td>æ˜¾ç¤ºä¸€ä¸ªå·²ç»å®‰è£…çš„ rpm åŒ…æä¾›çš„é…ç½®æ–‡ä»¶åˆ—è¡¨</td></tr><tr><td>rpm -q package_name â€“whatrequires</td><td>æ˜¾ç¤ºä¸ä¸€ä¸ª rpm åŒ…å­˜åœ¨ä¾èµ–å…³ç³»çš„åˆ—è¡¨</td></tr><tr><td>rpm -q package_name â€“whatprovides</td><td>æ˜¾ç¤ºä¸€ä¸ª rpm åŒ…æ‰€å çš„ä½“ç§¯</td></tr><tr><td>rpm -q package_name â€“scripts</td><td>æ˜¾ç¤ºåœ¨å®‰è£…&#x2F;åˆ é™¤æœŸé—´æ‰€æ‰§è¡Œçš„è„šæœ¬</td></tr><tr><td>rpm -q package_name â€“changelog</td><td>æ˜¾ç¤ºä¸€ä¸ª rpm åŒ…çš„ä¿®æ”¹å†å²</td></tr><tr><td>rpm -qf &#x2F;etc&#x2F;httpd&#x2F;conf&#x2F;httpd.conf</td><td>ç¡®è®¤æ‰€ç»™çš„æ–‡ä»¶ç”±å“ªä¸ª rpm åŒ…æ‰€æä¾›</td></tr><tr><td>rpm -qp package.rpm -l</td><td>æ˜¾ç¤ºç”±ä¸€ä¸ªå°šæœªå®‰è£…çš„ rpm åŒ…æä¾›çš„æ–‡ä»¶åˆ—è¡¨</td></tr><tr><td>rpm â€“import &#x2F;media&#x2F;cdrom&#x2F;RPM-GPG-KEY</td><td>å¯¼å…¥å…¬é’¥æ•°å­—è¯ä¹¦</td></tr><tr><td>rpm â€“checksig package.rpm</td><td>ç¡®è®¤ä¸€ä¸ª rpm åŒ…çš„å®Œæ•´æ€§</td></tr><tr><td>rpm -qa gpg-pubkey</td><td>ç¡®è®¤å·²å®‰è£…çš„æ‰€æœ‰ rpm åŒ…çš„å®Œæ•´æ€§</td></tr><tr><td>rpm -V package_name</td><td>æ£€æŸ¥æ–‡ä»¶å°ºå¯¸ã€è®¸å¯ã€ç±»å‹ã€æ‰€æœ‰è€…ã€ç¾¤ç»„ã€MD5 æ£€æŸ¥ä»¥åŠæœ€åä¿®æ”¹æ—¶é—´</td></tr><tr><td>rpm -Va</td><td>æ£€æŸ¥ç³»ç»Ÿä¸­æ‰€æœ‰å·²å®‰è£…çš„ rpm åŒ…- å°å¿ƒä½¿ç”¨</td></tr><tr><td>rpm -Vp package.rpm</td><td>ç¡®è®¤ä¸€ä¸ª rpm åŒ…è¿˜æœªå®‰è£…</td></tr><tr><td>rpm2cpio package.rpm | cpio â€“extract â€“make-directories <em>bin</em></td><td>ä»ä¸€ä¸ª rpm åŒ…è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶</td></tr><tr><td>rpm -ivh &#x2F;usr&#x2F;src&#x2F;RedHat&#x2F;RPMS&#x2F;arch&#x2F;package.rpm</td><td>ä»ä¸€ä¸ª rpm æºç å®‰è£…ä¸€ä¸ªæ„å»ºå¥½çš„åŒ…</td></tr><tr><td>rpmbuild â€“rebuild package_name.src.rpm</td><td>ä»ä¸€ä¸ª rpm æºç æ„å»ºä¸€ä¸ª rpm åŒ…</td></tr></tbody></table><h3 id="10-3-YUM-è½¯ä»¶åŒ…å‡çº§å™¨"><a href="#10-3-YUM-è½¯ä»¶åŒ…å‡çº§å™¨" class="headerlink" title="10.3 YUM è½¯ä»¶åŒ…å‡çº§å™¨"></a>10.3 YUM è½¯ä»¶åŒ…å‡çº§å™¨</h3><p><strong>Fedoraï¼ŒRedHat åŠç±»ä¼¼ç³»ç»Ÿ</strong></p><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>yum install package_name</td><td>ä¸‹è½½å¹¶å®‰è£…ä¸€ä¸ª rpm åŒ…</td></tr><tr><td>yum localinstall package_name.rpm</td><td>å°†å®‰è£…ä¸€ä¸ª rpm åŒ…ï¼Œä½¿ç”¨ä½ è‡ªå·±çš„è½¯ä»¶ä»“åº“ä¸ºä½ è§£å†³æ‰€æœ‰ä¾èµ–å…³ç³»</td></tr><tr><td>yum update package_name.rpm</td><td>æ›´æ–°å½“å‰ç³»ç»Ÿä¸­æ‰€æœ‰å®‰è£…çš„ rpm åŒ…</td></tr><tr><td>yum update package_name</td><td>æ›´æ–°ä¸€ä¸ª rpm åŒ…</td></tr><tr><td>yum remove package_name</td><td>åˆ é™¤ä¸€ä¸ª rpm åŒ…</td></tr><tr><td>yum list</td><td>åˆ—å‡ºå½“å‰ç³»ç»Ÿä¸­å®‰è£…çš„æ‰€æœ‰åŒ…</td></tr><tr><td>yum search package_name</td><td>åœ¨ rpm ä»“åº“ä¸­æœå¯»è½¯ä»¶åŒ…</td></tr><tr><td>yum clean packages</td><td>æ¸…ç† rpm ç¼“å­˜åˆ é™¤ä¸‹è½½çš„åŒ…</td></tr><tr><td>yum clean headers</td><td>åˆ é™¤æ‰€æœ‰å¤´æ–‡ä»¶</td></tr><tr><td>yum clean all</td><td>åˆ é™¤æ‰€æœ‰ç¼“å­˜çš„åŒ…å’Œå¤´æ–‡ä»¶</td></tr></tbody></table><h3 id="10-4-DEB-åŒ…"><a href="#10-4-DEB-åŒ…" class="headerlink" title="10.4 DEB åŒ…"></a>10.4 DEB åŒ…</h3><p><strong>Debianï¼ŒUbuntu ä»¥åŠç±»ä¼¼ç³»ç»Ÿ</strong></p><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>dpkg -i package.deb</td><td>å®‰è£…&#x2F;æ›´æ–°ä¸€ä¸ª deb åŒ…</td></tr><tr><td>dpkg -r package_name</td><td>ä»ç³»ç»Ÿåˆ é™¤ä¸€ä¸ª deb åŒ…</td></tr><tr><td>dpkg -l</td><td>æ˜¾ç¤ºç³»ç»Ÿä¸­æ‰€æœ‰å·²ç»å®‰è£…çš„ deb åŒ…</td></tr><tr><td>dpkg -l | grep httpd</td><td>æ˜¾ç¤ºæ‰€æœ‰åç§°ä¸­åŒ…å« â€œhttpdâ€ å­—æ ·çš„ deb åŒ…</td></tr><tr><td>dpkg -s package_name</td><td>è·å¾—å·²ç»å®‰è£…åœ¨ç³»ç»Ÿä¸­ä¸€ä¸ªç‰¹æ®ŠåŒ…çš„ä¿¡æ¯</td></tr><tr><td>dpkg -L package_name</td><td>æ˜¾ç¤ºç³»ç»Ÿä¸­å·²ç»å®‰è£…çš„ä¸€ä¸ª deb åŒ…æ‰€æä¾›çš„æ–‡ä»¶åˆ—è¡¨</td></tr><tr><td>dpkg â€“contents package.deb</td><td>æ˜¾ç¤ºå°šæœªå®‰è£…çš„ä¸€ä¸ªåŒ…æ‰€æä¾›çš„æ–‡ä»¶åˆ—è¡¨</td></tr><tr><td>dpkg -S &#x2F;bin&#x2F;ping</td><td>ç¡®è®¤æ‰€ç»™çš„æ–‡ä»¶ç”±å“ªä¸ª deb åŒ…æä¾›</td></tr></tbody></table><h3 id="10-5-APT-è½¯ä»¶å·¥å…·ï¼ˆDebian-Ubuntu-ä»¥åŠç±»ä¼¼ç³»ç»Ÿï¼‰"><a href="#10-5-APT-è½¯ä»¶å·¥å…·ï¼ˆDebian-Ubuntu-ä»¥åŠç±»ä¼¼ç³»ç»Ÿï¼‰" class="headerlink" title="10.5 APT è½¯ä»¶å·¥å…·ï¼ˆDebian, Ubuntu ä»¥åŠç±»ä¼¼ç³»ç»Ÿï¼‰"></a>10.5 APT è½¯ä»¶å·¥å…·ï¼ˆDebian, Ubuntu ä»¥åŠç±»ä¼¼ç³»ç»Ÿï¼‰</h3><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>apt-get install package_name</td><td>å®‰è£…&#x2F;æ›´æ–°ä¸€ä¸ª deb åŒ…</td></tr><tr><td>apt-cdrom install package_name</td><td>ä»å…‰ç›˜å®‰è£…&#x2F;æ›´æ–°ä¸€ä¸ª deb åŒ…</td></tr><tr><td>apt-get update</td><td>å‡çº§åˆ—è¡¨ä¸­çš„è½¯ä»¶åŒ…</td></tr><tr><td>apt-get upgrade</td><td>å‡çº§æ‰€æœ‰å·²å®‰è£…çš„è½¯ä»¶</td></tr><tr><td>apt-get remove package_name</td><td>ä»ç³»ç»Ÿåˆ é™¤ä¸€ä¸ª deb åŒ…</td></tr><tr><td>apt-get check</td><td>ç¡®è®¤ä¾èµ–çš„è½¯ä»¶ä»“åº“æ­£ç¡®</td></tr><tr><td>apt-get clean</td><td>ä»ä¸‹è½½çš„è½¯ä»¶åŒ…ä¸­æ¸…ç†ç¼“å­˜</td></tr><tr><td>apt-cache search searched-package</td><td>è¿”å›åŒ…å«æ‰€è¦æœç´¢å­—ç¬¦ä¸²çš„è½¯ä»¶åŒ…åç§°</td></tr></tbody></table><h2 id="11-æŸ¥çœ‹æ–‡ä»¶å†…å®¹"><a href="#11-æŸ¥çœ‹æ–‡ä»¶å†…å®¹" class="headerlink" title="11. æŸ¥çœ‹æ–‡ä»¶å†…å®¹"></a>11. æŸ¥çœ‹æ–‡ä»¶å†…å®¹</h2><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>cat file1</td><td>ä»ç¬¬ä¸€ä¸ªå­—èŠ‚å¼€å§‹æ­£å‘æŸ¥çœ‹æ–‡ä»¶çš„å†…å®¹</td></tr><tr><td>tac file1</td><td>ä»æœ€åä¸€è¡Œå¼€å§‹åå‘æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹</td></tr><tr><td>more file1</td><td>æŸ¥çœ‹ä¸€ä¸ªé•¿æ–‡ä»¶çš„å†…å®¹</td></tr><tr><td>less file1</td><td>ç±»ä¼¼äº â€˜moreâ€™ å‘½ä»¤ï¼Œä½†æ˜¯å®ƒå…è®¸åœ¨æ–‡ä»¶ä¸­å’Œæ­£å‘æ“ä½œä¸€æ ·çš„åå‘æ“ä½œ</td></tr><tr><td>head -2 file1</td><td>æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„å‰ä¸¤è¡Œ</td></tr><tr><td>tail -2 file1</td><td>æŸ¥çœ‹ä¸€ä¸ªæ–‡ä»¶çš„æœ€åä¸¤è¡Œ</td></tr><tr><td>tail -f &#x2F;var&#x2F;log&#x2F;messages</td><td>å®æ—¶æŸ¥çœ‹è¢«æ·»åŠ åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹</td></tr></tbody></table><h2 id="12-æ–‡æœ¬å¤„ç†"><a href="#12-æ–‡æœ¬å¤„ç†" class="headerlink" title="12. æ–‡æœ¬å¤„ç†"></a>12. æ–‡æœ¬å¤„ç†</h2><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>cat file1 file2 â€¦ | command &lt;&gt; file1_in.txt_or_file1_out.txt</td><td>åˆå¹¶ä¸€ä¸ªæ–‡ä»¶çš„è¯¦ç»†è¯´æ˜æ–‡æœ¬ï¼Œå¹¶å°†ç®€ä»‹å†™å‡ºæ–°æ–‡ä»¶ä¸­</td></tr><tr><td>cat file1 | command( sed, grep, awk, grep, etcâ€¦) &gt; result.txt</td><td>åˆå¹¶ä¸€ä¸ªæ–‡ä»¶çš„è¯¦ç»†è¯´æ˜æ–‡æœ¬ï¼Œå¹¶å°†ç®€ä»‹å†™å…¥ä¸€ä¸ªæ–°æ–‡ä»¶ä¸­</td></tr><tr><td>cat file1 | command( sed, grep, awk, grep, etcâ€¦) &gt;&gt; result.txt</td><td>åˆå¹¶ä¸€ä¸ªæ–‡ä»¶çš„è¯¦ç»†è¯´æ˜æ–‡æœ¬ï¼Œå¹¶å°†ç®€ä»‹å†™å…¥ä¸€ä¸ªå·²æœ‰çš„æ–‡ä»¶ä¸­</td></tr><tr><td>grep Aug &#x2F;var&#x2F;log&#x2F;messages</td><td>åœ¨æ–‡ä»¶ â€˜&#x2F;var&#x2F;log&#x2F;messagesâ€™ ä¸­æŸ¥æ‰¾å…³é”®è¯ â€œAugâ€</td></tr><tr><td>grep ^Aug &#x2F;var&#x2F;log&#x2F;messages</td><td>åœ¨æ–‡ä»¶ â€˜&#x2F;var&#x2F;log&#x2F;messagesâ€™ ä¸­æŸ¥æ‰¾ä»¥ â€œAugâ€ å¼€å§‹çš„è¯æ±‡</td></tr><tr><td>grep [0-9] &#x2F;var&#x2F;log&#x2F;messages</td><td>é€‰æ‹© â€˜&#x2F;var&#x2F;log&#x2F;messagesâ€™ æ–‡ä»¶ä¸­æ‰€æœ‰åŒ…å«æ•°å­—çš„è¡Œ</td></tr><tr><td>grep Aug -R &#x2F;var&#x2F;log&#x2F;*</td><td>åœ¨ç›®å½• â€˜&#x2F;var&#x2F;logâ€™ åŠéšåçš„ç›®å½•ä¸­æœç´¢å­—ç¬¦ä¸² â€œAugâ€</td></tr><tr><td>sed â€˜s&#x2F;stringa1&#x2F;stringa2&#x2F;gâ€™ example.txt</td><td>å°† example.txt æ–‡ä»¶ä¸­çš„ â€œstring1â€ æ›¿æ¢æˆ â€œstring2â€</td></tr><tr><td>sed â€˜&#x2F;^$&#x2F;dâ€™ example.txt</td><td>ä» example.txt æ–‡ä»¶ä¸­åˆ é™¤æ‰€æœ‰ç©ºç™½è¡Œ</td></tr><tr><td>sed â€˜&#x2F; *#&#x2F;d &#x2F;^$&#x2F;dâ€™ example.txt</td><td>ä» example.txt æ–‡ä»¶ä¸­åˆ é™¤æ‰€æœ‰æ³¨é‡Šå’Œç©ºç™½è¡Œ</td></tr><tr><td>echo â€˜esempioâ€™ | tr â€˜[:lower:]â€™ â€˜[:upper:]â€™</td><td>åˆå¹¶ä¸Šä¸‹å•å…ƒæ ¼å†…å®¹</td></tr><tr><td>sed -e â€˜1dâ€™ result.txt</td><td>ä»æ–‡ä»¶ example.txt ä¸­æ’é™¤ç¬¬ä¸€è¡Œ</td></tr><tr><td>sed -n â€˜&#x2F;stringa1&#x2F;pâ€™</td><td>æŸ¥çœ‹åªåŒ…å«è¯æ±‡ â€œstring1â€ çš„è¡Œ</td></tr><tr><td>sed -e â€˜s&#x2F; *$&#x2F;&#x2F;â€˜ example.txt</td><td>åˆ é™¤æ¯ä¸€è¡Œæœ€åçš„ç©ºç™½å­—ç¬¦</td></tr><tr><td>sed -e â€˜s&#x2F;stringa1&#x2F;&#x2F;gâ€™ example.txt</td><td>ä»æ–‡æ¡£ä¸­åªåˆ é™¤è¯æ±‡ â€œstring1â€ å¹¶ä¿ç•™å‰©ä½™å…¨éƒ¨</td></tr><tr><td>sed -n â€˜1,5p5qâ€™ example.txt</td><td>æŸ¥çœ‹ä»ç¬¬ä¸€è¡Œåˆ°ç¬¬ 5 è¡Œå†…å®¹</td></tr><tr><td>sed -n â€˜5p5qâ€™ example.txt</td><td>æŸ¥çœ‹ç¬¬ 5 è¡Œ</td></tr><tr><td>sed -e â€˜s&#x2F;00*&#x2F;0&#x2F;gâ€™ example.txt</td><td>ç”¨å•ä¸ªé›¶æ›¿æ¢å¤šä¸ªé›¶</td></tr><tr><td>cat -n file1</td><td>æ ‡ç¤ºæ–‡ä»¶çš„è¡Œæ•°</td></tr><tr><td>cat example.txt | awk â€˜NR%2&#x3D;&#x3D;1â€™</td><td>åˆ é™¤ example.txt æ–‡ä»¶ä¸­çš„æ‰€æœ‰å¶æ•°è¡Œ</td></tr><tr><td>echo a b c | awk â€˜{print $1}â€™</td><td>æŸ¥çœ‹ä¸€è¡Œç¬¬ä¸€æ </td></tr><tr><td>echo a b c | awk â€˜{print $1,$3}â€™</td><td>æŸ¥çœ‹ä¸€è¡Œçš„ç¬¬ä¸€å’Œç¬¬ä¸‰æ </td></tr><tr><td>paste file1 file2</td><td>åˆå¹¶ä¸¤ä¸ªæ–‡ä»¶æˆ–ä¸¤æ çš„å†…å®¹</td></tr><tr><td>paste -d â€˜+â€™ file1 file2</td><td>åˆå¹¶ä¸¤ä¸ªæ–‡ä»¶æˆ–ä¸¤æ çš„å†…å®¹ï¼Œä¸­é—´ç”¨ â€œ+â€ åŒºåˆ†</td></tr><tr><td>sort file1 file2</td><td>æ’åºä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹</td></tr><tr><td>sort file1 file2 | uniq</td><td>å–å‡ºä¸¤ä¸ªæ–‡ä»¶çš„å¹¶é›†ï¼ˆé‡å¤çš„è¡Œåªä¿ç•™ä¸€ä»½ï¼‰</td></tr><tr><td>sort file1 file2 | uniq -u</td><td>åˆ é™¤äº¤é›†ï¼Œç•™ä¸‹å…¶ä»–çš„è¡Œ</td></tr><tr><td>sort file1 file2 | uniq -d</td><td>å–å‡ºä¸¤ä¸ªæ–‡ä»¶çš„äº¤é›†ï¼ˆåªç•™ä¸‹åŒæ—¶å­˜åœ¨äºä¸¤ä¸ªæ–‡ä»¶ä¸­çš„æ–‡ä»¶ï¼‰</td></tr><tr><td>comm -1 file1 file2</td><td>æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹åªåˆ é™¤ â€˜file1â€™ æ‰€åŒ…å«çš„å†…å®¹</td></tr><tr><td>comm -2 file1 file2</td><td>æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹åªåˆ é™¤ â€˜file2â€™ æ‰€åŒ…å«çš„å†…å®¹</td></tr><tr><td>comm -3 file1 file2</td><td>æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹åªåˆ é™¤ä¸¤ä¸ªæ–‡ä»¶å…±æœ‰çš„éƒ¨åˆ†</td></tr></tbody></table><h2 id="13-å­—ç¬¦è®¾ç½®å’Œæ–‡ä»¶æ ¼å¼è½¬æ¢"><a href="#13-å­—ç¬¦è®¾ç½®å’Œæ–‡ä»¶æ ¼å¼è½¬æ¢" class="headerlink" title="13. å­—ç¬¦è®¾ç½®å’Œæ–‡ä»¶æ ¼å¼è½¬æ¢"></a>13. å­—ç¬¦è®¾ç½®å’Œæ–‡ä»¶æ ¼å¼è½¬æ¢</h2><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>dos2unix filedos.txt fileunix.txt</td><td>å°†ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶çš„æ ¼å¼ä» MSDOS è½¬æ¢æˆ UNIX</td></tr><tr><td>unix2dos fileunix.txt filedos.txt</td><td>å°†ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶çš„æ ¼å¼ä» UNIX è½¬æ¢æˆ MSDOS</td></tr><tr><td>recode ..HTML &lt; page.txt &gt; page.html</td><td>å°†ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶è½¬æ¢æˆ html æ–‡ä»¶</td></tr><tr><td>recode -l | more</td><td>æ˜¾ç¤ºæ‰€æœ‰å…è®¸çš„è½¬æ¢æ ¼å¼</td></tr></tbody></table><h2 id="14-æ–‡ä»¶ç³»ç»Ÿåˆ†æ"><a href="#14-æ–‡ä»¶ç³»ç»Ÿåˆ†æ" class="headerlink" title="14.  æ–‡ä»¶ç³»ç»Ÿåˆ†æ"></a>14.  æ–‡ä»¶ç³»ç»Ÿåˆ†æ</h2><h3 id="14-1-æ£€æŸ¥-x2F-ä¿®å¤ç£ç›˜"><a href="#14-1-æ£€æŸ¥-x2F-ä¿®å¤ç£ç›˜" class="headerlink" title="14.1 æ£€æŸ¥&#x2F;ä¿®å¤ç£ç›˜"></a>14.1 æ£€æŸ¥&#x2F;ä¿®å¤ç£ç›˜</h3><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>badblocks -v &#x2F;dev&#x2F;hda1</td><td>æ£€æŸ¥ç£ç›˜ hda1 ä¸Šçš„åç£å—</td></tr><tr><td>fsck &#x2F;dev&#x2F;hda1</td><td>ä¿®å¤&#x2F;æ£€æŸ¥ hda1 ç£ç›˜ä¸Š linux æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§</td></tr><tr><td>fsck.ext2 &#x2F;dev&#x2F;hda1</td><td>ä¿®å¤&#x2F;æ£€æŸ¥ hda1 ç£ç›˜ä¸Š ext2 æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§</td></tr><tr><td>e2fsck &#x2F;dev&#x2F;hda1</td><td>ä¿®å¤&#x2F;æ£€æŸ¥ hda1 ç£ç›˜ä¸Š ext2 æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§</td></tr><tr><td>e2fsck -j &#x2F;dev&#x2F;hda1</td><td>ä¿®å¤&#x2F;æ£€æŸ¥ hda1 ç£ç›˜ä¸Š ext3 æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§</td></tr><tr><td>fsck.ext3 &#x2F;dev&#x2F;hda1</td><td>ä¿®å¤&#x2F;æ£€æŸ¥ hda1 ç£ç›˜ä¸Š ext3 æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§</td></tr><tr><td>fsck.vfat &#x2F;dev&#x2F;hda1</td><td>ä¿®å¤&#x2F;æ£€æŸ¥ hda1 ç£ç›˜ä¸Š fat æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§</td></tr><tr><td>fsck.msdos &#x2F;dev&#x2F;hda1</td><td>ä¿®å¤&#x2F;æ£€æŸ¥ hda1 ç£ç›˜ä¸Š dos æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§</td></tr><tr><td>dosfsck &#x2F;dev&#x2F;hda1</td><td>ä¿®å¤&#x2F;æ£€æŸ¥ hda1 ç£ç›˜ä¸Š dos æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´æ€§</td></tr></tbody></table><h3 id="14-2-åˆå§‹åŒ–ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ"><a href="#14-2-åˆå§‹åŒ–ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="14.2 åˆå§‹åŒ–ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ"></a>14.2 åˆå§‹åŒ–ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ</h3><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>mkfs &#x2F;dev&#x2F;hda1</td><td>åœ¨ hda1 åˆ†åŒºåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿ</td></tr><tr><td>mke2fs &#x2F;dev&#x2F;hda1</td><td>åœ¨ hda1 åˆ†åŒºåˆ›å»ºä¸€ä¸ª linux ext2 çš„æ–‡ä»¶ç³»ç»Ÿ</td></tr><tr><td>mke2fs -j &#x2F;dev&#x2F;hda1</td><td>åœ¨ hda1 åˆ†åŒºåˆ›å»ºä¸€ä¸ª linux ext3ï¼ˆæ—¥å¿—å‹ï¼‰çš„æ–‡ä»¶ç³»ç»Ÿ</td></tr><tr><td>mkfs -t vfat 32 -F &#x2F;dev&#x2F;hda1</td><td>åˆ›å»ºä¸€ä¸ª FAT32 æ–‡ä»¶ç³»ç»Ÿ</td></tr><tr><td>fdformat -n &#x2F;dev&#x2F;fd0</td><td>æ ¼å¼åŒ–ä¸€ä¸ªè½¯ç›˜</td></tr><tr><td>mkswap &#x2F;dev&#x2F;hda3</td><td>åˆ›å»ºä¸€ä¸ª swap æ–‡ä»¶ç³»ç»Ÿ</td></tr></tbody></table><h3 id="14-3-SWAP-æ–‡ä»¶ç³»ç»Ÿ"><a href="#14-3-SWAP-æ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="14.3 SWAP æ–‡ä»¶ç³»ç»Ÿ"></a>14.3 SWAP æ–‡ä»¶ç³»ç»Ÿ</h3><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>mkswap &#x2F;dev&#x2F;hda3</td><td>åˆ›å»ºä¸€ä¸ª swap æ–‡ä»¶ç³»ç»Ÿ</td></tr><tr><td>swapon &#x2F;dev&#x2F;hda3</td><td>å¯ç”¨ä¸€ä¸ªæ–°çš„ swap æ–‡ä»¶ç³»ç»Ÿ</td></tr><tr><td>swapon &#x2F;dev&#x2F;hda2 &#x2F;dev&#x2F;hdb3</td><td>å¯ç”¨ä¸¤ä¸ª swap åˆ†åŒº</td></tr></tbody></table><h2 id="15-å¤‡ä»½"><a href="#15-å¤‡ä»½" class="headerlink" title="15. å¤‡ä»½"></a>15. å¤‡ä»½</h2><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>dump -0aj -f &#x2F;tmp&#x2F;home0.bak &#x2F;home</td><td>åˆ¶ä½œä¸€ä¸ª â€˜&#x2F;homeâ€™ ç›®å½•çš„å®Œæ•´å¤‡ä»½</td></tr><tr><td>dump -1aj -f &#x2F;tmp&#x2F;home0.bak &#x2F;home</td><td>åˆ¶ä½œä¸€ä¸ª â€˜&#x2F;homeâ€™ ç›®å½•çš„äº¤äº’å¼å¤‡ä»½</td></tr><tr><td>restore -if &#x2F;tmp&#x2F;home0.bak</td><td>è¿˜åŸä¸€ä¸ªäº¤äº’å¼å¤‡ä»½</td></tr><tr><td>rsync -rogpav â€“delete &#x2F;home &#x2F;tmp</td><td>åŒæ­¥ä¸¤è¾¹çš„ç›®å½•</td></tr><tr><td>rsync -rogpav -e ssh â€“delete &#x2F;home ip_address:&#x2F;tmp</td><td>é€šè¿‡ ssh é€šé“ rsync</td></tr><tr><td>rsync -az -e ssh â€“delete ip_addr:&#x2F;home&#x2F;public &#x2F;home&#x2F;local</td><td>é€šè¿‡ ssh å’Œå‹ç¼©å°†ä¸€ä¸ªè¿œç¨‹ç›®å½•åŒæ­¥åˆ°æœ¬åœ°ç›®å½•</td></tr><tr><td>rsync -az -e ssh â€“delete &#x2F;home&#x2F;local ip_addr:&#x2F;home&#x2F;public</td><td>é€šè¿‡ ssh å’Œå‹ç¼©å°†æœ¬åœ°ç›®å½•åŒæ­¥åˆ°è¿œç¨‹ç›®å½•</td></tr><tr><td>dd bs&#x3D;1M if&#x3D;&#x2F;dev&#x2F;hda | gzip | ssh user@ip_addr â€˜dd of&#x3D;hda.gzâ€™</td><td>é€šè¿‡ ssh åœ¨è¿œç¨‹ä¸»æœºä¸Šæ‰§è¡Œä¸€æ¬¡å¤‡ä»½æœ¬åœ°ç£ç›˜çš„æ“ä½œ</td></tr><tr><td>dd if&#x3D;&#x2F;dev&#x2F;sda of&#x3D;&#x2F;tmp&#x2F;file1</td><td>å¤‡ä»½ç£ç›˜å†…å®¹åˆ°ä¸€ä¸ªæ–‡ä»¶</td></tr><tr><td>tar -Puf backup.tar &#x2F;home&#x2F;user</td><td>æ‰§è¡Œä¸€æ¬¡å¯¹ â€˜&#x2F;home&#x2F;userâ€™ ç›®å½•çš„äº¤äº’å¼å¤‡ä»½æ“ä½œ</td></tr><tr><td>( cd &#x2F;tmp&#x2F;local&#x2F; &amp;&amp; tar c . ) | ssh -C user@ip_addr â€˜cd &#x2F;home&#x2F;share&#x2F; &amp;&amp; tar x -pâ€™</td><td>é€šè¿‡ ssh åœ¨è¿œç¨‹ç›®å½•ä¸­å¤åˆ¶ä¸€ä¸ªç›®å½•å†…å®¹</td></tr><tr><td>( tar c &#x2F;home ) | ssh -C user@ip_addr â€˜cd &#x2F;home&#x2F;backup-home &amp;&amp; tar x -pâ€™</td><td>é€šè¿‡ ssh åœ¨è¿œç¨‹ç›®å½•ä¸­å¤åˆ¶ä¸€ä¸ªæœ¬åœ°ç›®å½•</td></tr><tr><td>tar cf - . | (cd &#x2F;tmp&#x2F;backup tar xf - )</td><td>æœ¬åœ°å°†ä¸€ä¸ªç›®å½•å¤åˆ¶åˆ°å¦ä¸€ä¸ªåœ°æ–¹ï¼Œä¿ç•™åŸæœ‰æƒé™åŠé“¾æ¥</td></tr><tr><td>find &#x2F;home&#x2F;user1 -name â€˜*.txtâ€™ | xargs cp -av â€“target-directory&#x3D;&#x2F;home&#x2F;backup&#x2F; â€“parents</td><td>ä»ä¸€ä¸ªç›®å½•æŸ¥æ‰¾å¹¶å¤åˆ¶æ‰€æœ‰ä»¥ â€˜.txtâ€™ ç»“å°¾çš„æ–‡ä»¶åˆ°å¦ä¸€ä¸ªç›®å½•</td></tr><tr><td>find &#x2F;var&#x2F;log -name â€˜*.logâ€™ | tar cv â€“files-from&#x3D;- | bzip2 &gt; log.tar.bz2</td><td>æŸ¥æ‰¾æ‰€æœ‰ä»¥ â€˜.logâ€™ ç»“å°¾çš„æ–‡ä»¶å¹¶åšæˆä¸€ä¸ª bzip åŒ…</td></tr><tr><td>dd if&#x3D;&#x2F;dev&#x2F;hda of&#x3D;&#x2F;dev&#x2F;fd0 bs&#x3D;512 count&#x3D;1</td><td>åšä¸€ä¸ªå°† MBRï¼ˆMaster Boot Recordï¼‰å†…å®¹å¤åˆ¶åˆ°è½¯ç›˜çš„åŠ¨ä½œ</td></tr><tr><td>dd if&#x3D;&#x2F;dev&#x2F;fd0 of&#x3D;&#x2F;dev&#x2F;hda bs&#x3D;512 count&#x3D;1</td><td>ä»å·²ç»ä¿å­˜åˆ°è½¯ç›˜çš„å¤‡ä»½ä¸­æ¢å¤ MBR å†…å®¹</td></tr></tbody></table><h2 id="16-å…‰ç›˜"><a href="#16-å…‰ç›˜" class="headerlink" title="16. å…‰ç›˜"></a>16. å…‰ç›˜</h2><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>cdrecord -v gracetime&#x3D;2 dev&#x3D;&#x2F;dev&#x2F;cdrom -eject blank&#x3D;fast -force</td><td>æ¸…ç©ºä¸€ä¸ªå¯å¤å†™çš„å…‰ç›˜å†…å®¹</td></tr><tr><td>mkisofs &#x2F;dev&#x2F;cdrom &gt; cd.iso</td><td>åœ¨ç£ç›˜ä¸Šåˆ›å»ºä¸€ä¸ªå…‰ç›˜çš„ ISO é•œåƒæ–‡ä»¶</td></tr><tr><td>mkisofs &#x2F;dev&#x2F;cdrom | gzip &gt; cd_iso.gz</td><td>åœ¨ç£ç›˜ä¸Šåˆ›å»ºä¸€ä¸ªå‹ç¼©äº†çš„å…‰ç›˜ ISO é•œåƒæ–‡ä»¶</td></tr><tr><td>mkisofs -J -allow-leading-dots -R -V â€œLabel CDâ€ -iso-level 4 -o .&#x2F;cd.iso data_cd</td><td>åˆ›å»ºä¸€ä¸ªç›®å½•çš„ ISO é•œåƒæ–‡ä»¶</td></tr><tr><td>cdrecord -v dev&#x3D;&#x2F;dev&#x2F;cdrom cd.iso</td><td>åˆ»å½•ä¸€ä¸ª ISO é•œåƒæ–‡ä»¶</td></tr><tr><td>gzip -dc cd_iso.gz | cdrecord dev&#x3D;&#x2F;dev&#x2F;cdrom</td><td>åˆ»å½•ä¸€ä¸ªå‹ç¼©äº†çš„ ISO é•œåƒæ–‡ä»¶</td></tr><tr><td>mount -o loop cd.iso &#x2F;mnt&#x2F;iso</td><td>æŒ‚è½½ä¸€ä¸ª ISO é•œåƒæ–‡ä»¶</td></tr><tr><td>cd-paranoia -B</td><td>ä»ä¸€ä¸ª CD å…‰ç›˜è½¬å½•éŸ³è½¨åˆ° wav æ–‡ä»¶ä¸­</td></tr><tr><td>cd-paranoia â€“ â€œ-3â€</td><td>ä»ä¸€ä¸ª CD å…‰ç›˜è½¬å½•éŸ³è½¨åˆ° wav æ–‡ä»¶ä¸­ï¼ˆå‚æ•°-3ï¼‰</td></tr><tr><td>cdrecord â€“scanbus</td><td>æ‰«ææ€»çº¿ä»¥è¯†åˆ« scsi é€šé“</td></tr><tr><td>dd if&#x3D;&#x2F;dev&#x2F;hdc | md5sum</td><td>æ ¡éªŒä¸€ä¸ªè®¾å¤‡çš„ md5sum ç¼–ç ï¼Œä¾‹å¦‚ä¸€å¼  CD</td></tr></tbody></table><h2 id="17-ç½‘ç»œ-ï¼ˆä»¥å¤ªç½‘å’Œ-WIFI-æ— çº¿ï¼‰"><a href="#17-ç½‘ç»œ-ï¼ˆä»¥å¤ªç½‘å’Œ-WIFI-æ— çº¿ï¼‰" class="headerlink" title="17. ç½‘ç»œ - ï¼ˆä»¥å¤ªç½‘å’Œ WIFI æ— çº¿ï¼‰"></a>17. ç½‘ç»œ - ï¼ˆä»¥å¤ªç½‘å’Œ WIFI æ— çº¿ï¼‰</h2><table><thead><tr><th>å‘½ä»¤</th><th>æè¿°</th></tr></thead><tbody><tr><td>ifconfig eth0</td><td>æ˜¾ç¤ºä¸€ä¸ªä»¥å¤ªç½‘å¡çš„é…ç½®</td></tr><tr><td>ifup eth0</td><td>å¯ç”¨ä¸€ä¸ª â€˜eth0â€™ ç½‘ç»œè®¾å¤‡</td></tr><tr><td>ifdown eth0</td><td>ç¦ç”¨ä¸€ä¸ª â€˜eth0â€™ ç½‘ç»œè®¾å¤‡</td></tr><tr><td>ifconfig eth0 192.168.1.1 netmask 255.255.255.0</td><td>æ§åˆ¶ IP åœ°å€</td></tr><tr><td>ifconfig eth0 promisc</td><td>è®¾ç½® â€˜eth0â€™ æˆæ··æ‚æ¨¡å¼ä»¥å—…æ¢æ•°æ®åŒ…ï¼ˆsniffingï¼‰</td></tr><tr><td>dhclient eth0</td><td>ä»¥ dhcp æ¨¡å¼å¯ç”¨ â€˜eth0â€™</td></tr><tr><td>route -n show</td><td>æ˜¾ç¤ºè·¯ç”±</td></tr><tr><td>route add -net 0&#x2F;0 gw 192.168.1.1</td><td>é…ç½®é»˜è®¤ç½‘å…³</td></tr><tr><td>route add -net 192.168.0.0 netmask 255.255.0.0 gw 192.168.1.1</td><td>é…ç½®é™æ€è·¯ç”±ä¸º â€˜192.168.0.0&#x2F;16â€™</td></tr><tr><td>route del 0&#x2F;0 gw 192.168.1.1</td><td>åˆ é™¤é™æ€è·¯ç”±</td></tr><tr><td>echo â€œ1â€ &gt; &#x2F;proc&#x2F;sys&#x2F;net&#x2F;ipv4&#x2F;ip_forward</td><td>æ¿€æ´» IP è·¯ç”±</td></tr><tr><td>hostname</td><td>æ˜¾ç¤ºç³»ç»Ÿä¸»æœºå</td></tr><tr><td>host <a href="http://www.example.com/">www.example.com</a></td><td>æŸ¥æ‰¾ä¸»æœºåä»¥å°†åç§°è§£æä¸º IP åœ°å€ï¼Œåä¹‹äº¦ç„¶</td></tr><tr><td>nslookup <a href="http://www.example.com/">www.example.com</a></td><td>æŸ¥æ‰¾ä¸»æœºåä»¥å°†åç§°è§£æä¸º IP åœ°å€ï¼Œåä¹‹äº¦ç„¶</td></tr><tr><td>ip link show</td><td>æ˜¾ç¤ºæ‰€æœ‰æ¥å£çš„é“¾æ¥çŠ¶æ€</td></tr><tr><td>mii-tool eth0</td><td>æ˜¾ç¤º â€˜eth0â€™ çš„é“¾æ¥çŠ¶æ€</td></tr><tr><td>ethtool eth0</td><td>æ˜¾ç¤ºç½‘å¡ â€˜eth0â€™ çš„ç»Ÿè®¡ä¿¡æ¯</td></tr><tr><td>netstat -tup</td><td>æ˜¾ç¤ºæ‰€æœ‰æ´»åŠ¨çš„ç½‘ç»œè¿æ¥åŠå…¶ PID</td></tr><tr><td>netstat -tupl</td><td>æ˜¾ç¤ºæ‰€æœ‰æ­£åœ¨ä¾¦å¬ç³»ç»Ÿçš„ç½‘ç»œæœåŠ¡åŠå…¶ PID</td></tr><tr><td>tcpdump tcp port 80</td><td>æ˜¾ç¤ºæ‰€æœ‰ HTTP æµé‡</td></tr><tr><td>iwlist scan</td><td>æ˜¾ç¤ºæ— çº¿ç½‘ç»œ</td></tr><tr><td>iwconfig eth1</td><td>æ˜¾ç¤ºæ— çº¿ç½‘å¡çš„é…ç½®</td></tr><tr><td>whois <a href="http://www.example.com/">www.example.com</a></td><td>åœ¨ Whois æ•°æ®åº“ä¸ŠæŸ¥æ‰¾</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexoç›¸å…³æ“ä½œ</title>
      <link href="/2022/12/20/hexo%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C/"/>
      <url>/2022/12/20/hexo%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸»é¢˜é…ç½®åœ°å€ï¼šhttps-butterfly-js-org"><a href="#ä¸»é¢˜é…ç½®åœ°å€ï¼šhttps-butterfly-js-org" class="headerlink" title="ä¸»é¢˜é…ç½®åœ°å€ï¼šhttps://butterfly.js.org/"></a>ä¸»é¢˜é…ç½®åœ°å€ï¼š<a href="https://butterfly.js.org/">https://butterfly.js.org/</a></h2><h2 id="hexo-ç›¸å…³å‘½ä»¤æ“ä½œ"><a href="#hexo-ç›¸å…³å‘½ä»¤æ“ä½œ" class="headerlink" title="hexo ç›¸å…³å‘½ä»¤æ“ä½œ"></a>hexo ç›¸å…³å‘½ä»¤æ“ä½œ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºåšå®¢</span></span><br><span class="line">hexo new <span class="string">&quot;æ–°çš„åšå®¢&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…é™¤æœ¬åœ°é¡¹ç›®å¹¶é‡æ–°ç”Ÿæˆ ï¼ˆé‡æ–°éƒ¨ç½²æ—¶ä½¿ç”¨ï¼‰</span></span><br><span class="line">hexo clean &amp;&amp; hexo g</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡æ–°ç”Ÿæˆ</span></span><br><span class="line">hexo g</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å¯æœ¬åœ°é¢„è§ˆ</span></span><br><span class="line">hexo s</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€åˆ°github</span></span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä»£ç æ¨¡æ¿</title>
      <link href="/2022/12/20/%E4%BB%A3%E7%A0%81%E6%A8%A1%E6%9D%BF/"/>
      <url>/2022/12/20/%E4%BB%A3%E7%A0%81%E6%A8%A1%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[<h1 id="å›½åº†è®­ç»ƒè¥"><a href="#å›½åº†è®­ç»ƒè¥" class="headerlink" title="å›½åº†è®­ç»ƒè¥"></a>å›½åº†è®­ç»ƒè¥</h1><h2 id="æ ¸å¿ƒç†å¿µï¼šå…ˆåšè®¾è®¡ï¼Œå†å†™ä»£ç "><a href="#æ ¸å¿ƒç†å¿µï¼šå…ˆåšè®¾è®¡ï¼Œå†å†™ä»£ç " class="headerlink" title="æ ¸å¿ƒç†å¿µï¼šå…ˆåšè®¾è®¡ï¼Œå†å†™ä»£ç "></a>æ ¸å¿ƒç†å¿µï¼šå…ˆåšè®¾è®¡ï¼Œå†å†™ä»£ç </h2><h3 id="1-ç‚¹èµåŠŸèƒ½"><a href="#1-ç‚¹èµåŠŸèƒ½" class="headerlink" title="1. ç‚¹èµåŠŸèƒ½"></a>1. ç‚¹èµåŠŸèƒ½</h3><h4 id="1-1éœ€æ±‚åˆ†æ"><a href="#1-1éœ€æ±‚åˆ†æ" class="headerlink" title="1.1éœ€æ±‚åˆ†æ"></a>1.1éœ€æ±‚åˆ†æ</h4><ol><li>ç”¨æˆ·å¯ä»¥å¯¹å¸–å­ç‚¹èµã€å–æ¶ˆç‚¹èµ</li><li>ç”¨æˆ·å¯¹å•ä¸ªå¸–å­åªèƒ½ç‚¹èµä¸€æ¬¡</li></ol><h4 id="1-2æ–¹æ¡ˆè®¾è®¡ï¼š"><a href="#1-2æ–¹æ¡ˆè®¾è®¡ï¼š" class="headerlink" title="1.2æ–¹æ¡ˆè®¾è®¡ï¼š"></a>1.2æ–¹æ¡ˆè®¾è®¡ï¼š</h4><p>ä¸ºä»€ä¹ˆè¦å†™ï¼Ÿ</p><ol><li>ä¾¿äºå¼€å‘</li><li>è‡ªå·±æ€»ç»“</li><li>æ˜ç¡®ä¾èµ–ï¼Œé˜²æ­¢æŠµèµ–</li><li>æ›´å¥½åœ°æ²‰æ·€ã€ç»™ä»–äººç»™å›¢é˜Ÿåšå‚è€ƒ</li></ol><p>åç«¯ä¸šåŠ¡æµç¨‹</p><ol><li><p>è¾“å…¥ï¼šæ¥å—è¯·æ±‚å‚æ•°ï¼Œå¸–å­id(è‚¯å®šä¸èƒ½ä¼ é€’userldå’Œç‚¹èµçŠ¶æ€)</p></li><li><p>å‚æ•°æ ¡éªŒ<br>a.ä¸šåŠ¡ä¸ç›¸å…³ï¼šè¯·æ±‚å‚æ•°æ˜¯å¦ä¸ºnullã€idä¸èƒ½å°äºç­‰äº0<br>b.ä¸šåŠ¡ç›¸å…³çš„æ ¡éªŒï¼šå¸–å­æ˜¯å¦å­˜åœ¨ï¼Œå¸–å­çš„çŠ¶æ€è¦æ˜¯å…è®¸ç‚¹èµçš„ï¼ˆæ¯”å¦‚å¿…é¡»å®¡æ ¸é€šè¿‡ï¼‰</p></li><li><p>æƒé™æ ¡éªŒ<br>a.åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•ï¼Œè·å–å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯(userld)</p></li><li><p>æ‰§è¡Œæ“ä½œ<br>a.åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å·²ç‚¹èµï¼Œæ ¹æ®userldå’ŒpostldæŸ¥è¯¢post thumbè¡¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™è¡¨ç¤ºå·²ç‚¹èµï¼Œå¦åˆ™æœªç‚¹èµ<br>b,å¦‚æœå·²ç‚¹èµï¼Œæ‰§è¡Œã€å–æ¶ˆç‚¹èµã€‘æ“ä½œï¼š</p><p>â€‹i.ä»post thumbè¡¨åˆ é™¤æ•°æ®(userldã€postld)<br>â€‹ii.postå¸–å­è¡¨çš„ç‚¹èµæ•°é‡-1<br>c.å¦‚æœæœªç‚¹èµï¼Œæ‰§è¡Œã€ç‚¹èµã€‘æ“ä½œ<br>â€‹i.å‘post thumbè¡¨æ’å…¥æ–°æ•°æ®(userldã€postld)<br>â€‹ii.postå¸–å­è¡¨çš„ç‚¹èµæ•°é‡+1<br>d.ä½¿ç”¨äº‹åŠ¡æ¥ç®¡ç†æ‰€æœ‰çš„æ“ä½œ</p></li><li><p>è¿”å›ä¸€ä¸ªèƒ½åŒºåˆ†æ˜¯ç‚¹èµæˆåŠŸè¿˜æ˜¯å–æ¶ˆç‚¹èµæˆåŠŸçš„å€¼</p></li><li><p>é€šè¿‡åŠ é”çš„æ–¹å¼ä¿è¯å¹‚ç­‰æ€§</p></li></ol><p>å®‰å…¨æ€§ï¼ˆæƒé™ã€é™åˆ¶é¢‘ç‡ï¼‰ã€å¹‚ç­‰æ€§ï¼ˆç”¨æˆ·ä¸èƒ½é‡å¤ç‚¹èµï¼‰ã€æ€§èƒ½ï¼ˆæ¯”å¦‚æ¥å£å“åº”æ—¶é•¿ï¼Œå¯ä»¥ç”¨Rds)ã€å­˜å‚¨(ç¡¬åˆ é™¤)</p><p>å‰ç«¯ä¸šåŠ¡æµç¨‹ï¼š</p><ol><li>è¯·æ±‚åç«¯æ¥å£</li><li>æ ¹æ®åç«¯è¿”å›çš„æ•°æ®æ”¹å˜å›¾æ ‡å’Œå¸–å­ç‚¹èµæ•°</li></ol><p>é«˜æ€§èƒ½æ ¡éªŒåŸåˆ™ï¼šä¼˜å…ˆæ ¡éªŒä¸éœ€è¦æŸ¥æ•°æ®åº“ã€æ“ä½œç¬¬ä¸‰æ–¹èµ„æºçš„</p><h4 id="1-3ä¼˜åŒ–é¡¹ç›®ï¼š"><a href="#1-3ä¼˜åŒ–é¡¹ç›®ï¼š" class="headerlink" title="1.3ä¼˜åŒ–é¡¹ç›®ï¼š"></a>1.3ä¼˜åŒ–é¡¹ç›®ï¼š</h4><p><a href="https://bcdh.yuque.com/books/share/2dd2567c-a826-4d9d-9303-bd288269e874/pbztbr">é±¼çš®ç¼–ç¨‹å¯¼èˆªæ˜ŸçƒçŸ¥è¯†åº“é¡¹ç›®ä¼˜åŒ–</a></p><h2 id="æ ‡å‡†å¸¸ç”¨åŒ…ç»“æ„"><a href="#æ ‡å‡†å¸¸ç”¨åŒ…ç»“æ„" class="headerlink" title="æ ‡å‡†å¸¸ç”¨åŒ…ç»“æ„"></a>æ ‡å‡†å¸¸ç”¨åŒ…ç»“æ„</h2><h3 id="1-é¡¹ç›®åŒ…ç»“æ„"><a href="#1-é¡¹ç›®åŒ…ç»“æ„" class="headerlink" title="1.é¡¹ç›®åŒ…ç»“æ„"></a>1.é¡¹ç›®åŒ…ç»“æ„</h3><p>annotationåŒ…ï¼š</p><ul><li>AuthCheck: æƒé™æ ¡éªŒ</li></ul><p>aopåŒ…ï¼š</p><ul><li>AuthInterceptorï¼Œæƒé™æ ¡éªŒaop</li><li>LogInterceptorï¼Œè¯·æ±‚å“åº”æ—¥å¿— AOP</li></ul><p>commonåŒ…ï¼š</p><ul><li>BaseResponseï¼Œé€šç”¨è¿”å›ç±»</li><li>ErrorCodeï¼Œå°è£…é”™è¯¯çŠ¶æ€ç </li><li>ResultUtilsï¼Œå°è£…è¿”å›å·¥å…·ç±»</li><li>DeleteRequestï¼Œå°è£…åˆ é™¤è¯·æ±‚çš„è¯·æ±‚å‚æ•°</li><li>PageRequestï¼Œå°è£…åˆ†é¡µè¯·æ±‚çš„è¯·æ±‚å‚æ•°</li></ul><p>configåŒ…ï¼š</p><ul><li>CorsConfigï¼Œå…¨å±€è·¨åŸŸé…ç½®</li><li>Knife4jConfigï¼Œæ¥å£æ–‡æ¡£é…ç½®</li><li>MyBatisPlusConfigï¼ŒMyBatis-Plus é…ç½®</li></ul><p>constantåŒ…ï¼š</p><ul><li>CommonConstantï¼Œé€šç”¨å¸¸é‡</li><li>UserConstantï¼Œç”¨æˆ·å¸¸é‡</li></ul><p>exceptionåŒ…ï¼š</p><ul><li>BusinessExceptionï¼Œè‡ªå®šä¹‰å¼‚å¸¸ç±»</li><li>GlobalExceptionHandlerï¼Œå…¨å±€å¼‚å¸¸å¤„ç†å™¨</li></ul><p>jobåŒ…ï¼šå®šæœŸä»»åŠ¡</p><ul><li>SyncTagPostNumJobï¼Œå®šæœŸåŒæ­¥æ¯ä¸ªæ ‡ç­¾çš„å¸–å­æ•°é‡</li></ul><p>utilsåŒ…ï¼š</p><ul><li>NetUtilsï¼Œç½‘ç»œå·¥å…·ç±»</li></ul><p>controlleråŒ…ï¼š</p><ul><li>ä¸»è¦ç”¨æ¥å†™å‰åç«¯äº¤äº’çš„æ¥å£</li></ul><p>serviceåŒ…ï¼š</p><ul><li>ä¸»è¦ç”¨æ¥å†™ä¸šåŠ¡é€»è¾‘</li><li>implï¼Œå®ç°ç±»</li><li>listenerï¼Œç›‘å¬å™¨</li></ul><h3 id="2-commonsåŒ…"><a href="#2-commonsåŒ…" class="headerlink" title="2.commonsåŒ…"></a>2.commonsåŒ…</h3><h4 id="2-1BaseResponseé€šç”¨è¿”å›ç±»"><a href="#2-1BaseResponseé€šç”¨è¿”å›ç±»" class="headerlink" title="2.1BaseResponseé€šç”¨è¿”å›ç±»"></a>2.1BaseResponseé€šç”¨è¿”å›ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.common;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é€šç”¨è¿”å›ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BaseResponse</span>&lt;T&gt; <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> code;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> T data;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BaseResponse</span><span class="params">(<span class="type">int</span> code, T data, String message)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">        <span class="built_in">this</span>.data = data;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BaseResponse</span><span class="params">(<span class="type">int</span> code, T data)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(code, data, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BaseResponse</span><span class="params">(ErrorCode errorCode)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>(errorCode.getCode(), <span class="literal">null</span>, errorCode.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="2-2ErrorCodeï¼Œå°è£…é”™è¯¯çŠ¶æ€ç "><a href="#2-2ErrorCodeï¼Œå°è£…é”™è¯¯çŠ¶æ€ç " class="headerlink" title="2.2ErrorCodeï¼Œå°è£…é”™è¯¯çŠ¶æ€ç "></a>2.2ErrorCodeï¼Œå°è£…é”™è¯¯çŠ¶æ€ç </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.common;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * é”™è¯¯ç </span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">ErrorCode</span> &#123;</span><br><span class="line"></span><br><span class="line">    SUCCESS(<span class="number">0</span>, <span class="string">&quot;ok&quot;</span>),</span><br><span class="line">    PARAMS_ERROR(<span class="number">40000</span>, <span class="string">&quot;è¯·æ±‚å‚æ•°é”™è¯¯&quot;</span>),</span><br><span class="line">    NOT_LOGIN_ERROR(<span class="number">40100</span>, <span class="string">&quot;æœªç™»å½•&quot;</span>),</span><br><span class="line">    NO_AUTH_ERROR(<span class="number">40101</span>, <span class="string">&quot;æ— æƒé™&quot;</span>),</span><br><span class="line">    NOT_FOUND_ERROR(<span class="number">40400</span>, <span class="string">&quot;è¯·æ±‚æ•°æ®ä¸å­˜åœ¨&quot;</span>),</span><br><span class="line">    FORBIDDEN_ERROR(<span class="number">40300</span>, <span class="string">&quot;ç¦æ­¢è®¿é—®&quot;</span>),</span><br><span class="line">    SYSTEM_ERROR(<span class="number">50000</span>, <span class="string">&quot;ç³»ç»Ÿå†…éƒ¨å¼‚å¸¸&quot;</span>),</span><br><span class="line">    OPERATION_ERROR(<span class="number">50001</span>, <span class="string">&quot;æ“ä½œå¤±è´¥&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çŠ¶æ€ç </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> code;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String message;</span><br><span class="line"></span><br><span class="line">    ErrorCode(<span class="type">int</span> code, String message) &#123;</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMessage</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="2-3ResultUtilsï¼Œå°è£…è¿”å›å·¥å…·ç±»"><a href="#2-3ResultUtilsï¼Œå°è£…è¿”å›å·¥å…·ç±»" class="headerlink" title="2.3ResultUtilsï¼Œå°è£…è¿”å›å·¥å…·ç±»"></a>2.3ResultUtilsï¼Œå°è£…è¿”å›å·¥å…·ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.common;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¿”å›å·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResultUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æˆåŠŸ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; BaseResponse&lt;T&gt; <span class="title function_">success</span><span class="params">(T data)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BaseResponse</span>&lt;&gt;(<span class="number">0</span>, data, <span class="string">&quot;ok&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤±è´¥</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> errorCode</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> BaseResponse <span class="title function_">error</span><span class="params">(ErrorCode errorCode)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BaseResponse</span>&lt;&gt;(errorCode);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤±è´¥</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> code</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> BaseResponse <span class="title function_">error</span><span class="params">(<span class="type">int</span> code, String message)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BaseResponse</span>(code, <span class="literal">null</span>, message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤±è´¥</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> errorCode</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> BaseResponse <span class="title function_">error</span><span class="params">(ErrorCode errorCode, String message)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">BaseResponse</span>(errorCode.getCode(), <span class="literal">null</span>, message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-constantåŒ…"><a href="#3-constantåŒ…" class="headerlink" title="3.constantåŒ…"></a>3.constantåŒ…</h3><h4 id="3-1CommonConstanté€šç”¨å¸¸é‡"><a href="#3-1CommonConstanté€šç”¨å¸¸é‡" class="headerlink" title="3.1CommonConstanté€šç”¨å¸¸é‡"></a>3.1CommonConstanté€šç”¨å¸¸é‡</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.constant;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·å¸¸é‡</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CommonConstant</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‡åº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">SORT_ORDER_ASC</span> <span class="operator">=</span> <span class="string">&quot;ascend&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é™åº</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">SORT_ORDER_DESC</span> <span class="operator">=</span> <span class="string">&quot; descend&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="3-2UserConstanté€šç”¨æˆ·å¸¸é‡"><a href="#3-2UserConstanté€šç”¨æˆ·å¸¸é‡" class="headerlink" title="3.2UserConstanté€šç”¨æˆ·å¸¸é‡"></a>3.2UserConstanté€šç”¨æˆ·å¸¸é‡</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.constant;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·å¸¸é‡</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserConstant</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·ç™»å½•æ€é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">USER_LOGIN_STATE</span> <span class="operator">=</span> <span class="string">&quot;userLoginState&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç³»ç»Ÿç”¨æˆ· idï¼ˆè™šæ‹Ÿç”¨æˆ·ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">long</span> <span class="variable">SYSTEM_USER_ID</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//  region æƒé™</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é»˜è®¤æƒé™</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">DEFAULT_ROLE</span> <span class="operator">=</span> <span class="string">&quot;user&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç®¡ç†å‘˜æƒé™</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">ADMIN_ROLE</span> <span class="operator">=</span> <span class="string">&quot;admin&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// endregion</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="4-exceptionåŒ…"><a href="#4-exceptionåŒ…" class="headerlink" title="4.exceptionåŒ…"></a>4.exceptionåŒ…</h3><h4 id="4-1BusinessExceptionè‡ªå®šä¹‰å¼‚å¸¸ç±»"><a href="#4-1BusinessExceptionè‡ªå®šä¹‰å¼‚å¸¸ç±»" class="headerlink" title="4.1BusinessExceptionè‡ªå®šä¹‰å¼‚å¸¸ç±»"></a>4.1BusinessExceptionè‡ªå®šä¹‰å¼‚å¸¸ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.exception;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ErrorCode;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰å¼‚å¸¸ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BusinessException</span> <span class="keyword">extends</span> <span class="title class_">RuntimeException</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> code;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BusinessException</span><span class="params">(<span class="type">int</span> code, String message)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(message);</span><br><span class="line">        <span class="built_in">this</span>.code = code;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BusinessException</span><span class="params">(ErrorCode errorCode)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(errorCode.getMessage());</span><br><span class="line">        <span class="built_in">this</span>.code = errorCode.getCode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BusinessException</span><span class="params">(ErrorCode errorCode, String message)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(message);</span><br><span class="line">        <span class="built_in">this</span>.code = errorCode.getCode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> code;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="4-2GlobalExceptionHandlerå…¨å±€å¼‚å¸¸å¤„ç†å™¨"><a href="#4-2GlobalExceptionHandlerå…¨å±€å¼‚å¸¸å¤„ç†å™¨" class="headerlink" title="4.2GlobalExceptionHandlerå…¨å±€å¼‚å¸¸å¤„ç†å™¨"></a>4.2GlobalExceptionHandlerå…¨å±€å¼‚å¸¸å¤„ç†å™¨</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.exception;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.BaseResponse;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ErrorCode;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ResultUtils;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestControllerAdvice;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…¨å±€å¼‚å¸¸å¤„ç†å™¨</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestControllerAdvice</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler(BusinessException.class)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;?&gt; businessExceptionHandler(BusinessException e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;businessException: &quot;</span> + e.getMessage(), e);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.error(e.getCode(), e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler(RuntimeException.class)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;?&gt; runtimeExceptionHandler(RuntimeException e) &#123;</span><br><span class="line">        log.error(<span class="string">&quot;runtimeException&quot;</span>, e);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.error(ErrorCode.SYSTEM_ERROR, e.getMessage());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="5-aop-åŒ…"><a href="#5-aop-åŒ…" class="headerlink" title="5.aop åŒ…"></a>5.aop åŒ…</h3><h4 id="5-1AuthInterceptoræƒé™æ ¡éªŒ-AOP"><a href="#5-1AuthInterceptoræƒé™æ ¡éªŒ-AOP" class="headerlink" title="5.1AuthInterceptoræƒé™æ ¡éªŒ AOP"></a>5.1AuthInterceptoræƒé™æ ¡éªŒ AOP</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.aop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.toolkit.CollectionUtils;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.annotation.AuthCheck;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ErrorCode;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.exception.BusinessException;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.User;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.UserService;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.request.RequestAttributes;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.request.RequestContextHolder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.request.ServletRequestAttributes;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æƒé™æ ¡éªŒ AOP</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰§è¡Œæ‹¦æˆª</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> joinPoint</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> authCheck</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Around(&quot;@annotation(authCheck)&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">doInterceptor</span><span class="params">(ProceedingJoinPoint joinPoint, AuthCheck authCheck)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        List&lt;String&gt; anyRole = Arrays.stream(authCheck.anyRole()).filter(StringUtils::isNotBlank).collect(Collectors.toList());</span><br><span class="line">        <span class="type">String</span> <span class="variable">mustRole</span> <span class="operator">=</span> authCheck.mustRole();</span><br><span class="line">        <span class="type">RequestAttributes</span> <span class="variable">requestAttributes</span> <span class="operator">=</span> RequestContextHolder.currentRequestAttributes();</span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> ((ServletRequestAttributes) requestAttributes).getRequest();</span><br><span class="line">        <span class="comment">// å½“å‰ç™»å½•ç”¨æˆ·</span></span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.getLoginUser(request);</span><br><span class="line">        <span class="comment">// æ‹¥æœ‰ä»»æ„æƒé™å³é€šè¿‡</span></span><br><span class="line">        <span class="keyword">if</span> (CollectionUtils.isNotEmpty(anyRole)) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">userRole</span> <span class="operator">=</span> user.getUserRole();</span><br><span class="line">            <span class="keyword">if</span> (!anyRole.contains(userRole)) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.NO_AUTH_ERROR);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¿…é¡»æœ‰æ‰€æœ‰æƒé™æ‰é€šè¿‡</span></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(mustRole)) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">userRole</span> <span class="operator">=</span> user.getUserRole();</span><br><span class="line">            <span class="keyword">if</span> (!mustRole.equals(userRole)) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.NO_AUTH_ERROR);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// é€šè¿‡æƒé™æ ¡éªŒï¼Œæ”¾è¡Œ</span></span><br><span class="line">        <span class="keyword">return</span> joinPoint.proceed();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="5-2LogInterceptorè¯·æ±‚å“åº”æ‹¦æˆªå’Œæ—¥å¿—-AOP"><a href="#5-2LogInterceptorè¯·æ±‚å“åº”æ‹¦æˆªå’Œæ—¥å¿—-AOP" class="headerlink" title="5.2LogInterceptorè¯·æ±‚å“åº”æ‹¦æˆªå’Œæ—¥å¿— AOP"></a>5.2LogInterceptorè¯·æ±‚å“åº”æ‹¦æˆªå’Œæ—¥å¿— AOP</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.aop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.ProceedingJoinPoint;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Around;</span><br><span class="line"><span class="keyword">import</span> org.aspectj.lang.annotation.Aspect;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StopWatch;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.request.RequestAttributes;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.request.RequestContextHolder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.context.request.ServletRequestAttributes;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¯·æ±‚å“åº”æ—¥å¿— AOP</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LogInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰§è¡Œæ‹¦æˆª</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Around(&quot;execution(* com.yupi.lovefinder.controller.*.*(..))&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">doInterceptor</span><span class="params">(ProceedingJoinPoint point)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        <span class="comment">// è®¡æ—¶</span></span><br><span class="line">        <span class="type">StopWatch</span> <span class="variable">stopWatch</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StopWatch</span>();</span><br><span class="line">        stopWatch.start();</span><br><span class="line">        <span class="comment">// è·å–è¯·æ±‚è·¯å¾„</span></span><br><span class="line">        <span class="type">RequestAttributes</span> <span class="variable">requestAttributes</span> <span class="operator">=</span> RequestContextHolder.currentRequestAttributes();</span><br><span class="line">        <span class="type">HttpServletRequest</span> <span class="variable">httpServletRequest</span> <span class="operator">=</span> ((ServletRequestAttributes) requestAttributes).getRequest();</span><br><span class="line">        <span class="comment">// ç”Ÿæˆè¯·æ±‚å”¯ä¸€ id</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">requestId</span> <span class="operator">=</span> UUID.randomUUID().toString();</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> httpServletRequest.getRequestURI();</span><br><span class="line">        <span class="comment">// è·å–è¯·æ±‚å‚æ•°</span></span><br><span class="line">        Object[] args = point.getArgs();</span><br><span class="line">        <span class="type">String</span> <span class="variable">reqParam</span> <span class="operator">=</span> <span class="string">&quot;[&quot;</span> + StringUtils.join(args, <span class="string">&quot;, &quot;</span>) + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">        <span class="comment">// è¾“å‡ºè¯·æ±‚æ—¥å¿—</span></span><br><span class="line">        log.info(<span class="string">&quot;request startï¼Œid: &#123;&#125;, path: &#123;&#125;, ip: &#123;&#125;, params: &#123;&#125;&quot;</span>, requestId, url,</span><br><span class="line">                httpServletRequest.getRemoteHost(), reqParam);</span><br><span class="line">        <span class="comment">// æ‰§è¡ŒåŸæ–¹æ³•</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> point.proceed();</span><br><span class="line">        <span class="comment">// è¾“å‡ºå“åº”æ—¥å¿—</span></span><br><span class="line">        stopWatch.stop();</span><br><span class="line">        <span class="type">long</span> <span class="variable">totalTimeMillis</span> <span class="operator">=</span> stopWatch.getTotalTimeMillis();</span><br><span class="line">        log.info(<span class="string">&quot;request end, id: &#123;&#125;, cost: &#123;&#125;ms&quot;</span>, requestId, totalTimeMillis);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="6-annotationåŒ…"><a href="#6-annotationåŒ…" class="headerlink" title="6.annotationåŒ…"></a>6.annotationåŒ…</h3><h4 id="6-1AuthCheckæƒé™æ ¡éªŒ"><a href="#6-1AuthCheckæƒé™æ ¡éªŒ" class="headerlink" title="6.1AuthCheckæƒé™æ ¡éªŒ"></a>6.1AuthCheckæƒé™æ ¡éªŒ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.annotation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æƒé™æ ¡éªŒ</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Target(ElementType.METHOD)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> AuthCheck &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœ‰ä»»ä½•ä¸€ä¸ªè§’è‰²</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String[] anyRole() <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¿…é¡»æœ‰æŸä¸ªè§’è‰²</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">mustRole</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="7-utilsåŒ…"><a href="#7-utilsåŒ…" class="headerlink" title="7.utilsåŒ…"></a>7.utilsåŒ…</h3><h4 id="7-1NetUtilsç½‘ç»œå·¥å…·ç±»"><a href="#7-1NetUtilsç½‘ç»œå·¥å…·ç±»" class="headerlink" title="7.1NetUtilsç½‘ç»œå·¥å…·ç±»"></a>7.1NetUtilsç½‘ç»œå·¥å…·ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç½‘ç»œå·¥å…·ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NetUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å®¢æˆ·ç«¯ IP åœ°å€</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getIpAddress</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">ip</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;x-forwarded-for&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (ip == <span class="literal">null</span> || ip.length() == <span class="number">0</span> || <span class="string">&quot;unknown&quot;</span>.equalsIgnoreCase(ip)) &#123;</span><br><span class="line">            ip = request.getHeader(<span class="string">&quot;Proxy-Client-IP&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (ip == <span class="literal">null</span> || ip.length() == <span class="number">0</span> || <span class="string">&quot;unknown&quot;</span>.equalsIgnoreCase(ip)) &#123;</span><br><span class="line">            ip = request.getHeader(<span class="string">&quot;WL-Proxy-Client-IP&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (ip == <span class="literal">null</span> || ip.length() == <span class="number">0</span> || <span class="string">&quot;unknown&quot;</span>.equalsIgnoreCase(ip)) &#123;</span><br><span class="line">            ip = request.getRemoteAddr();</span><br><span class="line">            <span class="keyword">if</span> (ip.equals(<span class="string">&quot;127.0.0.1&quot;</span>)) &#123;</span><br><span class="line">                <span class="comment">// æ ¹æ®ç½‘å¡å–æœ¬æœºé…ç½®çš„ IP</span></span><br><span class="line">                <span class="type">InetAddress</span> <span class="variable">inet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    inet = InetAddress.getLocalHost();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (inet != <span class="literal">null</span>) &#123;</span><br><span class="line">                    ip = inet.getHostAddress();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¤šä¸ªä»£ç†çš„æƒ…å†µï¼Œç¬¬ä¸€ä¸ªIPä¸ºå®¢æˆ·ç«¯çœŸå®IP,å¤šä¸ªIPæŒ‰ç…§&#x27;,&#x27;åˆ†å‰²</span></span><br><span class="line">        <span class="keyword">if</span> (ip != <span class="literal">null</span> &amp;&amp; ip.length() &gt; <span class="number">15</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (ip.indexOf(<span class="string">&quot;,&quot;</span>) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                ip = ip.substring(<span class="number">0</span>, ip.indexOf(<span class="string">&quot;,&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (ip == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;127.0.0.1&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ip;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="8-configåŒ…"><a href="#8-configåŒ…" class="headerlink" title="8.configåŒ…"></a>8.configåŒ…</h3><h4 id="8-1CorsConfigå…¨å±€è·¨åŸŸé…ç½®"><a href="#8-1CorsConfigå…¨å±€è·¨åŸŸé…ç½®" class="headerlink" title="8.1CorsConfigå…¨å±€è·¨åŸŸé…ç½®"></a>8.1CorsConfigå…¨å±€è·¨åŸŸé…ç½®</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.CorsRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…¨å±€è·¨åŸŸé…ç½®</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CorsConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> &#123;</span><br><span class="line">        <span class="comment">// è¦†ç›–æ‰€æœ‰è¯·æ±‚</span></span><br><span class="line">        registry.addMapping(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">                <span class="comment">// å…è®¸å‘é€ Cookie</span></span><br><span class="line">                .allowCredentials(<span class="literal">true</span>)</span><br><span class="line">                <span class="comment">// æ”¾è¡Œå“ªäº›åŸŸåï¼ˆå¿…é¡»ç”¨ patternsï¼Œå¦åˆ™ * ä¼šå’Œ allowCredentials å†²çªï¼‰</span></span><br><span class="line">                .allowedOriginPatterns(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">                .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;DELETE&quot;</span>, <span class="string">&quot;OPTIONS&quot;</span>)</span><br><span class="line">                .allowedHeaders(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">                .exposedHeaders(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="8-2Knife4jConfigæ¥å£æ–‡æ¡£é…ç½®"><a href="#8-2Knife4jConfigæ¥å£æ–‡æ¡£é…ç½®" class="headerlink" title="8.2Knife4jConfigæ¥å£æ–‡æ¡£é…ç½®"></a>8.2Knife4jConfigæ¥å£æ–‡æ¡£é…ç½®</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Profile;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.ApiInfoBuilder;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.PathSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.builders.RequestHandlerSelectors;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spi.DocumentationType;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.spring.web.plugins.Docket;</span><br><span class="line"><span class="keyword">import</span> springfox.documentation.swagger2.annotations.EnableSwagger2;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Knife4j æ¥å£æ–‡æ¡£é…ç½®</span></span><br><span class="line"><span class="comment"> * https://doc.xiaominfo.com/knife4j/documentation/get_start.html</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span></span><br><span class="line"><span class="meta">@Profile(&quot;dev&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Knife4jConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Docket <span class="title function_">defaultApi2</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Docket</span>(DocumentationType.SWAGGER_2)</span><br><span class="line">                .apiInfo(<span class="keyword">new</span> <span class="title class_">ApiInfoBuilder</span>()</span><br><span class="line">                        .title(<span class="string">&quot;lovefinder-backend&quot;</span>)</span><br><span class="line">                        .description(<span class="string">&quot;lovefinder-backend&quot;</span>)</span><br><span class="line">                        .version(<span class="string">&quot;1.0&quot;</span>)</span><br><span class="line">                        .build())</span><br><span class="line">                .select()</span><br><span class="line">                <span class="comment">// æŒ‡å®š Controller æ‰«æåŒ…è·¯å¾„</span></span><br><span class="line">                .apis(RequestHandlerSelectors.basePackage(<span class="string">&quot;com.yupi.lovefinder.controller&quot;</span>))</span><br><span class="line">                .paths(PathSelectors.any())</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="8-3MyBatisPlusConfigï¼šMyBatis-Plus-é…ç½®-amp-æ‹¦æˆªå™¨é…ç½®"><a href="#8-3MyBatisPlusConfigï¼šMyBatis-Plus-é…ç½®-amp-æ‹¦æˆªå™¨é…ç½®" class="headerlink" title="8.3MyBatisPlusConfigï¼šMyBatis Plus é…ç½®&amp;æ‹¦æˆªå™¨é…ç½®"></a>8.3MyBatisPlusConfigï¼šMyBatis Plus é…ç½®&amp;æ‹¦æˆªå™¨é…ç½®</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.DbType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.annotation.MapperScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * MyBatis Plus é…ç½®</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.yupi.lovefinder.mapper&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyBatisPlusConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‹¦æˆªå™¨é…ç½®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">interceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        <span class="comment">// åˆ†é¡µæ’ä»¶</span></span><br><span class="line">        interceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>(DbType.MYSQL));</span><br><span class="line">        <span class="keyword">return</span> interceptor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-jobåŒ…"><a href="#9-jobåŒ…" class="headerlink" title="9.jobåŒ…"></a>9.jobåŒ…</h3><h4 id="9-1SyncTagPostNumJobå®šæœŸåŒæ­¥æ¯ä¸ªæ ‡ç­¾çš„å¸–å­æ•°é‡"><a href="#9-1SyncTagPostNumJobå®šæœŸåŒæ­¥æ¯ä¸ªæ ‡ç­¾çš„å¸–å­æ•°é‡" class="headerlink" title="9.1SyncTagPostNumJobå®šæœŸåŒæ­¥æ¯ä¸ªæ ‡ç­¾çš„å¸–å­æ•°é‡"></a>9.1SyncTagPostNumJobå®šæœŸåŒæ­¥æ¯ä¸ªæ ‡ç­¾çš„å¸–å­æ•°é‡</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.job;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.update.UpdateWrapper;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.Post;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.Tag;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.PostService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.TagService;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Map.Entry;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Scheduled;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å®šæœŸåŒæ­¥æ¯ä¸ªæ ‡ç­¾çš„å¸–å­æ•°é‡</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SyncTagPostNumJob</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> PostService postService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> TagService tagService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¯æ¬¡åŒæ­¥é—´éš” 30 åˆ†é’Ÿ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Scheduled(fixedDelay = 30 * 60 * 1000)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doStart</span><span class="params">()</span> &#123;</span><br><span class="line">        log.info(<span class="string">&quot;SyncTagPostNumJob start&quot;</span>);</span><br><span class="line">        <span class="comment">// å…¨é‡åŒæ­¥</span></span><br><span class="line">        List&lt;Post&gt; postList = postService.list();</span><br><span class="line">        <span class="comment">// æ–­è¨€ tagName ä¸èƒ½é‡å¤</span></span><br><span class="line">        Map&lt;String, Integer&gt; tagNameCountMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        postList.forEach(post -&gt; &#123;</span><br><span class="line">            inc(tagNameCountMap, post.getEducation());</span><br><span class="line">            inc(tagNameCountMap, post.getPlace());</span><br><span class="line">            inc(tagNameCountMap, post.getJob());</span><br><span class="line">            inc(tagNameCountMap, post.getLoveExp());</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">// æ›´æ–° tag</span></span><br><span class="line">        <span class="keyword">for</span> (Entry&lt;String, Integer&gt; tagNameCountEntry : tagNameCountMap.entrySet()) &#123;</span><br><span class="line">            UpdateWrapper&lt;Tag&gt; updateWrapper = <span class="keyword">new</span> <span class="title class_">UpdateWrapper</span>&lt;&gt;();</span><br><span class="line">            updateWrapper.eq(<span class="string">&quot;tagName&quot;</span>, tagNameCountEntry.getKey())</span><br><span class="line">                    .set(<span class="string">&quot;postNum&quot;</span>, tagNameCountEntry.getValue());</span><br><span class="line">            tagService.update(updateWrapper);</span><br><span class="line">        &#125;</span><br><span class="line">        log.info(<span class="string">&quot;SyncTagPostNumJob end&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å€¼ + 1</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> map</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">inc</span><span class="params">(Map&lt;String, Integer&gt; map, String key)</span> &#123;</span><br><span class="line">        map.put(key, map.getOrDefault(key, <span class="number">0</span>) + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="10-é…ç½®æ–‡ä»¶"><a href="#10-é…ç½®æ–‡ä»¶" class="headerlink" title="10.é…ç½®æ–‡ä»¶"></a>10.é…ç½®æ–‡ä»¶</h3><h4 id="10-1ymlé…ç½®æ–‡ä»¶"><a href="#10-1ymlé…ç½®æ–‡ä»¶" class="headerlink" title="10.1ymlé…ç½®æ–‡ä»¶"></a>10.1ymlé…ç½®æ–‡ä»¶</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">lovefinder-backend</span></span><br><span class="line">  <span class="comment"># é»˜è®¤ dev ç¯å¢ƒ</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br><span class="line">  <span class="comment"># æ”¯æŒ swagger3</span></span><br><span class="line">  <span class="attr">mvc:</span></span><br><span class="line">    <span class="attr">pathmatch:</span></span><br><span class="line">      <span class="attr">matching-strategy:</span> <span class="string">ant_path_matcher</span></span><br><span class="line">  <span class="attr">session:</span></span><br><span class="line">    <span class="attr">store-type:</span> <span class="string">none</span></span><br><span class="line">  <span class="comment"># æ•°æ®åº“é…ç½®</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/lovefinder?serverTimezone=GMT%2B8&amp;characterEncoding=utf-8&amp;useSSL=false</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">address:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8103</span></span><br><span class="line">  <span class="attr">servlet:</span></span><br><span class="line">    <span class="attr">context-path:</span> <span class="string">/api</span></span><br><span class="line">    <span class="comment"># session å¤±æ•ˆæ—¶é—´ 1 å¤©</span></span><br><span class="line">    <span class="attr">session:</span></span><br><span class="line">      <span class="attr">timeout:</span> <span class="number">86400</span></span><br><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="attr">logic-delete-field:</span> <span class="string">isDelete</span> <span class="comment"># å…¨å±€é€»è¾‘åˆ é™¤çš„å®ä½“å­—æ®µå</span></span><br><span class="line">      <span class="attr">logic-delete-value:</span> <span class="number">1</span> <span class="comment"># é€»è¾‘å·²åˆ é™¤å€¼ï¼ˆé»˜è®¤ä¸º 1ï¼‰</span></span><br><span class="line">      <span class="attr">logic-not-delete-value:</span> <span class="number">0</span> <span class="comment"># é€»è¾‘æœªåˆ é™¤å€¼ï¼ˆé»˜è®¤ä¸º 0ï¼‰</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="10-2æäº¤å¿½è§†æ–‡ä»¶"><a href="#10-2æäº¤å¿½è§†æ–‡ä»¶" class="headerlink" title="10.2æäº¤å¿½è§†æ–‡ä»¶"></a>10.2æäº¤å¿½è§†æ–‡ä»¶</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line">HELP.md</span><br><span class="line">target/</span><br><span class="line">!.mvn/wrapper/maven-wrapper.jar</span><br><span class="line">!**/src/main/**/target/</span><br><span class="line">!**/src/test/**/target/</span><br><span class="line"></span><br><span class="line">### Prod</span><br><span class="line">application-prod.yml</span><br><span class="line"></span><br><span class="line">### STS ###</span><br><span class="line">.apt_generated</span><br><span class="line">.classpath</span><br><span class="line">.factorypath</span><br><span class="line">.project</span><br><span class="line">.settings</span><br><span class="line">.springBeans</span><br><span class="line">.sts4-cache</span><br><span class="line"></span><br><span class="line">### IntelliJ IDEA ###</span><br><span class="line">.idea</span><br><span class="line">*.iws</span><br><span class="line">*.iml</span><br><span class="line">*.ipr</span><br><span class="line"></span><br><span class="line">### NetBeans ###</span><br><span class="line">/nbproject/private/</span><br><span class="line">/nbbuild/</span><br><span class="line">/dist/</span><br><span class="line">/nbdist/</span><br><span class="line">/.nb-gradle/</span><br><span class="line">build/</span><br><span class="line">!**/src/main/**/build/</span><br><span class="line">!**/src/test/**/build/</span><br><span class="line"></span><br><span class="line">### VS Code ###</span><br><span class="line">.vscode/</span><br><span class="line">### Java template</span><br><span class="line"># Compiled class file</span><br><span class="line">*.class</span><br><span class="line"></span><br><span class="line"># Log file</span><br><span class="line">*.log</span><br><span class="line"></span><br><span class="line"># BlueJ files</span><br><span class="line">*.ctxt</span><br><span class="line"></span><br><span class="line"># Mobile Tools for Java (J2ME)</span><br><span class="line">.mtj.tmp/</span><br><span class="line"></span><br><span class="line"># Package Files #</span><br><span class="line">*.jar</span><br><span class="line">*.war</span><br><span class="line">*.nar</span><br><span class="line">*.ear</span><br><span class="line">*.zip</span><br><span class="line">*.tar.gz</span><br><span class="line">*.rar</span><br><span class="line"></span><br><span class="line"># virtual machine crash logs, see http://www.java.com/en/download/help/error_hotspot.xml</span><br><span class="line">hs_err_pid*</span><br><span class="line"></span><br><span class="line">### Maven template</span><br><span class="line">target/</span><br><span class="line">pom.xml.tag</span><br><span class="line">pom.xml.releaseBackup</span><br><span class="line">pom.xml.versionsBackup</span><br><span class="line">pom.xml.next</span><br><span class="line">release.properties</span><br><span class="line">dependency-reduced-pom.xml</span><br><span class="line">buildNumber.properties</span><br><span class="line">.mvn/timing.properties</span><br><span class="line"># https://github.com/takari/maven-wrapper#usage-without-binary-jar</span><br><span class="line">.mvn/wrapper/maven-wrapper.jar</span><br><span class="line"></span><br><span class="line">### JetBrains template</span><br><span class="line"># Covers JetBrains IDEs: IntelliJ, RubyMine, PhpStorm, AppCode, PyCharm, CLion, Android Studio, WebStorm and Rider</span><br><span class="line"># Reference: https://intellij-support.jetbrains.com/hc/en-us/articles/206544839</span><br><span class="line"></span><br><span class="line"># User-specific stuff</span><br><span class="line">.idea/**/workspace.xml</span><br><span class="line">.idea/**/tasks.xml</span><br><span class="line">.idea/**/usage.statistics.xml</span><br><span class="line">.idea/**/dictionaries</span><br><span class="line">.idea/**/shelf</span><br><span class="line"></span><br><span class="line"># Generated files</span><br><span class="line">.idea/**/contentModel.xml</span><br><span class="line"></span><br><span class="line"># Sensitive or high-churn files</span><br><span class="line">.idea/**/dataSources/</span><br><span class="line">.idea/**/dataSources.ids</span><br><span class="line">.idea/**/dataSources.local.xml</span><br><span class="line">.idea/**/sqlDataSources.xml</span><br><span class="line">.idea/**/dynamic.xml</span><br><span class="line">.idea/**/uiDesigner.xml</span><br><span class="line">.idea/**/dbnavigator.xml</span><br><span class="line"></span><br><span class="line"># Gradle</span><br><span class="line">.idea/**/gradle.xml</span><br><span class="line">.idea/**/libraries</span><br><span class="line"></span><br><span class="line"># Gradle and Maven with auto-import</span><br><span class="line"># When using Gradle or Maven with auto-import, you should exclude module files,</span><br><span class="line"># since they will be recreated, and may cause churn.  Uncomment if using</span><br><span class="line"># auto-import.</span><br><span class="line"># .idea/artifacts</span><br><span class="line"># .idea/compiler.xml</span><br><span class="line"># .idea/jarRepositories.xml</span><br><span class="line"># .idea/modules.xml</span><br><span class="line"># .idea/*.iml</span><br><span class="line"># .idea/modules</span><br><span class="line"># *.iml</span><br><span class="line"># *.ipr</span><br><span class="line"></span><br><span class="line"># CMake</span><br><span class="line">cmake-build-*/</span><br><span class="line"></span><br><span class="line"># Mongo Explorer plugin</span><br><span class="line">.idea/**/mongoSettings.xml</span><br><span class="line"></span><br><span class="line"># File-based project format</span><br><span class="line">*.iws</span><br><span class="line"></span><br><span class="line"># IntelliJ</span><br><span class="line">out/</span><br><span class="line"></span><br><span class="line"># mpeltonen/sbt-idea plugin</span><br><span class="line">.idea_modules/</span><br><span class="line"></span><br><span class="line"># JIRA plugin</span><br><span class="line">atlassian-ide-plugin.xml</span><br><span class="line"></span><br><span class="line"># Cursive Clojure plugin</span><br><span class="line">.idea/replstate.xml</span><br><span class="line"></span><br><span class="line"># Crashlytics plugin (for Android Studio and IntelliJ)</span><br><span class="line">com_crashlytics_export_strings.xml</span><br><span class="line">crashlytics.properties</span><br><span class="line">crashlytics-build.properties</span><br><span class="line">fabric.properties</span><br><span class="line"></span><br><span class="line"># Editor-based Rest Client</span><br><span class="line">.idea/httpRequests</span><br><span class="line"></span><br><span class="line"># Android studio 3.1+ serialized cache file</span><br><span class="line">.idea/caches/build_file_checksums.ser</span><br></pre></td></tr></table></figure><h4 id="10-3Dockerfileå®¹å™¨æ–‡ä»¶"><a href="#10-3Dockerfileå®¹å™¨æ–‡ä»¶" class="headerlink" title="10.3Dockerfileå®¹å™¨æ–‡ä»¶"></a>10.3Dockerfileå®¹å™¨æ–‡ä»¶</h4><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> maven:<span class="number">3.8</span>.<span class="number">1</span>-jdk-<span class="number">8</span>-slim as builder</span><br><span class="line"></span><br><span class="line"><span class="comment"># Copy local code to the container image.</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> pom.xml .</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> src ./src</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Build a release artifact.</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> mvn package -DskipTests</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Run the web service on container startup.</span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;java&quot;</span>,<span class="string">&quot;-jar&quot;</span>,<span class="string">&quot;/app/target/lovefinder-backend-0.0.1-SNAPSHOT.jar&quot;</span>,<span class="string">&quot;--spring.profiles.active=prod&quot;</span>]</span></span><br></pre></td></tr></table></figure><h3 id="11-æ•°æ®åº“æ“ä½œ"><a href="#11-æ•°æ®åº“æ“ä½œ" class="headerlink" title="11.æ•°æ®åº“æ“ä½œ"></a>11.æ•°æ®åº“æ“ä½œ</h3><h4 id="11-1åº“è¡¨è®¾è®¡"><a href="#11-1åº“è¡¨è®¾è®¡" class="headerlink" title="11.1åº“è¡¨è®¾è®¡"></a>11.1åº“è¡¨è®¾è®¡</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºåº“</span></span><br><span class="line"><span class="keyword">create</span> database if <span class="keyword">not</span> <span class="keyword">exists</span> lovefinder;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- åˆ‡æ¢åº“</span></span><br><span class="line">use lovefinder;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ç”¨æˆ·è¡¨</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> <span class="keyword">user</span></span><br><span class="line">(</span><br><span class="line">    id           <span class="type">bigint</span> auto_increment comment <span class="string">&#x27;id&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    userName     <span class="type">varchar</span>(<span class="number">256</span>)                           <span class="keyword">null</span> comment <span class="string">&#x27;ç”¨æˆ·æ˜µç§°&#x27;</span>,</span><br><span class="line">    userAccount  <span class="type">varchar</span>(<span class="number">256</span>)                           <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;è´¦å·&#x27;</span>,</span><br><span class="line">    userAvatar   <span class="type">varchar</span>(<span class="number">1024</span>)                          <span class="keyword">null</span> comment <span class="string">&#x27;ç”¨æˆ·å¤´åƒ&#x27;</span>,</span><br><span class="line">    gender       tinyint                                <span class="keyword">null</span> comment <span class="string">&#x27;æ€§åˆ«&#x27;</span>,</span><br><span class="line">    userRole     <span class="type">varchar</span>(<span class="number">256</span>) <span class="keyword">default</span> <span class="string">&#x27;user&#x27;</span>            <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;ç”¨æˆ·è§’è‰²ï¼šuser / admin&#x27;</span>,</span><br><span class="line">    userPassword <span class="type">varchar</span>(<span class="number">512</span>)                           <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;å¯†ç &#x27;</span>,</span><br><span class="line">    createTime   datetime     <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    updateTime   datetime     <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">CURRENT_TIMESTAMP</span> comment <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    isDelete     tinyint      <span class="keyword">default</span> <span class="number">0</span>                 <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ˜¯å¦åˆ é™¤&#x27;</span>,</span><br><span class="line">    <span class="keyword">constraint</span> uni_userAccount</span><br><span class="line">        <span class="keyword">unique</span> (userAccount)</span><br><span class="line">) comment <span class="string">&#x27;ç”¨æˆ·&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¸–å­è¡¨</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> post</span><br><span class="line">(</span><br><span class="line">    id            <span class="type">bigint</span> auto_increment comment <span class="string">&#x27;id&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    age           <span class="type">int</span> comment <span class="string">&#x27;å¹´é¾„&#x27;</span>,</span><br><span class="line">    gender        tinyint  <span class="keyword">default</span> <span class="number">0</span>                 <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ€§åˆ«ï¼ˆ0-ç”·, 1-å¥³ï¼‰&#x27;</span>,</span><br><span class="line">    education     <span class="type">varchar</span>(<span class="number">512</span>)                       <span class="keyword">null</span> comment <span class="string">&#x27;å­¦å†&#x27;</span>,</span><br><span class="line">    place         <span class="type">varchar</span>(<span class="number">512</span>)                       <span class="keyword">null</span> comment <span class="string">&#x27;åœ°ç‚¹&#x27;</span>,</span><br><span class="line">    job           <span class="type">varchar</span>(<span class="number">512</span>)                       <span class="keyword">null</span> comment <span class="string">&#x27;èŒä¸š&#x27;</span>,</span><br><span class="line">    contact       <span class="type">varchar</span>(<span class="number">512</span>)                       <span class="keyword">null</span> comment <span class="string">&#x27;è”ç³»æ–¹å¼&#x27;</span>,</span><br><span class="line">    loveExp       <span class="type">varchar</span>(<span class="number">512</span>)                       <span class="keyword">null</span> comment <span class="string">&#x27;æ„Ÿæƒ…ç»å†&#x27;</span>,</span><br><span class="line">    content       text                               <span class="keyword">null</span> comment <span class="string">&#x27;å†…å®¹ï¼ˆä¸ªäººä»‹ç»ï¼‰&#x27;</span>,</span><br><span class="line">    photo         <span class="type">varchar</span>(<span class="number">1024</span>)                      <span class="keyword">null</span> comment <span class="string">&#x27;ç…§ç‰‡åœ°å€&#x27;</span>,</span><br><span class="line">    reviewStatus  <span class="type">int</span>      <span class="keyword">default</span> <span class="number">0</span>                 <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;çŠ¶æ€ï¼ˆ0-å¾…å®¡æ ¸, 1-é€šè¿‡, 2-æ‹’ç»ï¼‰&#x27;</span>,</span><br><span class="line">    reviewMessage <span class="type">varchar</span>(<span class="number">512</span>)                       <span class="keyword">null</span> comment <span class="string">&#x27;å®¡æ ¸ä¿¡æ¯&#x27;</span>,</span><br><span class="line">    viewNum       <span class="type">int</span>                                <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">default</span> <span class="number">0</span> comment <span class="string">&#x27;æµè§ˆæ•°&#x27;</span>,</span><br><span class="line">    thumbNum      <span class="type">int</span>                                <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">default</span> <span class="number">0</span> comment <span class="string">&#x27;ç‚¹èµæ•°&#x27;</span>,</span><br><span class="line">    userId        <span class="type">bigint</span>                             <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºç”¨æˆ· id&#x27;</span>,</span><br><span class="line">    createTime    datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    updateTime    datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">CURRENT_TIMESTAMP</span> comment <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    isDelete      tinyint  <span class="keyword">default</span> <span class="number">0</span>                 <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ˜¯å¦åˆ é™¤&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;å¸–å­&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- å¸–å­ç‚¹èµè®°å½•è¡¨ï¼ˆç¡¬åˆ é™¤ï¼‰</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> post_thumb</span><br><span class="line">(</span><br><span class="line">    id         <span class="type">bigint</span> auto_increment comment <span class="string">&#x27;id&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    postId     <span class="type">bigint</span>                             <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;å¸–å­ id&#x27;</span>,</span><br><span class="line">    userId     <span class="type">bigint</span>                             <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºç”¨æˆ· id&#x27;</span>,</span><br><span class="line">    createTime datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    updateTime datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">CURRENT_TIMESTAMP</span> comment <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;å¸–å­ç‚¹èµè®°å½•&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ ‡ç­¾è¡¨</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> tag</span><br><span class="line">(</span><br><span class="line">    id         <span class="type">bigint</span> auto_increment comment <span class="string">&#x27;id&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    category   <span class="type">varchar</span>(<span class="number">512</span>)                       <span class="keyword">null</span> comment <span class="string">&#x27;åˆ†ç±»&#x27;</span>,</span><br><span class="line">    tagName    <span class="type">varchar</span>(<span class="number">512</span>)                       <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ ‡ç­¾åç§°&#x27;</span>,</span><br><span class="line">    postNum    <span class="type">int</span>      <span class="keyword">default</span> <span class="number">0</span>                 <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;å¸–å­ä½¿ç”¨æ ‡ç­¾æ¬¡æ•°&#x27;</span>,</span><br><span class="line">    userId     <span class="type">bigint</span>                             <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºç”¨æˆ· id&#x27;</span>,</span><br><span class="line">    createTime datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    updateTime datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">CURRENT_TIMESTAMP</span> comment <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    isDelete   tinyint  <span class="keyword">default</span> <span class="number">0</span>                 <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ˜¯å¦åˆ é™¤&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;æ ‡ç­¾&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ä¸¾æŠ¥è¡¨</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> report</span><br><span class="line">(</span><br><span class="line">    id             <span class="type">bigint</span> auto_increment comment <span class="string">&#x27;id&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    content        text                               <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;å†…å®¹&#x27;</span>,</span><br><span class="line">    reportedId     <span class="type">bigint</span>                             <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;è¢«ä¸¾æŠ¥å¯¹è±¡ id&#x27;</span>,</span><br><span class="line">    reportedUserId <span class="type">bigint</span>                             <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;è¢«ä¸¾æŠ¥ç”¨æˆ· id&#x27;</span>,</span><br><span class="line">    status         <span class="type">int</span>      <span class="keyword">default</span> <span class="number">0</span>                 <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;çŠ¶æ€ï¼ˆ0-æœªå¤„ç†, 1-å·²å¤„ç†ï¼‰&#x27;</span>,</span><br><span class="line">    userId         <span class="type">bigint</span>                             <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºç”¨æˆ· id&#x27;</span>,</span><br><span class="line">    createTime     datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    updateTime     datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">CURRENT_TIMESTAMP</span> comment <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    isDelete       tinyint  <span class="keyword">default</span> <span class="number">0</span>                 <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ˜¯å¦åˆ é™¤&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;ä¸¾æŠ¥&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æœç´¢è®°å½•è¡¨</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> search_history</span><br><span class="line">(</span><br><span class="line">    id         <span class="type">bigint</span> auto_increment comment <span class="string">&#x27;id&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    word       <span class="type">varchar</span>(<span class="number">512</span>)                       <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æœç´¢è¯&#x27;</span>,</span><br><span class="line">    num        <span class="type">int</span>                                <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">default</span> <span class="number">0</span> comment <span class="string">&#x27;æœç´¢æ¬¡æ•°&#x27;</span>,</span><br><span class="line">    createTime datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    updateTime datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">CURRENT_TIMESTAMP</span> comment <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    isDelete   tinyint  <span class="keyword">default</span> <span class="number">0</span>                 <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ˜¯å¦åˆ é™¤&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;æœç´¢è®°å½•&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- æ ‡ç­¾ç­›é€‰è®°å½•è¡¨</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> tag_search_history</span><br><span class="line">(</span><br><span class="line">    id         <span class="type">bigint</span> auto_increment comment <span class="string">&#x27;id&#x27;</span> <span class="keyword">primary</span> key,</span><br><span class="line">    tagName    <span class="type">varchar</span>(<span class="number">512</span>)                       <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;ç­›é€‰æ ‡ç­¾åç§°&#x27;</span>,</span><br><span class="line">    num        <span class="type">int</span>                                <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">default</span> <span class="number">0</span> comment <span class="string">&#x27;æ¬¡æ•°&#x27;</span>,</span><br><span class="line">    createTime datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;åˆ›å»ºæ—¶é—´&#x27;</span>,</span><br><span class="line">    updateTime datetime <span class="keyword">default</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">on</span> <span class="keyword">update</span> <span class="built_in">CURRENT_TIMESTAMP</span> comment <span class="string">&#x27;æ›´æ–°æ—¶é—´&#x27;</span>,</span><br><span class="line">    isDelete   tinyint  <span class="keyword">default</span> <span class="number">0</span>                 <span class="keyword">not</span> <span class="keyword">null</span> comment <span class="string">&#x27;æ˜¯å¦åˆ é™¤&#x27;</span></span><br><span class="line">) comment <span class="string">&#x27;æ ‡ç­¾ç­›é€‰è®°å½•&#x27;</span>;</span><br></pre></td></tr></table></figure><h4 id="11-2å¯¼å…¥æ•°æ®"><a href="#11-2å¯¼å…¥æ•°æ®" class="headerlink" title="11.2å¯¼å…¥æ•°æ®"></a>11.2å¯¼å…¥æ•°æ®</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.once;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.EasyExcel;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.support.ExcelTypeEnum;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.dto.PostImportDTO;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.User;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.PostService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.TagService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.UserService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.listener.PostImportListener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Assertions;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.ResourceUtils;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¯¼å…¥å¸–å­ï¼ˆä¸€æ¬¡æ€§ä»»åŠ¡ï¼‰</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PostImportTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> PostService postService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> TagService tagService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ä»…æ‰§è¡Œä¸€æ¬¡ï¼Œä¹‹åå¯ä»¥æ³¨é‡Šæ‰ @Test æ³¨è§£</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doImport</span><span class="params">()</span> <span class="keyword">throws</span> FileNotFoundException &#123;</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> ResourceUtils.getFile(<span class="string">&quot;classpath:åˆå§‹æ•°æ®.xlsx&quot;</span>);</span><br><span class="line">        EasyExcel.read(file, PostImportDTO.class, <span class="keyword">new</span> <span class="title class_">PostImportListener</span>(postService, tagService))</span><br><span class="line">                .excelType(ExcelTypeEnum.XLSX)</span><br><span class="line">                .sheet()</span><br><span class="line">                .doRead();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸šåŠ¡é€»è¾‘"><a href="#ä¸šåŠ¡é€»è¾‘" class="headerlink" title="ä¸šåŠ¡é€»è¾‘"></a>ä¸šåŠ¡é€»è¾‘</h2><h3 id="1-ç”¨æˆ·ç®¡ç†"><a href="#1-ç”¨æˆ·ç®¡ç†" class="headerlink" title="1.ç”¨æˆ·ç®¡ç†"></a>1.ç”¨æˆ·ç®¡ç†</h3><h4 id="1-1serviceï¼ˆç”¨æˆ·æœåŠ¡æ¥å£ï¼‰"><a href="#1-1serviceï¼ˆç”¨æˆ·æœåŠ¡æ¥å£ï¼‰" class="headerlink" title="1.1serviceï¼ˆç”¨æˆ·æœåŠ¡æ¥å£ï¼‰"></a>1.1serviceï¼ˆç”¨æˆ·æœåŠ¡æ¥å£ï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.IService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·æœåŠ¡</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;User&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·æ³¨å†Œ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userAccount   ç”¨æˆ·è´¦æˆ·</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userPassword  ç”¨æˆ·å¯†ç </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> checkPassword æ ¡éªŒå¯†ç </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ–°ç”¨æˆ· id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">long</span> <span class="title function_">userRegister</span><span class="params">(String userAccount, String userPassword, String checkPassword)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·ç™»å½•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userAccount  ç”¨æˆ·è´¦æˆ·</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userPassword ç”¨æˆ·å¯†ç </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> è„±æ•åçš„ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    User <span class="title function_">userLogin</span><span class="params">(String userAccount, String userPassword, HttpServletRequest request)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å½“å‰ç™»å½•ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    User <span class="title function_">getLoginUser</span><span class="params">(HttpServletRequest request)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦ä¸ºç®¡ç†å‘˜</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isAdmin</span><span class="params">(HttpServletRequest request)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·æ³¨é”€</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">userLogout</span><span class="params">(HttpServletRequest request)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="1-2service-implï¼ˆç”¨æˆ·æœåŠ¡æ¥å£å®ç°ç±»ï¼‰"><a href="#1-2service-implï¼ˆç”¨æˆ·æœåŠ¡æ¥å£å®ç°ç±»ï¼‰" class="headerlink" title="1.2service.implï¼ˆç”¨æˆ·æœåŠ¡æ¥å£å®ç°ç±»ï¼‰"></a>1.2service.implï¼ˆç”¨æˆ·æœåŠ¡æ¥å£å®ç°ç±»ï¼‰</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ErrorCode;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.exception.BusinessException;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.mapper.UserMapper;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.User;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.UserService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.utils.NetUtils;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.DigestUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> com.yupi.lovefinder.constant.UserConstant.ADMIN_ROLE;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> com.yupi.lovefinder.constant.UserConstant.USER_LOGIN_STATE;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·æœåŠ¡å®ç°ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;UserMapper, User&gt;</span><br><span class="line">        <span class="keyword">implements</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç›å€¼ï¼Œæ··æ·†å¯†ç </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SALT</span> <span class="operator">=</span> <span class="string">&quot;yupi&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">userRegister</span><span class="params">(String userAccount, String userPassword, String checkPassword)</span> &#123;</span><br><span class="line">        <span class="comment">// 1. æ ¡éªŒ</span></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isAnyBlank(userAccount, userPassword, checkPassword)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR, <span class="string">&quot;å‚æ•°ä¸ºç©º&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (userAccount.length() &lt; <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR, <span class="string">&quot;ç”¨æˆ·è´¦å·è¿‡çŸ­&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (userPassword.length() &lt; <span class="number">8</span> || checkPassword.length() &lt; <span class="number">8</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR, <span class="string">&quot;ç”¨æˆ·å¯†ç è¿‡çŸ­&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¯†ç å’Œæ ¡éªŒå¯†ç ç›¸åŒ</span></span><br><span class="line">        <span class="keyword">if</span> (!userPassword.equals(checkPassword)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR, <span class="string">&quot;ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">synchronized</span> (userAccount.intern()) &#123;</span><br><span class="line">            <span class="comment">// è´¦æˆ·ä¸èƒ½é‡å¤</span></span><br><span class="line">            QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">            queryWrapper.eq(<span class="string">&quot;userAccount&quot;</span>, userAccount);</span><br><span class="line">            <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> userMapper.selectCount(queryWrapper);</span><br><span class="line">            <span class="keyword">if</span> (count &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR, <span class="string">&quot;è´¦å·é‡å¤&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 2. åŠ å¯†</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">encryptPassword</span> <span class="operator">=</span> DigestUtils.md5DigestAsHex((SALT + userPassword).getBytes());</span><br><span class="line">            <span class="comment">// 3. æ’å…¥æ•°æ®</span></span><br><span class="line">            <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">            user.setUserAccount(userAccount);</span><br><span class="line">            user.setUserPassword(encryptPassword);</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">saveResult</span> <span class="operator">=</span> <span class="built_in">this</span>.save(user);</span><br><span class="line">            <span class="keyword">if</span> (!saveResult) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.SYSTEM_ERROR, <span class="string">&quot;æ³¨å†Œå¤±è´¥ï¼Œæ•°æ®åº“é”™è¯¯&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> user.getId();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">userLogin</span><span class="params">(String userAccount, String userPassword, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="comment">// 1. æ ¡éªŒ</span></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isAnyBlank(userAccount, userPassword)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR, <span class="string">&quot;å‚æ•°ä¸ºç©º&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (userAccount.length() &lt; <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR, <span class="string">&quot;è´¦å·é”™è¯¯&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (userPassword.length() &lt; <span class="number">8</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR, <span class="string">&quot;å¯†ç é”™è¯¯&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 2. åŠ å¯†</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">encryptPassword</span> <span class="operator">=</span> DigestUtils.md5DigestAsHex((SALT + userPassword).getBytes());</span><br><span class="line">        <span class="comment">// æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        queryWrapper.eq(<span class="string">&quot;userAccount&quot;</span>, userAccount);</span><br><span class="line">        queryWrapper.eq(<span class="string">&quot;userPassword&quot;</span>, encryptPassword);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.selectOne(queryWrapper);</span><br><span class="line">        <span class="comment">// ç”¨æˆ·ä¸å­˜åœ¨</span></span><br><span class="line">        <span class="keyword">if</span> (user == <span class="literal">null</span>) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;user login failed, userAccount cannot match userPassword&quot;</span>);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR, <span class="string">&quot;ç”¨æˆ·ä¸å­˜åœ¨æˆ–å¯†ç é”™è¯¯&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 3. è®°å½•ç”¨æˆ·çš„ç™»å½•æ€</span></span><br><span class="line">        request.getSession().setAttribute(USER_LOGIN_STATE, user);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å½“å‰ç™»å½•ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">getLoginUser</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="comment">// å…ˆåˆ¤æ–­æ˜¯å¦å·²ç™»å½•</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">userObj</span> <span class="operator">=</span> request.getSession().getAttribute(USER_LOGIN_STATE);</span><br><span class="line">        <span class="type">User</span> <span class="variable">currentUser</span> <span class="operator">=</span> (User) userObj;</span><br><span class="line">        <span class="keyword">if</span> (currentUser == <span class="literal">null</span> || currentUser.getId() == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.NOT_LOGIN_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä»æ•°æ®åº“æŸ¥è¯¢ï¼ˆè¿½æ±‚æ€§èƒ½çš„è¯å¯ä»¥æ³¨é‡Šï¼Œç›´æ¥èµ°ç¼“å­˜ï¼‰</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">userId</span> <span class="operator">=</span> currentUser.getId();</span><br><span class="line">        currentUser = <span class="built_in">this</span>.getById(userId);</span><br><span class="line">        <span class="keyword">if</span> (currentUser == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.NOT_LOGIN_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> currentUser;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦ä¸ºç®¡ç†å‘˜</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isAdmin</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="comment">// ä»…ç®¡ç†å‘˜å¯æŸ¥è¯¢</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">userObj</span> <span class="operator">=</span> request.getSession().getAttribute(USER_LOGIN_STATE);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> (User) userObj;</span><br><span class="line">        <span class="keyword">return</span> user != <span class="literal">null</span> &amp;&amp; ADMIN_ROLE.equals(user.getUserRole());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·æ³¨é”€</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">userLogout</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (request.getSession().getAttribute(USER_LOGIN_STATE) == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.OPERATION_ERROR, <span class="string">&quot;æœªç™»å½•&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç§»é™¤ç™»å½•æ€</span></span><br><span class="line">        request.getSession().removeAttribute(USER_LOGIN_STATE);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="1-3controller"><a href="#1-3controller" class="headerlink" title="1.3controller"></a>1.3controller</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.PageDTO;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.BaseResponse;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.DeleteRequest;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ErrorCode;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ResultUtils;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.exception.BusinessException;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.User;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.dto.*;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.vo.UserVO;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.UserService;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·æ¥å£</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// region ç™»å½•ç›¸å…³</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·æ³¨å†Œ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userRegisterRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/register&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Long&gt; <span class="title function_">userRegister</span><span class="params">(<span class="meta">@RequestBody</span> UserRegisterRequest userRegisterRequest)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (userRegisterRequest == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">userAccount</span> <span class="operator">=</span> userRegisterRequest.getUserAccount();</span><br><span class="line">        <span class="type">String</span> <span class="variable">userPassword</span> <span class="operator">=</span> userRegisterRequest.getUserPassword();</span><br><span class="line">        <span class="type">String</span> <span class="variable">checkPassword</span> <span class="operator">=</span> userRegisterRequest.getCheckPassword();</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isAnyBlank(userAccount, userPassword, checkPassword)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">result</span> <span class="operator">=</span> userService.userRegister(userAccount, userPassword, checkPassword);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·ç™»å½•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userLoginRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/login&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;User&gt; <span class="title function_">userLogin</span><span class="params">(<span class="meta">@RequestBody</span> UserLoginRequest userLoginRequest, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (userLoginRequest == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">userAccount</span> <span class="operator">=</span> userLoginRequest.getUserAccount();</span><br><span class="line">        <span class="type">String</span> <span class="variable">userPassword</span> <span class="operator">=</span> userLoginRequest.getUserPassword();</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isAnyBlank(userAccount, userPassword)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.userLogin(userAccount, userPassword, request);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·æ³¨é”€</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/logout&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Boolean&gt; <span class="title function_">userLogout</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (request == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> userService.userLogout(request);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å½“å‰ç™»å½•ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/get/login&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;UserVO&gt; <span class="title function_">getLoginUser</span><span class="params">(HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.getLoginUser(request);</span><br><span class="line">        <span class="type">UserVO</span> <span class="variable">userVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserVO</span>();</span><br><span class="line">        BeanUtils.copyProperties(user, userVO);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(userVO);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// endregion</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// region å¢åˆ æ”¹æŸ¥</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºç”¨æˆ·</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userAddRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Long&gt; <span class="title function_">addUser</span><span class="params">(<span class="meta">@RequestBody</span> UserAddRequest userAddRequest, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (userAddRequest == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        BeanUtils.copyProperties(userAddRequest, user);</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> userService.save(user);</span><br><span class="line">        <span class="keyword">if</span> (!result) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.OPERATION_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(user.getId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> deleteRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/delete&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Boolean&gt; <span class="title function_">deleteUser</span><span class="params">(<span class="meta">@RequestBody</span> DeleteRequest deleteRequest, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (deleteRequest == <span class="literal">null</span> || deleteRequest.getId() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> userService.removeById(deleteRequest.getId());</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userUpdateRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/update&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Boolean&gt; <span class="title function_">updateUser</span><span class="params">(<span class="meta">@RequestBody</span> UserUpdateRequest userUpdateRequest, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (userUpdateRequest == <span class="literal">null</span> || userUpdateRequest.getId() == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        BeanUtils.copyProperties(userUpdateRequest, user);</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> userService.updateById(user);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ® id è·å–ç”¨æˆ·</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/get&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;UserVO&gt; <span class="title function_">getUserById</span><span class="params">(<span class="type">int</span> id, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (id &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.getById(id);</span><br><span class="line">        <span class="type">UserVO</span> <span class="variable">userVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserVO</span>();</span><br><span class="line">        BeanUtils.copyProperties(user, userVO);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(userVO);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–ç”¨æˆ·åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userQueryRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;List&lt;UserVO&gt;&gt; <span class="title function_">listUser</span><span class="params">(UserQueryRequest userQueryRequest, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">userQuery</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        <span class="keyword">if</span> (userQueryRequest != <span class="literal">null</span>) &#123;</span><br><span class="line">            BeanUtils.copyProperties(userQueryRequest, userQuery);</span><br><span class="line">        &#125;</span><br><span class="line">        QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;(userQuery);</span><br><span class="line">        List&lt;User&gt; userList = userService.list(queryWrapper);</span><br><span class="line">        List&lt;UserVO&gt; userVOList = userList.stream().map(user -&gt; &#123;</span><br><span class="line">            <span class="type">UserVO</span> <span class="variable">userVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserVO</span>();</span><br><span class="line">            BeanUtils.copyProperties(user, userVO);</span><br><span class="line">            <span class="keyword">return</span> userVO;</span><br><span class="line">        &#125;).collect(Collectors.toList());</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(userVOList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µè·å–ç”¨æˆ·åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userQueryRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/list/page&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Page&lt;UserVO&gt;&gt; <span class="title function_">listUserByPage</span><span class="params">(UserQueryRequest userQueryRequest, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">current</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="type">long</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">        <span class="type">User</span> <span class="variable">userQuery</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        <span class="keyword">if</span> (userQueryRequest != <span class="literal">null</span>) &#123;</span><br><span class="line">            BeanUtils.copyProperties(userQueryRequest, userQuery);</span><br><span class="line">            current = userQueryRequest.getCurrent();</span><br><span class="line">            size = userQueryRequest.getPageSize();</span><br><span class="line">        &#125;</span><br><span class="line">        QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;(userQuery);</span><br><span class="line">        Page&lt;User&gt; userPage = userService.page(<span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(current, size), queryWrapper);</span><br><span class="line">        Page&lt;UserVO&gt; userVOPage = <span class="keyword">new</span> <span class="title class_">PageDTO</span>&lt;&gt;(userPage.getCurrent(), userPage.getSize(), userPage.getTotal());</span><br><span class="line">        List&lt;UserVO&gt; userVOList = userPage.getRecords().stream().map(user -&gt; &#123;</span><br><span class="line">            <span class="type">UserVO</span> <span class="variable">userVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">UserVO</span>();</span><br><span class="line">            BeanUtils.copyProperties(user, userVO);</span><br><span class="line">            <span class="keyword">return</span> userVO;</span><br><span class="line">        &#125;).collect(Collectors.toList());</span><br><span class="line">        userVOPage.setRecords(userVOList);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(userVOPage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// endregion</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="1-4model"><a href="#1-4model" class="headerlink" title="1.4model"></a>1.4model</h4><h5 id="1-4-1model-entityå®ä½“ç±»"><a href="#1-4-1model-entityå®ä½“ç±»" class="headerlink" title="1.4.1model.entityå®ä½“ç±»"></a>1.4.1model.entityå®ä½“ç±»</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.*;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@TableName</span> user</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@TableName(value = &quot;user&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableId(type = IdType.AUTO)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·æ˜µç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è´¦å·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userAccount;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·å¤´åƒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userAvatar;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ€§åˆ«</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·è§’è‰²: user, admin</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userRole;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯†ç </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userPassword;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€»è¾‘åˆ é™¤</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableLogic</span></span><br><span class="line">    <span class="keyword">private</span> Integer isDelete;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="1-4-2model-dtoå°è£…è¯·æ±‚ä½“å‚æ•°"><a href="#1-4-2model-dtoå°è£…è¯·æ±‚ä½“å‚æ•°" class="headerlink" title="1.4.2model.dtoå°è£…è¯·æ±‚ä½“å‚æ•°"></a>1.4.2model.dtoå°è£…è¯·æ±‚ä½“å‚æ•°</h5><h6 id="1-4-2-1ç”¨æˆ·æ³¨å†Œè¯·æ±‚ä½“"><a href="#1-4-2-1ç”¨æˆ·æ³¨å†Œè¯·æ±‚ä½“" class="headerlink" title="1.4.2.1ç”¨æˆ·æ³¨å†Œè¯·æ±‚ä½“"></a>1.4.2.1ç”¨æˆ·æ³¨å†Œè¯·æ±‚ä½“</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·æ³¨å†Œè¯·æ±‚ä½“</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserRegisterRequest</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">3191241716373120793L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userAccount;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userPassword;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String checkPassword;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h6 id="1-4-2-2ç”¨æˆ·ç™»å½•è¯·æ±‚ä½“"><a href="#1-4-2-2ç”¨æˆ·ç™»å½•è¯·æ±‚ä½“" class="headerlink" title="1.4.2.2ç”¨æˆ·ç™»å½•è¯·æ±‚ä½“"></a>1.4.2.2ç”¨æˆ·ç™»å½•è¯·æ±‚ä½“</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·ç™»å½•è¯·æ±‚ä½“</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserLoginRequest</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">3191241716373120793L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userAccount;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userPassword;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h6 id="1-4-2-3ç”¨æˆ·åˆ›å»ºè¯·æ±‚"><a href="#1-4-2-3ç”¨æˆ·åˆ›å»ºè¯·æ±‚" class="headerlink" title="1.4.2.3ç”¨æˆ·åˆ›å»ºè¯·æ±‚"></a>1.4.2.3ç”¨æˆ·åˆ›å»ºè¯·æ±‚</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·åˆ›å»ºè¯·æ±‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserAddRequest</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·æ˜µç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è´¦å·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userAccount;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·å¤´åƒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userAvatar;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ€§åˆ«</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·è§’è‰²: user, admin</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userRole;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯†ç </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userPassword;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="1-4-2-4ç”¨æˆ·æ›´æ–°è¯·æ±‚"><a href="#1-4-2-4ç”¨æˆ·æ›´æ–°è¯·æ±‚" class="headerlink" title="1.4.2.4ç”¨æˆ·æ›´æ–°è¯·æ±‚"></a>1.4.2.4ç”¨æˆ·æ›´æ–°è¯·æ±‚</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableField;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·æ›´æ–°è¯·æ±‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserUpdateRequest</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·æ˜µç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è´¦å·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userAccount;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·å¤´åƒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userAvatar;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ€§åˆ«</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·è§’è‰²: user, admin</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userRole;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¯†ç </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userPassword;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="1-4-2-5ç”¨æˆ·æŸ¥è¯¢è¯·æ±‚"><a href="#1-4-2-5ç”¨æˆ·æŸ¥è¯¢è¯·æ±‚" class="headerlink" title="1.4.2.5ç”¨æˆ·æŸ¥è¯¢è¯·æ±‚"></a>1.4.2.5ç”¨æˆ·æŸ¥è¯¢è¯·æ±‚</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.PageRequest;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.EqualsAndHashCode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·æŸ¥è¯¢è¯·æ±‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper = true)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserQueryRequest</span> <span class="keyword">extends</span> <span class="title class_">PageRequest</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·æ˜µç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è´¦å·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userAccount;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·å¤´åƒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userAvatar;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ€§åˆ«</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·è§’è‰²: user, admin</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userRole;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="1-4-3model-vo"><a href="#1-4-3model-vo" class="headerlink" title="1.4.3model.vo"></a>1.4.3model.vo</h5><p>VOå±‚å­˜åœ¨çš„æ„ä¹‰ï¼Œé€šä¿—çš„è®²ï¼ŒVOå±‚çš„å­˜åœ¨å°±æ˜¯æ–¹ä¾¿å‰ç«¯è·å–æ•°æ®ï¼Œåç«¯å°†å‰ç«¯çš„éœ€è¦çš„æ•°æ®åšä¸€ä¸ªæ•´åˆï¼Œæ‰“åŒ…æˆä¸€ä¸ªç±»ã€‚</p><h6 id="1-4-3-1UserVOç”¨æˆ·è§†å›¾"><a href="#1-4-3-1UserVOç”¨æˆ·è§†å›¾" class="headerlink" title="1.4.3.1UserVOç”¨æˆ·è§†å›¾"></a>1.4.3.1UserVOç”¨æˆ·è§†å›¾</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.vo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç”¨æˆ·è§†å›¾</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@TableName</span> user</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserVO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·æ˜µç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è´¦å·</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userAccount;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·å¤´åƒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userAvatar;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ€§åˆ«</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç”¨æˆ·è§’è‰²: user, admin</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String userRole;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-å¸–å­ç®¡ç†"><a href="#2-å¸–å­ç®¡ç†" class="headerlink" title="2.å¸–å­ç®¡ç†"></a>2.å¸–å­ç®¡ç†</h3><h4 id="2-1service"><a href="#2-1service" class="headerlink" title="2.1service"></a>2.1service</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.Post;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.IService;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupili</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é’ˆå¯¹è¡¨ã€post(å¸–å­)ã€‘çš„æ•°æ®åº“æ“ä½œService</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PostService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;Post&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¡éªŒ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> post</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> add æ˜¯å¦ä¸ºåˆ›å»ºæ ¡éªŒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">validPost</span><span class="params">(Post post, <span class="type">boolean</span> add)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="2-2service-impl"><a href="#2-2service-impl" class="headerlink" title="2.2service.impl"></a>2.2service.impl</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ErrorCode;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.exception.BusinessException;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.Post;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.enums.PostGenderEnum;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.enums.PostReviewStatusEnum;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.PostService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.mapper.PostMapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.ObjectUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.BindingResultUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.validation.ValidationUtils;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupili</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é’ˆå¯¹è¡¨ã€post(å¸–å­)ã€‘çš„æ•°æ®åº“æ“ä½œServiceå®ç°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PostServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;PostMapper, Post&gt; <span class="keyword">implements</span> <span class="title class_">PostService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">validPost</span><span class="params">(Post post, <span class="type">boolean</span> add)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (post == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">age</span> <span class="operator">=</span> post.getAge();</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">gender</span> <span class="operator">=</span> post.getGender();</span><br><span class="line">        <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> post.getContent();</span><br><span class="line">        <span class="type">String</span> <span class="variable">job</span> <span class="operator">=</span> post.getJob();</span><br><span class="line">        <span class="type">String</span> <span class="variable">place</span> <span class="operator">=</span> post.getPlace();</span><br><span class="line">        <span class="type">String</span> <span class="variable">education</span> <span class="operator">=</span> post.getEducation();</span><br><span class="line">        <span class="type">String</span> <span class="variable">loveExp</span> <span class="operator">=</span> post.getLoveExp();</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">reviewStatus</span> <span class="operator">=</span> post.getReviewStatus();</span><br><span class="line">        <span class="comment">// åˆ›å»ºæ—¶ï¼Œæ‰€æœ‰å‚æ•°å¿…é¡»éç©º</span></span><br><span class="line">        <span class="keyword">if</span> (add) &#123;</span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isAnyBlank(content, job, place, education, loveExp) || ObjectUtils.anyNull(age, gender)) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(content) &amp;&amp; content.length() &gt; <span class="number">8192</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR, <span class="string">&quot;å†…å®¹è¿‡é•¿&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (reviewStatus != <span class="literal">null</span> &amp;&amp; !PostReviewStatusEnum.getValues().contains(reviewStatus)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (age != <span class="literal">null</span> &amp;&amp; (age &lt; <span class="number">18</span> || age &gt; <span class="number">100</span>)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR, <span class="string">&quot;å¹´é¾„ä¸ç¬¦åˆè¦æ±‚&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (gender != <span class="literal">null</span> &amp;&amp; !PostGenderEnum.getValues().contains(gender)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR, <span class="string">&quot;æ€§åˆ«ä¸ç¬¦åˆè¦æ±‚&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="2-3service-listener"><a href="#2-3service-listener" class="headerlink" title="2.3service.listener"></a>2.3service.listener</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.service.listener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.context.AnalysisContext;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.read.listener.ReadListener;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.util.ListUtils;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.constant.UserConstant;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.dto.PostImportDTO;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.Post;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.Tag;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.enums.PostReviewStatusEnum;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.enums.TagCategoryEnum;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.PostService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.TagService;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Map.Entry;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¸–å­ Excel å¯¼å…¥ç›‘å¬å™¨</span></span><br><span class="line"><span class="comment"> * æœ‰ä¸ªå¾ˆé‡è¦çš„ç‚¹ DemoDataListener ä¸èƒ½è¢«springç®¡ç†ï¼Œè¦æ¯æ¬¡è¯»å–exceléƒ½è¦new,ç„¶åé‡Œé¢ç”¨åˆ°springå¯ä»¥æ„é€ æ–¹æ³•ä¼ è¿›å»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PostImportListener</span> <span class="keyword">implements</span> <span class="title class_">ReadListener</span>&lt;PostImportDTO&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¯éš”ä¸€å®šæ¡æ•°æ‰¹é‡æ’å…¥æ•°æ®åº“ï¼Œç„¶åæ¸…ç†list ï¼Œæ–¹ä¾¿å†…å­˜å›æ”¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">BATCH_COUNT</span> <span class="operator">=</span> <span class="number">500</span>;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Post&gt; cachedDataList = ListUtils.newArrayListWithExpectedSize(BATCH_COUNT);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®°å½•æœ¬æ¬¡å¯¼å…¥æ•°æ®çš„æ ‡ç­¾åˆ†ç»„</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, Set&lt;String&gt;&gt; categoryTagNameSetMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Set&lt;String&gt;&gt;() &#123;&#123;</span><br><span class="line">        put(TagCategoryEnum.EDUCATION.getValue(), <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;());</span><br><span class="line">        put(TagCategoryEnum.JOB.getValue(), <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;());</span><br><span class="line">        put(TagCategoryEnum.PLACE.getValue(), <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;());</span><br><span class="line">        put(TagCategoryEnum.LOVE_EXP.getValue(), <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;());</span><br><span class="line">    &#125;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> PostService postService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> TagService tagService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">PostImportListener</span><span class="params">(PostService postService, TagService tagService)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.postService = postService;</span><br><span class="line">        <span class="built_in">this</span>.tagService = tagService;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¯ä¸€æ¡æ•°æ®è§£æéƒ½ä¼šæ¥è°ƒç”¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> postImportDTO one row value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> context</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">invoke</span><span class="params">(PostImportDTO postImportDTO, AnalysisContext context)</span> &#123;</span><br><span class="line">        <span class="type">Post</span> <span class="variable">post</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Post</span>();</span><br><span class="line">        BeanUtils.copyProperties(postImportDTO, post);</span><br><span class="line">        post.setUserId(UserConstant.SYSTEM_USER_ID);</span><br><span class="line">        post.setReviewStatus(PostReviewStatusEnum.PASS.getValue());</span><br><span class="line">        cachedDataList.add(post);</span><br><span class="line">        <span class="comment">// è¾¾åˆ° BATCH_COUNT äº†ï¼Œéœ€è¦å»å­˜å‚¨ä¸€æ¬¡æ•°æ®åº“ï¼Œé˜²æ­¢æ•°æ®å‡ ä¸‡æ¡æ•°æ®åœ¨å†…å­˜ï¼Œå®¹æ˜“OOM</span></span><br><span class="line">        <span class="keyword">if</span> (cachedDataList.size() &gt;= BATCH_COUNT) &#123;</span><br><span class="line">            saveData();</span><br><span class="line">            <span class="comment">// å­˜å‚¨å®Œæˆæ¸…ç† list</span></span><br><span class="line">            cachedDataList = ListUtils.newArrayListWithExpectedSize(BATCH_COUNT);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// è®°å½•æ ‡ç­¾</span></span><br><span class="line">        categoryTagNameSetMap.get(TagCategoryEnum.EDUCATION.getValue()).add(post.getEducation());</span><br><span class="line">        categoryTagNameSetMap.get(TagCategoryEnum.JOB.getValue()).add(post.getJob());</span><br><span class="line">        categoryTagNameSetMap.get(TagCategoryEnum.PLACE.getValue()).add(post.getPlace());</span><br><span class="line">        categoryTagNameSetMap.get(TagCategoryEnum.LOVE_EXP.getValue()).add(post.getLoveExp());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰€æœ‰æ•°æ®è§£æå®Œæˆäº† éƒ½ä¼šæ¥è°ƒç”¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> context</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">doAfterAllAnalysed</span><span class="params">(AnalysisContext context)</span> &#123;</span><br><span class="line">        <span class="comment">// è¿™é‡Œä¹Ÿè¦ä¿å­˜æ•°æ®ï¼Œç¡®ä¿æœ€åé—ç•™çš„æ•°æ®ä¹Ÿå­˜å‚¨åˆ°æ•°æ®åº“</span></span><br><span class="line">        saveData();</span><br><span class="line">        <span class="comment">// ä¿å­˜æ ‡ç­¾</span></span><br><span class="line">        <span class="keyword">for</span> (Entry&lt;String, Set&lt;String&gt;&gt; categoryTagNameSetEntry : categoryTagNameSetMap.entrySet()) &#123;</span><br><span class="line">            <span class="type">Tag</span> <span class="variable">tag</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Tag</span>();</span><br><span class="line">            tag.setCategory(categoryTagNameSetEntry.getKey());</span><br><span class="line">            tag.setUserId(UserConstant.SYSTEM_USER_ID);</span><br><span class="line">            <span class="keyword">for</span> (String tagName : categoryTagNameSetEntry.getValue()) &#123;</span><br><span class="line">                tag.setTagName(tagName);</span><br><span class="line">                QueryWrapper&lt;Tag&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">                queryWrapper.eq(<span class="string">&quot;category&quot;</span>, tag.getCategory());</span><br><span class="line">                queryWrapper.eq(<span class="string">&quot;tagName&quot;</span>, tag.getTagName());</span><br><span class="line">                <span class="comment">// æ ‡ç­¾ä¸å­˜åœ¨æ‰æ·»åŠ </span></span><br><span class="line">                <span class="type">long</span> <span class="variable">hasCount</span> <span class="operator">=</span> tagService.count(queryWrapper);</span><br><span class="line">                <span class="keyword">if</span> (hasCount &lt; <span class="number">1</span>) &#123;</span><br><span class="line">                    tagService.save(tag);</span><br><span class="line">                    tag.setId(<span class="literal">null</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ ä¸Šå­˜å‚¨æ•°æ®åº“</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">saveData</span><span class="params">()</span> &#123;</span><br><span class="line">        postService.saveBatch(cachedDataList);</span><br><span class="line">        log.info(<span class="string">&quot;å¯¼å…¥æˆåŠŸæ¡æ•°ï¼š&quot;</span> + cachedDataList.size());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-4controller"><a href="#2-4controller" class="headerlink" title="2.4controller"></a>2.4controller</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.github.benmanes.caffeine.cache.Caffeine;</span><br><span class="line"><span class="keyword">import</span> com.github.benmanes.caffeine.cache.LoadingCache;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.annotation.AuthCheck;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.BaseResponse;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.DeleteRequest;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ErrorCode;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ResultUtils;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.constant.CommonConstant;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.exception.BusinessException;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.dto.PostAddRequest;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.dto.PostQueryRequest;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.dto.PostDoThumbRequest;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.dto.PostUpdateRequest;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.Post;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.PostThumb;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.User;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.vo.PostVO;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.PostService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.PostThumbService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.UserService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ArrayBlockingQueue;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.CompletableFuture;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ExecutorService;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ThreadPoolExecutor;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¸–å­æ¥å£</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/post&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PostController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> PostService postService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> PostThumbService postThumbService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// IO å‹çº¿ç¨‹æ± </span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">ExecutorService</span> <span class="variable">ioExecutorService</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ThreadPoolExecutor</span>(<span class="number">4</span>, <span class="number">20</span>, <span class="number">10</span>, TimeUnit.MINUTES,</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">ArrayBlockingQueue</span>&lt;&gt;(<span class="number">10000</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å•å¸–å­è·å–ç¼“å­˜ï¼Œkey ä¸º postIdï¼Œvalue ä¸º post</span></span><br><span class="line">    LoadingCache&lt;Long, Post&gt; postGetCache = Caffeine.newBuilder().expireAfterWrite(<span class="number">12</span>, TimeUnit.HOURS)</span><br><span class="line">            .maximumSize(<span class="number">5_000</span>).build(postId -&gt; postService.getById(postId));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// region å¢åˆ æ”¹æŸ¥</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»º</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> postAddRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Long&gt; <span class="title function_">addPost</span><span class="params">(<span class="meta">@RequestBody</span> PostAddRequest postAddRequest, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (postAddRequest == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Post</span> <span class="variable">post</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Post</span>();</span><br><span class="line">        BeanUtils.copyProperties(postAddRequest, post);</span><br><span class="line">        <span class="comment">// æ ¡éªŒ</span></span><br><span class="line">        postService.validPost(post, <span class="literal">true</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">loginUser</span> <span class="operator">=</span> userService.getLoginUser(request);</span><br><span class="line">        post.setUserId(loginUser.getId());</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> postService.save(post);</span><br><span class="line">        <span class="keyword">if</span> (!result) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.OPERATION_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç§»é™¤ç¼“å­˜</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">newPostId</span> <span class="operator">=</span> post.getId();</span><br><span class="line">        postGetCache.invalidate(newPostId);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(newPostId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> deleteRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/delete&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Boolean&gt; <span class="title function_">deletePost</span><span class="params">(<span class="meta">@RequestBody</span> DeleteRequest deleteRequest, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (deleteRequest == <span class="literal">null</span> || deleteRequest.getId() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.getLoginUser(request);</span><br><span class="line">        <span class="type">long</span> <span class="variable">id</span> <span class="operator">=</span> deleteRequest.getId();</span><br><span class="line">        <span class="comment">// åˆ¤æ–­æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        <span class="type">Post</span> <span class="variable">oldPost</span> <span class="operator">=</span> postService.getById(id);</span><br><span class="line">        <span class="keyword">if</span> (oldPost == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.NOT_FOUND_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä»…æœ¬äººæˆ–ç®¡ç†å‘˜å¯åˆ é™¤</span></span><br><span class="line">        <span class="keyword">if</span> (!oldPost.getUserId().equals(user.getId()) &amp;&amp; !userService.isAdmin(request)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.NO_AUTH_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> postService.removeById(id);</span><br><span class="line">        <span class="comment">// å¼‚æ­¥åˆ é™¤ç‚¹èµä¿¡æ¯</span></span><br><span class="line">        CompletableFuture.runAsync(() -&gt; &#123;</span><br><span class="line">            QueryWrapper&lt;PostThumb&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">            <span class="type">long</span> <span class="variable">postId</span> <span class="operator">=</span> oldPost.getId();</span><br><span class="line">            queryWrapper.eq(<span class="string">&quot;postId&quot;</span>, postId);</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> postThumbService.remove(queryWrapper);</span><br><span class="line">            <span class="keyword">if</span> (!result) &#123;</span><br><span class="line">                log.error(<span class="string">&quot;postThumb delete failed, postId = &#123;&#125;&quot;</span>, postId);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, ioExecutorService);</span><br><span class="line">        <span class="comment">// ç§»é™¤ç¼“å­˜</span></span><br><span class="line">        postGetCache.invalidate(id);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> postUpdateRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/update&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Boolean&gt; <span class="title function_">updatePost</span><span class="params">(<span class="meta">@RequestBody</span> PostUpdateRequest postUpdateRequest,</span></span><br><span class="line"><span class="params">                                            HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (postUpdateRequest == <span class="literal">null</span> || postUpdateRequest.getId() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Post</span> <span class="variable">post</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Post</span>();</span><br><span class="line">        BeanUtils.copyProperties(postUpdateRequest, post);</span><br><span class="line">        <span class="comment">// å‚æ•°æ ¡éªŒ</span></span><br><span class="line">        postService.validPost(post, <span class="literal">false</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.getLoginUser(request);</span><br><span class="line">        <span class="type">long</span> <span class="variable">id</span> <span class="operator">=</span> postUpdateRequest.getId();</span><br><span class="line">        <span class="comment">// åˆ¤æ–­æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        <span class="type">Post</span> <span class="variable">oldPost</span> <span class="operator">=</span> postService.getById(id);</span><br><span class="line">        <span class="keyword">if</span> (oldPost == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.NOT_FOUND_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä»…æœ¬äººæˆ–ç®¡ç†å‘˜å¯ä¿®æ”¹</span></span><br><span class="line">        <span class="keyword">if</span> (!oldPost.getUserId().equals(user.getId()) &amp;&amp; !userService.isAdmin(request)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.NO_AUTH_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> postService.updateById(post);</span><br><span class="line">        <span class="comment">// ç§»é™¤ç¼“å­˜</span></span><br><span class="line">        postGetCache.invalidate(id);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ® id è·å–</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/get&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Post&gt; <span class="title function_">getPostById</span><span class="params">(<span class="type">long</span> id)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (id &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Post</span> <span class="variable">post</span> <span class="operator">=</span> postGetCache.get(id);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(post);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–åˆ—è¡¨ï¼ˆä»…ç®¡ç†å‘˜å¯ä½¿ç”¨ï¼‰</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> postQueryRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AuthCheck(mustRole = &quot;admin&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;List&lt;Post&gt;&gt; <span class="title function_">listPost</span><span class="params">(PostQueryRequest postQueryRequest)</span> &#123;</span><br><span class="line">        <span class="type">Post</span> <span class="variable">postQuery</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Post</span>();</span><br><span class="line">        <span class="keyword">if</span> (postQueryRequest != <span class="literal">null</span>) &#123;</span><br><span class="line">            BeanUtils.copyProperties(postQueryRequest, postQuery);</span><br><span class="line">        &#125;</span><br><span class="line">        QueryWrapper&lt;Post&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;(postQuery);</span><br><span class="line">        List&lt;Post&gt; postList = postService.list(queryWrapper);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(postList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µè·å–åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> postQueryRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/list/page&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Page&lt;PostVO&gt;&gt; <span class="title function_">listPostByPage</span><span class="params">(PostQueryRequest postQueryRequest, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (postQueryRequest == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Post</span> <span class="variable">postQuery</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Post</span>();</span><br><span class="line">        BeanUtils.copyProperties(postQueryRequest, postQuery);</span><br><span class="line">        <span class="type">long</span> <span class="variable">current</span> <span class="operator">=</span> postQueryRequest.getCurrent();</span><br><span class="line">        <span class="type">long</span> <span class="variable">size</span> <span class="operator">=</span> postQueryRequest.getPageSize();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sortField</span> <span class="operator">=</span> postQueryRequest.getSortField();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sortOrder</span> <span class="operator">=</span> postQueryRequest.getSortOrder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> postQuery.getContent();</span><br><span class="line">        <span class="comment">// content éœ€æ”¯æŒæ¨¡ç³Šæœç´¢</span></span><br><span class="line">        postQuery.setContent(<span class="literal">null</span>);</span><br><span class="line">        <span class="comment">// é™åˆ¶çˆ¬è™«</span></span><br><span class="line">        <span class="keyword">if</span> (size &gt; <span class="number">50</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        QueryWrapper&lt;Post&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;(postQuery);</span><br><span class="line">        queryWrapper.like(StringUtils.isNotBlank(content), <span class="string">&quot;content&quot;</span>, content);</span><br><span class="line">        queryWrapper.orderBy(StringUtils.isNotBlank(sortField),</span><br><span class="line">                sortOrder.equals(CommonConstant.SORT_ORDER_ASC), sortField);</span><br><span class="line">        Page&lt;Post&gt; postPage = postService.page(<span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(current, size), queryWrapper);</span><br><span class="line">        Map&lt;Long, List&lt;PostVO&gt;&gt; postIdListMap = postPage.getRecords().stream().map(post -&gt; &#123;</span><br><span class="line">            <span class="type">PostVO</span> <span class="variable">postVO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PostVO</span>();</span><br><span class="line">            BeanUtils.copyProperties(post, postVO);</span><br><span class="line">            postVO.setHasThumb(<span class="literal">false</span>);</span><br><span class="line">            <span class="keyword">return</span> postVO;</span><br><span class="line">        &#125;).collect(Collectors.groupingBy(Post::getId));</span><br><span class="line">        <span class="comment">// å·²ç™»å½•ï¼Œè·å–ç”¨æˆ·ç‚¹èµçŠ¶æ€</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.getLoginUser(request);</span><br><span class="line">            QueryWrapper&lt;PostThumb&gt; postThumbQueryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">            postThumbQueryWrapper.in(<span class="string">&quot;postId&quot;</span>, postIdListMap.keySet());</span><br><span class="line">            postThumbQueryWrapper.eq(<span class="string">&quot;userId&quot;</span>, user.getId());</span><br><span class="line">            List&lt;PostThumb&gt; postThumbList = postThumbService.list(postThumbQueryWrapper);</span><br><span class="line">            postThumbList.forEach(postThumb -&gt;</span><br><span class="line">                    postIdListMap.get(postThumb.getPostId()).get(<span class="number">0</span>).setHasThumb(<span class="literal">true</span>));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// ç”¨æˆ·æœªç™»å½•ï¼Œä¸å¤„ç†</span></span><br><span class="line">        &#125;</span><br><span class="line">        Page&lt;PostVO&gt; postVOPage = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(postPage.getCurrent(), postPage.getSize(), postPage.getTotal());</span><br><span class="line">        postVOPage.setRecords(postIdListMap.values().stream()</span><br><span class="line">                .flatMap(Collection::stream)</span><br><span class="line">                .collect(Collectors.toList()));</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(postVOPage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// endregion</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç‚¹èµ / å–æ¶ˆç‚¹èµ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> postDoThumbRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> resultNum æœ¬æ¬¡ç‚¹èµå˜åŒ–æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/thumb&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Integer&gt; <span class="title function_">postDoThumb</span><span class="params">(<span class="meta">@RequestBody</span> PostDoThumbRequest postDoThumbRequest,</span></span><br><span class="line"><span class="params">                                         HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (postDoThumbRequest == <span class="literal">null</span> || postDoThumbRequest.getPostId() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// å¿…é¡»ç™»å½•</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">User</span> <span class="variable">loginUser</span> <span class="operator">=</span> userService.getLoginUser(request);</span><br><span class="line">        <span class="type">long</span> <span class="variable">postId</span> <span class="operator">=</span> postDoThumbRequest.getPostId();</span><br><span class="line">        <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> postThumbService.doThumb(postId, loginUser);</span><br><span class="line">        <span class="keyword">if</span> (result != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// ç§»é™¤ç¼“å­˜</span></span><br><span class="line">            postGetCache.invalidate(postId);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-5model"><a href="#2-5model" class="headerlink" title="2.5model"></a>2.5model</h4><h5 id="2-5-1model-entity"><a href="#2-5-1model-entity" class="headerlink" title="2.5.1model.entity"></a>2.5.1model.entity</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¸–å­</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@TableName</span> post</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@TableName(value = &quot;post&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Post</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableId(type = IdType.AUTO)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¹´é¾„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ€§åˆ«ï¼ˆ0-ç”·, 1-å¥³ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å­¦å†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String education;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ°ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String place;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * èŒä¸š</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String job;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è”ç³»æ–¹å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String contact;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ„Ÿæƒ…ç»å†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String loveExp;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å†…å®¹ï¼ˆä¸ªäººä»‹ç»ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç…§ç‰‡åœ°å€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String photo;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çŠ¶æ€ï¼ˆ0-å¾…å®¡æ ¸, 1-é€šè¿‡, 2-æ‹’ç»ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer reviewStatus;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®¡æ ¸ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String reviewMessage;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æµè§ˆæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer viewNum;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç‚¹èµæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer thumbNum;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºç”¨æˆ· id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long userId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦åˆ é™¤</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableLogic</span></span><br><span class="line">    <span class="keyword">private</span> Integer isDelete;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="2-5-2model-dto"><a href="#2-5-2model-dto" class="headerlink" title="2.5.2model.dto"></a>2.5.2model.dto</h5><h6 id="2-5-2-1å¸–å­-Excel-å¯¼å…¥å°è£…ç±»"><a href="#2-5-2-1å¸–å­-Excel-å¯¼å…¥å°è£…ç±»" class="headerlink" title="2.5.2.1å¸–å­ Excel å¯¼å…¥å°è£…ç±»"></a>2.5.2.1å¸–å­ Excel å¯¼å…¥å°è£…ç±»</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.annotation.ExcelProperty;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¸–å­ Excel å¯¼å…¥å°è£…ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PostImportDTO</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¹´é¾„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;å¹´é¾„&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ€§åˆ«ï¼ˆ0-ç”·, 1-å¥³ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;æ€§åˆ«&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å­¦å†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;å­¦å†&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String education;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ°ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;åœ°ç‚¹&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String place;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * èŒä¸š</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;èŒä¸š&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String job;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è”ç³»æ–¹å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;è”ç³»æ–¹å¼&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String contact;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ„Ÿæƒ…ç»å†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;æ„Ÿæƒ…ç»å†&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String loveExp;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å†…å®¹ï¼ˆä¸ªäººä»‹ç»ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;ä¸ªäººä»‹ç»&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç…§ç‰‡åœ°å€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;ç…§ç‰‡åœ°å€&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String photo;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="2-5-2-2å¸–å­åˆ›å»ºè¯·æ±‚"><a href="#2-5-2-2å¸–å­åˆ›å»ºè¯·æ±‚" class="headerlink" title="2.5.2.2å¸–å­åˆ›å»ºè¯·æ±‚"></a>2.5.2.2å¸–å­åˆ›å»ºè¯·æ±‚</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ›å»ºè¯·æ±‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@TableName</span> product</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PostAddRequest</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¹´é¾„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ€§åˆ«ï¼ˆ0-ç”·, 1-å¥³ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å­¦å†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String education;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ°ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String place;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * èŒä¸š</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String job;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è”ç³»æ–¹å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String contact;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ„Ÿæƒ…ç»å†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String loveExp;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å†…å®¹ï¼ˆä¸ªäººä»‹ç»ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç…§ç‰‡åœ°å€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String photo;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="2-5-2-3æ›´æ–°è¯·æ±‚"><a href="#2-5-2-3æ›´æ–°è¯·æ±‚" class="headerlink" title="2.5.2.3æ›´æ–°è¯·æ±‚"></a>2.5.2.3æ›´æ–°è¯·æ±‚</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ›´æ–°è¯·æ±‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@TableName</span> product</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PostUpdateRequest</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¹´é¾„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ€§åˆ«ï¼ˆ0-ç”·, 1-å¥³ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å­¦å†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String education;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ°ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String place;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * èŒä¸š</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String job;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è”ç³»æ–¹å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String contact;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ„Ÿæƒ…ç»å†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String loveExp;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å†…å®¹ï¼ˆä¸ªäººä»‹ç»ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç…§ç‰‡åœ°å€</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String photo;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çŠ¶æ€ï¼ˆ0-å¾…å®¡æ ¸, 1-é€šè¿‡, 2-æ‹’ç»ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer reviewStatus;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å®¡æ ¸ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String reviewMessage;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="2-5-2-4æŸ¥è¯¢è¯·æ±‚"><a href="#2-5-2-4æŸ¥è¯¢è¯·æ±‚" class="headerlink" title="2.5.2.4æŸ¥è¯¢è¯·æ±‚"></a>2.5.2.4æŸ¥è¯¢è¯·æ±‚</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.PageRequest;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.EqualsAndHashCode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŸ¥è¯¢è¯·æ±‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper = true)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PostQueryRequest</span> <span class="keyword">extends</span> <span class="title class_">PageRequest</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¹´é¾„</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ€§åˆ«ï¼ˆ0-ç”·, 1-å¥³ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å­¦å†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String education;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åœ°ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String place;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * èŒä¸š</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String job;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è”ç³»æ–¹å¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String contact;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ„Ÿæƒ…ç»å†</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String loveExp;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å†…å®¹ï¼ˆä¸ªäººä»‹ç»ï¼‰ï¼Œæ”¯æŒæ¨¡ç³ŠæŸ¥è¯¢</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çŠ¶æ€ï¼ˆ0-å¾…å®¡æ ¸, 1-é€šè¿‡, 2-æ‹’ç»ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer reviewStatus;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºç”¨æˆ· id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long userId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="2-5-3model-vo"><a href="#2-5-3model-vo" class="headerlink" title="2.5.3model.vo"></a>2.5.3model.vo</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.vo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.Post;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.EqualsAndHashCode;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¸–å­è§†å›¾</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@TableName</span> product</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper = true)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PostVO</span> <span class="keyword">extends</span> <span class="title class_">Post</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦å·²ç‚¹èµ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Boolean hasThumb;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="2-5-4model-enum"><a href="#2-5-4model-enum" class="headerlink" title="2.5.4model.enum"></a>2.5.4model.enum</h5><h6 id="2-5-4-1å¸–å­æ€§åˆ«æšä¸¾"><a href="#2-5-4-1å¸–å­æ€§åˆ«æšä¸¾" class="headerlink" title="2.5.4.1å¸–å­æ€§åˆ«æšä¸¾"></a>2.5.4.1å¸–å­æ€§åˆ«æšä¸¾</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.enums;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¸–å­æ€§åˆ«æšä¸¾</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">PostGenderEnum</span> &#123;</span><br><span class="line"></span><br><span class="line">    MALE(<span class="string">&quot;ç”·&quot;</span>, <span class="number">0</span>),</span><br><span class="line">    FEMALE(<span class="string">&quot;å¥³&quot;</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String text;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line">    PostGenderEnum(String text, <span class="type">int</span> value) &#123;</span><br><span class="line">        <span class="built_in">this</span>.text = text;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å€¼åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Integer&gt; <span class="title function_">getValues</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Arrays.stream(values()).map(item -&gt; item.value).collect(Collectors.toList());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getText</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> text;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="2-5-4-2å¸–å­å®¡æ ¸çŠ¶æ€æšä¸¾"><a href="#2-5-4-2å¸–å­å®¡æ ¸çŠ¶æ€æšä¸¾" class="headerlink" title="2.5.4.2å¸–å­å®¡æ ¸çŠ¶æ€æšä¸¾"></a>2.5.4.2å¸–å­å®¡æ ¸çŠ¶æ€æšä¸¾</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.enums;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¸–å­å®¡æ ¸çŠ¶æ€æšä¸¾</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">PostReviewStatusEnum</span> &#123;</span><br><span class="line"></span><br><span class="line">    REVIEWING(<span class="string">&quot;å¾…å®¡æ ¸&quot;</span>, <span class="number">0</span>),</span><br><span class="line">    PASS(<span class="string">&quot;é€šè¿‡&quot;</span>, <span class="number">1</span>),</span><br><span class="line">    REJECT(<span class="string">&quot;æ‹’ç»&quot;</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String text;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line">    PostReviewStatusEnum(String text, <span class="type">int</span> value) &#123;</span><br><span class="line">        <span class="built_in">this</span>.text = text;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å€¼åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Integer&gt; <span class="title function_">getValues</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Arrays.stream(values()).map(item -&gt; item.value).collect(Collectors.toList());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getText</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> text;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-å¸–å­ç‚¹èµç®¡ç†"><a href="#3-å¸–å­ç‚¹èµç®¡ç†" class="headerlink" title="3.å¸–å­ç‚¹èµç®¡ç†"></a>3.å¸–å­ç‚¹èµç®¡ç†</h3><h4 id="3-1service"><a href="#3-1service" class="headerlink" title="3.1service"></a>3.1service</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.PostThumb;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.IService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.User;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupili</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é’ˆå¯¹è¡¨ã€post_thumb(å¸–å­ç‚¹èµè®°å½•)ã€‘çš„æ•°æ®åº“æ“ä½œService</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PostThumbService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;PostThumb&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç‚¹èµ / å–æ¶ˆç‚¹èµ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> postId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> loginUser</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">doThumb</span><span class="params">(<span class="type">long</span> postId, User loginUser)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-2service-impl"><a href="#3-2service-impl" class="headerlink" title="3.2service.impl"></a>3.2service.impl</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ErrorCode;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.exception.BusinessException;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.Post;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.PostThumb;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.User;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.PostService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.PostThumbService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.mapper.PostThumbMapper;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupili</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é’ˆå¯¹è¡¨ã€post_thumb(å¸–å­ç‚¹èµè®°å½•)ã€‘çš„æ•°æ®åº“æ“ä½œServiceå®ç°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@createDate</span> 2022-09-13 16:04:30</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span>  <span class="title class_">PostThumbServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;PostThumbMapper, PostThumb&gt;</span><br><span class="line">        <span class="keyword">implements</span> <span class="title class_">PostThumbService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> PostService postService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç‚¹èµ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> postId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> loginUser</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">doThumb</span><span class="params">(<span class="type">long</span> postId, User loginUser)</span> &#123;</span><br><span class="line">        <span class="comment">// å¸–å­æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        <span class="type">Post</span> <span class="variable">post</span> <span class="operator">=</span> postService.getById(postId);</span><br><span class="line">        <span class="keyword">if</span> (post == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.NOT_FOUND_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ˜¯å¦å·²ç‚¹èµ</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">userId</span> <span class="operator">=</span> loginUser.getId();</span><br><span class="line">        <span class="comment">// æ¯ä¸ªç”¨æˆ·ä¸²è¡Œç‚¹èµ</span></span><br><span class="line">        <span class="comment">// é”å¿…é¡»è¦åŒ…è£¹ä½äº‹åŠ¡æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">synchronized</span> (String.valueOf(userId).intern()) &#123;</span><br><span class="line">            <span class="keyword">return</span> doThumbInner(userId, postId);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°è£…äº†äº‹åŠ¡çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> postId</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">doThumbInner</span><span class="params">(<span class="type">long</span> userId, <span class="type">long</span> postId)</span> &#123;</span><br><span class="line">        <span class="type">PostThumb</span> <span class="variable">postThumb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PostThumb</span>();</span><br><span class="line">        postThumb.setUserId(userId);</span><br><span class="line">        postThumb.setPostId(postId);</span><br><span class="line">        QueryWrapper&lt;PostThumb&gt; postThumbQueryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;(postThumb);</span><br><span class="line">        <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> <span class="built_in">this</span>.count(postThumbQueryWrapper);</span><br><span class="line">        <span class="type">boolean</span> result;</span><br><span class="line">        <span class="comment">// å·²ç‚¹èµ</span></span><br><span class="line">        <span class="keyword">if</span> (count &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            result = <span class="built_in">this</span>.remove(postThumbQueryWrapper);</span><br><span class="line">            <span class="keyword">if</span> (result) &#123;</span><br><span class="line">                <span class="comment">// å¸–å­ç‚¹èµæ•° - 1</span></span><br><span class="line">                result = postService.update()</span><br><span class="line">                        .eq(<span class="string">&quot;id&quot;</span>, postId)</span><br><span class="line">                        .gt(<span class="string">&quot;thumbNum&quot;</span>, <span class="number">0</span>)</span><br><span class="line">                        .setSql(<span class="string">&quot;thumbNum = thumbNum - 1&quot;</span>)</span><br><span class="line">                        .update();</span><br><span class="line">                <span class="keyword">return</span> result ? -<span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.SYSTEM_ERROR);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// æœªç‚¹èµ</span></span><br><span class="line">            result = <span class="built_in">this</span>.save(postThumb);</span><br><span class="line">            <span class="keyword">if</span> (result) &#123;</span><br><span class="line">                <span class="comment">// å¸–å­ç‚¹èµæ•° + 1</span></span><br><span class="line">                result = postService.update()</span><br><span class="line">                        .eq(<span class="string">&quot;id&quot;</span>, postId)</span><br><span class="line">                        .setSql(<span class="string">&quot;thumbNum = thumbNum + 1&quot;</span>)</span><br><span class="line">                        .update();</span><br><span class="line">                <span class="keyword">return</span> result ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.SYSTEM_ERROR);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-3controller"><a href="#3-3controller" class="headerlink" title="3.3controller"></a>3.3controller</h4><p>å®Œæˆä»£ç åœ¨2.4å¸–å­ç®¡ç†ä¸­</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç‚¹èµ / å–æ¶ˆç‚¹èµ</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> postDoThumbRequest</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> resultNum æœ¬æ¬¡ç‚¹èµå˜åŒ–æ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/thumb&quot;)</span></span><br><span class="line"><span class="keyword">public</span> BaseResponse&lt;Integer&gt; <span class="title function_">postDoThumb</span><span class="params">(<span class="meta">@RequestBody</span> PostDoThumbRequest postDoThumbRequest,</span></span><br><span class="line"><span class="params">                                     HttpServletRequest request)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (postDoThumbRequest == <span class="literal">null</span> || postDoThumbRequest.getPostId() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¿…é¡»ç™»å½•</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">User</span> <span class="variable">loginUser</span> <span class="operator">=</span> userService.getLoginUser(request);</span><br><span class="line">    <span class="type">long</span> <span class="variable">postId</span> <span class="operator">=</span> postDoThumbRequest.getPostId();</span><br><span class="line">    <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> postThumbService.doThumb(postId, loginUser);</span><br><span class="line">    <span class="keyword">if</span> (result != <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// ç§»é™¤ç¼“å­˜</span></span><br><span class="line">        postGetCache.invalidate(postId);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ResultUtils.success(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-4model"><a href="#3-4model" class="headerlink" title="3.4model"></a>3.4model</h4><h5 id="3-4-1model-entity"><a href="#3-4-1model-entity" class="headerlink" title="3.4.1model.entity"></a>3.4.1model.entity</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.IdType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableField;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableId;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableLogic;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableName;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å¸–å­ç‚¹èµè®°å½•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@TableName</span> post_thumb</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@TableName(value =&quot;post_thumb&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PostThumb</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableId(type = IdType.AUTO)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¸–å­ id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long postId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºç”¨æˆ· id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long userId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="3-4-2model-dto"><a href="#3-4-2model-dto" class="headerlink" title="3.4.2model.dto"></a>3.4.2model.dto</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç‚¹èµ / å–æ¶ˆç‚¹èµè¯·æ±‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PostDoThumbRequest</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¸–å­ id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">long</span> postId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-æœç´¢è®°å½•ç®¡ç†"><a href="#4-æœç´¢è®°å½•ç®¡ç†" class="headerlink" title="4.æœç´¢è®°å½•ç®¡ç†"></a>4.æœç´¢è®°å½•ç®¡ç†</h3><h4 id="4-1service"><a href="#4-1service" class="headerlink" title="4.1service"></a>4.1service</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.IService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.SearchHistory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@author</span> yupili</span></span><br><span class="line"><span class="comment">* <span class="doctag">@description</span> é’ˆå¯¹è¡¨ã€search_history(æœç´¢è®°å½•)ã€‘çš„æ•°æ®åº“æ“ä½œService</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SearchHistoryService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;SearchHistory&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ æœç´¢è®°å½•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> word</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">addSearchHistory</span><span class="params">(String word)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-2service-impl"><a href="#4-2service-impl" class="headerlink" title="4.2service.impl"></a>4.2service.impl</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ErrorCode;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.exception.BusinessException;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.mapper.SearchHistoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.SearchHistory;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.SearchHistoryService;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupili</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é’ˆå¯¹è¡¨ã€search_history(æœç´¢è®°å½•)ã€‘çš„æ•°æ®åº“æ“ä½œServiceå®ç°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SearchHistoryServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;SearchHistoryMapper, SearchHistory&gt;</span><br><span class="line">        <span class="keyword">implements</span> <span class="title class_">SearchHistoryService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">addSearchHistory</span><span class="params">(String word)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isEmpty(word)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        QueryWrapper&lt;SearchHistory&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        queryWrapper.eq(<span class="string">&quot;word&quot;</span>, word);</span><br><span class="line">        <span class="keyword">synchronized</span> (word.intern()) &#123;</span><br><span class="line">            <span class="type">SearchHistory</span> <span class="variable">searchHistory</span> <span class="operator">=</span> <span class="built_in">this</span>.getOne(queryWrapper);</span><br><span class="line">            <span class="comment">// æ— è®°å½•åˆ™æ’å…¥</span></span><br><span class="line">            <span class="keyword">if</span> (searchHistory == <span class="literal">null</span>) &#123;</span><br><span class="line">                searchHistory = <span class="keyword">new</span> <span class="title class_">SearchHistory</span>();</span><br><span class="line">                searchHistory.setWord(word);</span><br><span class="line">                searchHistory.setNum(<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">this</span>.save(searchHistory);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// æœ‰è®°å½•åˆ™æ¬¡æ•° + 1</span></span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">this</span>.lambdaUpdate()</span><br><span class="line">                        .eq(SearchHistory::getWord, word)</span><br><span class="line">                        .set(SearchHistory::getNum, searchHistory.getNum() + <span class="number">1</span>)</span><br><span class="line">                        .update();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-3controller"><a href="#4-3controller" class="headerlink" title="4.3controller"></a>4.3controller</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.annotation.AuthCheck;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.BaseResponse;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.DeleteRequest;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ErrorCode;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ResultUtils;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.exception.BusinessException;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.dto.SearchHistoryQueryRequest;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.SearchHistory;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.SearchHistoryService;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŸ¥çœ‹æœç´¢è®°å½•æ¥å£</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/search_history&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SearchHistoryController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> SearchHistoryService searchHistoryService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»º</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> tagSearchHistory</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Boolean&gt; <span class="title function_">addSearchHistory</span><span class="params">(<span class="meta">@RequestBody</span> SearchHistory tagSearchHistory)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (tagSearchHistory == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">word</span> <span class="operator">=</span> tagSearchHistory.getWord();</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(searchHistoryService.addSearchHistory(word));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> deleteRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AuthCheck(mustRole = &quot;admin&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/delete&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Boolean&gt; <span class="title function_">deleteSearchHistory</span><span class="params">(<span class="meta">@RequestBody</span> DeleteRequest deleteRequest)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (deleteRequest == <span class="literal">null</span> || deleteRequest.getId() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">id</span> <span class="operator">=</span> deleteRequest.getId();</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> searchHistoryService.removeById(id);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µè·å–åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> searchHistoryQueryRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AuthCheck(mustRole = &quot;admin&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/list/page&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Page&lt;SearchHistory&gt;&gt; <span class="title function_">listSearchHistoryByPage</span><span class="params">(</span></span><br><span class="line"><span class="params">            SearchHistoryQueryRequest searchHistoryQueryRequest)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">current</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="type">long</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">        QueryWrapper&lt;SearchHistory&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span> (searchHistoryQueryRequest != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// æ ¹æ®æ ‡ç­¾åç§°æ¨¡ç³ŠæŸ¥è¯¢</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">word</span> <span class="operator">=</span> searchHistoryQueryRequest.getWord();</span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isNotBlank(word)) &#123;</span><br><span class="line">                queryWrapper.like(<span class="string">&quot;word&quot;</span>, word);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Page&lt;SearchHistory&gt; searchHistoryPage = searchHistoryService.page(<span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(current, size), queryWrapper);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(searchHistoryPage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4-4model"><a href="#4-4model" class="headerlink" title="4.4model"></a>4.4model</h4><h5 id="4-4-1model-entity"><a href="#4-4-1model-entity" class="headerlink" title="4.4.1model.entity"></a>4.4.1model.entity</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.IdType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableField;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableId;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableLogic;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableName;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æœç´¢è®°å½•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@TableName</span> search_history</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@TableName(value =&quot;search_history&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SearchHistory</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableId(type = IdType.AUTO)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœç´¢è¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String word;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœç´¢æ¬¡æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer num;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦åˆ é™¤</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableLogic</span></span><br><span class="line">    <span class="keyword">private</span> Integer isDelete;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="4-4-2model-dto"><a href="#4-4-2model-dto" class="headerlink" title="4.4.2model.dto"></a>4.4.2model.dto</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.PageRequest;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.EqualsAndHashCode;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŸ¥è¯¢è¯·æ±‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper = true)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SearchHistoryQueryRequest</span> <span class="keyword">extends</span> <span class="title class_">PageRequest</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æœç´¢å…³é”®è¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String word;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-æ ‡ç­¾ç®¡ç†"><a href="#5-æ ‡ç­¾ç®¡ç†" class="headerlink" title="5.æ ‡ç­¾ç®¡ç†"></a>5.æ ‡ç­¾ç®¡ç†</h3><h4 id="5-1service"><a href="#5-1service" class="headerlink" title="5.1service"></a>5.1service</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.Tag;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.IService;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@author</span> yupili</span></span><br><span class="line"><span class="comment">* <span class="doctag">@description</span> é’ˆå¯¹è¡¨ã€tag(æ ‡ç­¾)ã€‘çš„æ•°æ®åº“æ“ä½œService</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">TagService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;Tag&gt; &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-2service-impl"><a href="#5-2service-impl" class="headerlink" title="5.2service.impl"></a>5.2service.impl</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.Tag;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.TagService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.mapper.TagMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@author</span> yupili</span></span><br><span class="line"><span class="comment">* <span class="doctag">@description</span> é’ˆå¯¹è¡¨ã€tag(æ ‡ç­¾)ã€‘çš„æ•°æ®åº“æ“ä½œServiceå®ç°</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TagServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;TagMapper, Tag&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">TagService</span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-3controller"><a href="#5-3controller" class="headerlink" title="5.3controller"></a>5.3controller</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.github.benmanes.caffeine.cache.Cache;</span><br><span class="line"><span class="keyword">import</span> com.github.benmanes.caffeine.cache.Caffeine;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.annotation.AuthCheck;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.BaseResponse;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.DeleteRequest;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ErrorCode;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ResultUtils;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.exception.BusinessException;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.dto.TagQueryRequest;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.Tag;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.User;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.enums.TagCategoryEnum;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.TagService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.UserService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ ‡ç­¾æ¥å£</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/tag&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TagController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> TagService tagService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// TagMap ç¼“å­˜</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> Cache&lt;String, Map&lt;String, List&lt;Tag&gt;&gt;&gt; tagMapCache = Caffeine.newBuilder().build();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ•´ä¸ª TagMap ç¼“å­˜ key</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">FULL_TAG_MAP_KEY</span> <span class="operator">=</span> <span class="string">&quot;f&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»º</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> tag</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AuthCheck(mustRole = &quot;admin&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Long&gt; <span class="title function_">addTag</span><span class="params">(<span class="meta">@RequestBody</span> Tag tag, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (tag == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">tagName</span> <span class="operator">=</span> tag.getTagName();</span><br><span class="line">        <span class="type">String</span> <span class="variable">category</span> <span class="operator">=</span> tag.getCategory();</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isAllBlank(tagName, category)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        tagService.count();</span><br><span class="line">        <span class="type">User</span> <span class="variable">loginUser</span> <span class="operator">=</span> userService.getLoginUser(request);</span><br><span class="line">        tag.setUserId(loginUser.getId());</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> tagService.save(tag);</span><br><span class="line">        <span class="keyword">if</span> (!result) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.OPERATION_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ¸…é™¤ç¼“å­˜</span></span><br><span class="line">        tagMapCache.invalidate(FULL_TAG_MAP_KEY);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(tag.getId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> deleteRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AuthCheck(mustRole = &quot;admin&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/delete&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Boolean&gt; <span class="title function_">deleteTag</span><span class="params">(<span class="meta">@RequestBody</span> DeleteRequest deleteRequest)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (deleteRequest == <span class="literal">null</span> || deleteRequest.getId() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">id</span> <span class="operator">=</span> deleteRequest.getId();</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> tagService.removeById(id);</span><br><span class="line">        <span class="comment">// æ¸…é™¤ç¼“å­˜</span></span><br><span class="line">        tagMapCache.invalidate(FULL_TAG_MAP_KEY);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–æ‰€æœ‰æ ‡ç­¾åˆ†ç»„</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/get/map&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Map&lt;String, List&lt;Tag&gt;&gt;&gt; <span class="title function_">getTagMap</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;Tag&gt; tagList = tagService.list();</span><br><span class="line">        <span class="keyword">if</span> (tagList == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.SYSTEM_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä¼˜å…ˆå–ç¼“å­˜</span></span><br><span class="line">        Map&lt;String, List&lt;Tag&gt;&gt; tagMap = tagMapCache.get(FULL_TAG_MAP_KEY, key -&gt; tagList.stream().map(tag -&gt; &#123;</span><br><span class="line">            <span class="comment">// ç²¾ç®€</span></span><br><span class="line">            <span class="type">Tag</span> <span class="variable">newTag</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Tag</span>();</span><br><span class="line">            newTag.setTagName(tag.getTagName());</span><br><span class="line">            newTag.setCategory(tag.getCategory());</span><br><span class="line">            newTag.setPostNum(tag.getPostNum());</span><br><span class="line">            <span class="keyword">return</span> newTag;</span><br><span class="line">            <span class="comment">// æŒ‰ç±»åˆ«åˆ†ç»„</span></span><br><span class="line">        &#125;).collect(Collectors.groupingBy(Tag::getCategory)));</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(tagMap);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µæŸ¥è¯¢æ ‡ç­¾ï¼ˆä»…ç®¡ç†å‘˜å¯è§ï¼‰</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/list/page&quot;)</span></span><br><span class="line">    <span class="meta">@AuthCheck(mustRole = &quot;admin&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Page&lt;Tag&gt;&gt; <span class="title function_">listTagByPage</span><span class="params">(TagQueryRequest tagQueryRequest)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (tagQueryRequest == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">current</span> <span class="operator">=</span> tagQueryRequest.getCurrent();</span><br><span class="line">        <span class="type">long</span> <span class="variable">size</span> <span class="operator">=</span> tagQueryRequest.getPageSize();</span><br><span class="line">        <span class="type">String</span> <span class="variable">category</span> <span class="operator">=</span> tagQueryRequest.getCategory();</span><br><span class="line">        <span class="type">String</span> <span class="variable">tagName</span> <span class="operator">=</span> tagQueryRequest.getTagName();</span><br><span class="line">        QueryWrapper&lt;Tag&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(category)) &#123;</span><br><span class="line">            queryWrapper.eq(<span class="string">&quot;category&quot;</span>, category);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(tagName)) &#123;</span><br><span class="line">            queryWrapper.like(<span class="string">&quot;tagName&quot;</span>, tagName);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// é»˜è®¤æŒ‰å¸–å­ä½¿ç”¨æ•°é™åºæ’åº</span></span><br><span class="line">        queryWrapper.orderByDesc(<span class="string">&quot;postNum&quot;</span>);</span><br><span class="line">        Page&lt;Tag&gt; tagPage = tagService.page(<span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(current, size), queryWrapper);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(tagPage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µæŸ¥è¯¢æ ‡ç­¾ï¼ˆä»…ç®¡ç†å‘˜å¯è§ï¼‰</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/category/list&quot;)</span></span><br><span class="line">    <span class="meta">@AuthCheck(mustRole = &quot;admin&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;List&lt;String&gt;&gt; <span class="title function_">listTagCategory</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(TagCategoryEnum.getValues());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5-4model"><a href="#5-4model" class="headerlink" title="5.4model"></a>5.4model</h4><h5 id="5-4-1model-entity"><a href="#5-4-1model-entity" class="headerlink" title="5.4.1model.entity"></a>5.4.1model.entity</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.IdType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableField;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableId;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableLogic;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableName;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ ‡ç­¾</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@TableName</span> tag</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@TableName(value =&quot;tag&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Tag</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableId(type = IdType.AUTO)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String category;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ‡ç­¾åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String tagName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¸–å­ä½¿ç”¨æ ‡ç­¾æ¬¡æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long postNum;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºç”¨æˆ· id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long userId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦åˆ é™¤</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableLogic</span></span><br><span class="line">    <span class="keyword">private</span> Integer isDelete;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="5-4-2model-dto"><a href="#5-4-2model-dto" class="headerlink" title="5.4.2model.dto"></a>5.4.2model.dto</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.PageRequest;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.EqualsAndHashCode;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŸ¥è¯¢è¯·æ±‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper = true)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TagQueryRequest</span> <span class="keyword">extends</span> <span class="title class_">PageRequest</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†ç±»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String category;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ‡ç­¾åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String tagName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºç”¨æˆ· id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long userId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="5-4-3model-enum"><a href="#5-4-3model-enum" class="headerlink" title="5.4.3model.enum"></a>5.4.3model.enum</h5><h6 id="5-4-3-1æ ‡ç­¾åˆ†ç±»æšä¸¾"><a href="#5-4-3-1æ ‡ç­¾åˆ†ç±»æšä¸¾" class="headerlink" title="5.4.3.1æ ‡ç­¾åˆ†ç±»æšä¸¾"></a>5.4.3.1æ ‡ç­¾åˆ†ç±»æšä¸¾</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.enums;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ ‡ç­¾åˆ†ç±»æšä¸¾</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">TagCategoryEnum</span> &#123;</span><br><span class="line"></span><br><span class="line">    EDUCATION(<span class="string">&quot;å­¦å†&quot;</span>),</span><br><span class="line">    PLACE(<span class="string">&quot;åœ°ç‚¹&quot;</span>),</span><br><span class="line">    JOB(<span class="string">&quot;èŒä¸š&quot;</span>),</span><br><span class="line">    LOVE_EXP(<span class="string">&quot;æ„Ÿæƒ…ç»å†&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String value;</span><br><span class="line"></span><br><span class="line">    TagCategoryEnum(String value) &#123;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å€¼åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;String&gt; <span class="title function_">getValues</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Arrays.stream(values()).map(item -&gt; item.value).collect(Collectors.toList());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-æ ‡ç­¾æœç´¢è®°å½•ç®¡ç†"><a href="#6-æ ‡ç­¾æœç´¢è®°å½•ç®¡ç†" class="headerlink" title="6.æ ‡ç­¾æœç´¢è®°å½•ç®¡ç†"></a>6.æ ‡ç­¾æœç´¢è®°å½•ç®¡ç†</h3><h4 id="6-1service"><a href="#6-1service" class="headerlink" title="6.1service"></a>6.1service</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.IService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.TagSearchHistory;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupili</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é’ˆå¯¹è¡¨ã€tag_search_history(æ ‡ç­¾ç­›é€‰è®°å½•)ã€‘çš„æ•°æ®åº“æ“ä½œService</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">TagSearchHistoryService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;TagSearchHistory&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ·»åŠ æ ‡ç­¾æœç´¢è®°å½•</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> tagName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">addTagSearchHistory</span><span class="params">(String tagName)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="6-2service-impl"><a href="#6-2service-impl" class="headerlink" title="6.2service.impl"></a>6.2service.impl</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ErrorCode;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.exception.BusinessException;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.mapper.TagSearchHistoryMapper;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.TagSearchHistory;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.TagSearchHistoryService;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupili</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é’ˆå¯¹è¡¨ã€tag_search_history(æ ‡ç­¾ç­›é€‰è®°å½•)ã€‘çš„æ•°æ®åº“æ“ä½œServiceå®ç°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TagSearchHistoryServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;TagSearchHistoryMapper, TagSearchHistory&gt;</span><br><span class="line">        <span class="keyword">implements</span> <span class="title class_">TagSearchHistoryService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">addTagSearchHistory</span><span class="params">(String tagName)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isEmpty(tagName)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        QueryWrapper&lt;TagSearchHistory&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        queryWrapper.eq(<span class="string">&quot;tagName&quot;</span>, tagName);</span><br><span class="line">        <span class="keyword">synchronized</span> (tagName.intern()) &#123;</span><br><span class="line">            <span class="type">TagSearchHistory</span> <span class="variable">tagSearchHistory</span> <span class="operator">=</span> <span class="built_in">this</span>.getOne(queryWrapper);</span><br><span class="line">            <span class="comment">// æ— è®°å½•åˆ™æ’å…¥</span></span><br><span class="line">            <span class="keyword">if</span> (tagSearchHistory == <span class="literal">null</span>) &#123;</span><br><span class="line">                tagSearchHistory = <span class="keyword">new</span> <span class="title class_">TagSearchHistory</span>();</span><br><span class="line">                tagSearchHistory.setTagName(tagName);</span><br><span class="line">                tagSearchHistory.setNum(<span class="number">1</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">this</span>.save(tagSearchHistory);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// æœ‰è®°å½•åˆ™æ¬¡æ•° + 1</span></span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">this</span>.lambdaUpdate()</span><br><span class="line">                        .eq(TagSearchHistory::getTagName, tagName)</span><br><span class="line">                        .setSql(<span class="string">&quot;num = num + 1&quot;</span>)</span><br><span class="line">                        .update();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="6-3controller"><a href="#6-3controller" class="headerlink" title="6.3controller"></a>6.3controller</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.annotation.AuthCheck;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.BaseResponse;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.DeleteRequest;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ErrorCode;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ResultUtils;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.exception.BusinessException;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.dto.TagSearchHistoryQueryRequest;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.TagSearchHistory;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.TagSearchHistoryService;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ ‡ç­¾ç­›é€‰è®°å½•æ¥å£</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/tag_search_history&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TagSearchHistoryController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> TagSearchHistoryService tagSearchHistoryService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»º</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> tagSearchHistory</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Boolean&gt; <span class="title function_">addTagSearchHistory</span><span class="params">(<span class="meta">@RequestBody</span> TagSearchHistory tagSearchHistory)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (tagSearchHistory == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">tagName</span> <span class="operator">=</span> tagSearchHistory.getTagName();</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(tagSearchHistoryService.addTagSearchHistory(tagName));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> deleteRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/delete&quot;)</span></span><br><span class="line">    <span class="meta">@AuthCheck(mustRole = &quot;admin&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Boolean&gt; <span class="title function_">deleteTagSearchHistory</span><span class="params">(<span class="meta">@RequestBody</span> DeleteRequest deleteRequest)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (deleteRequest == <span class="literal">null</span> || deleteRequest.getId() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">id</span> <span class="operator">=</span> deleteRequest.getId();</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> tagSearchHistoryService.removeById(id);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µè·å–åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> tagSearchHistoryQueryRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AuthCheck(mustRole = &quot;admin&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/list/page&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Page&lt;TagSearchHistory&gt;&gt; <span class="title function_">listTagSearchHistoryByPage</span><span class="params">(</span></span><br><span class="line"><span class="params">            TagSearchHistoryQueryRequest tagSearchHistoryQueryRequest)</span> &#123;</span><br><span class="line">        <span class="type">long</span> <span class="variable">current</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="type">long</span> <span class="variable">size</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">        QueryWrapper&lt;TagSearchHistory&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span> (tagSearchHistoryQueryRequest != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// æ ¹æ®æ ‡ç­¾åç§°æ¨¡ç³ŠæŸ¥è¯¢</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">tagName</span> <span class="operator">=</span> tagSearchHistoryQueryRequest.getTagName();</span><br><span class="line">            <span class="keyword">if</span> (StringUtils.isNotBlank(tagName)) &#123;</span><br><span class="line">                queryWrapper.like(<span class="string">&quot;tagName&quot;</span>, tagName);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        Page&lt;TagSearchHistory&gt; tagSearchHistoryPage = tagSearchHistoryService.page(<span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(current, size),</span><br><span class="line">                queryWrapper);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(tagSearchHistoryPage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// endregion</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="6-4model"><a href="#6-4model" class="headerlink" title="6.4model"></a>6.4model</h4><h5 id="6-4-1model-entity"><a href="#6-4-1model-entity" class="headerlink" title="6.4.1model.entity"></a>6.4.1model.entity</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.IdType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableField;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableId;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableLogic;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableName;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ ‡ç­¾ç­›é€‰è®°å½•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@TableName</span> tag_search_history</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@TableName(value =&quot;tag_search_history&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TagSearchHistory</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableId(type = IdType.AUTO)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç­›é€‰æ ‡ç­¾åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String tagName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¬¡æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer num;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦åˆ é™¤</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableLogic</span></span><br><span class="line">    <span class="keyword">private</span> Integer isDelete;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="6-4-2model-dto"><a href="#6-4-2model-dto" class="headerlink" title="6.4.2model.dto"></a>6.4.2model.dto</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.PageRequest;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.EqualsAndHashCode;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŸ¥è¯¢è¯·æ±‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper = true)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TagSearchHistoryQueryRequest</span> <span class="keyword">extends</span> <span class="title class_">PageRequest</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç­›é€‰æ ‡ç­¾åç§°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String tagName;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-ä¸¾æŠ¥ç®¡ç†"><a href="#7-ä¸¾æŠ¥ç®¡ç†" class="headerlink" title="7.ä¸¾æŠ¥ç®¡ç†"></a>7.ä¸¾æŠ¥ç®¡ç†</h3><h4 id="7-1service"><a href="#7-1service" class="headerlink" title="7.1service"></a>7.1service</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.Report;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.IService;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupili</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é’ˆå¯¹è¡¨ã€report(ä¸¾æŠ¥)ã€‘çš„æ•°æ®åº“æ“ä½œService</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">ReportService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;Report&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¡éªŒ</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> report</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> add</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">validReport</span><span class="params">(Report report, <span class="type">boolean</span> add)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="7-2service-impl"><a href="#7-2service-impl" class="headerlink" title="7.2service.impl"></a>7.2service.impl</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ErrorCode;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.exception.BusinessException;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.enums.ReportStatusEnum;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.ReportService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.Report;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.mapper.ReportMapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupili</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> é’ˆå¯¹è¡¨ã€report(ä¸¾æŠ¥)ã€‘çš„æ•°æ®åº“æ“ä½œServiceå®ç°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReportServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;ReportMapper, Report&gt; <span class="keyword">implements</span> <span class="title class_">ReportService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">validReport</span><span class="params">(Report report, <span class="type">boolean</span> add)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (report == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> report.getContent();</span><br><span class="line">        <span class="type">Long</span> <span class="variable">reportedId</span> <span class="operator">=</span> report.getReportedId();</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">status</span> <span class="operator">=</span> report.getStatus();</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(content) &amp;&amp; content.length() &gt; <span class="number">1024</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR, <span class="string">&quot;å†…å®¹è¿‡é•¿&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// åˆ›å»ºæ—¶å¿…é¡»æŒ‡å®š</span></span><br><span class="line">        <span class="keyword">if</span> (add) &#123;</span><br><span class="line">            <span class="keyword">if</span> (reportedId == <span class="literal">null</span> || reportedId &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (status != <span class="literal">null</span> &amp;&amp; !ReportStatusEnum.getValues().contains(status)) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="7-3controller"><a href="#7-3controller" class="headerlink" title="7.3controller"></a>7.3controller</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.pagination.Page;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.annotation.AuthCheck;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.BaseResponse;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.DeleteRequest;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ErrorCode;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.ResultUtils;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.constant.CommonConstant;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.exception.BusinessException;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.dto.ReportAddRequest;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.dto.ReportQueryRequest;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.dto.ReportUpdateRequest;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.Post;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.Report;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.entity.User;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.model.enums.ReportStatusEnum;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.PostService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.ReportService;</span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.service.UserService;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeanUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¸¾æŠ¥æ¥å£</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/report&quot;)</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReportController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> ReportService reportService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> PostService postService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// region å¢åˆ æ”¹æŸ¥</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»º</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> reportAddRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Long&gt; <span class="title function_">addReport</span><span class="params">(<span class="meta">@RequestBody</span> ReportAddRequest reportAddRequest, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (reportAddRequest == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Report</span> <span class="variable">report</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Report</span>();</span><br><span class="line">        BeanUtils.copyProperties(reportAddRequest, report);</span><br><span class="line">        reportService.validReport(report, <span class="literal">true</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">loginUser</span> <span class="operator">=</span> userService.getLoginUser(request);</span><br><span class="line">        <span class="type">Post</span> <span class="variable">post</span> <span class="operator">=</span> postService.getById(report.getReportedId());</span><br><span class="line">        <span class="keyword">if</span> (post == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR, <span class="string">&quot;ä¸¾æŠ¥å¯¹è±¡ä¸å­˜åœ¨&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        report.setReportedUserId(post.getUserId());</span><br><span class="line">        report.setUserId(loginUser.getId());</span><br><span class="line">        report.setStatus(ReportStatusEnum.DEFAULT.getValue());</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> reportService.save(report);</span><br><span class="line">        <span class="keyword">if</span> (!result) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.OPERATION_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">long</span> <span class="variable">newReportId</span> <span class="operator">=</span> report.getId();</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(newReportId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> deleteRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/delete&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Boolean&gt; <span class="title function_">deleteReport</span><span class="params">(<span class="meta">@RequestBody</span> DeleteRequest deleteRequest, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (deleteRequest == <span class="literal">null</span> || deleteRequest.getId() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.getLoginUser(request);</span><br><span class="line">        <span class="type">long</span> <span class="variable">id</span> <span class="operator">=</span> deleteRequest.getId();</span><br><span class="line">        <span class="comment">// åˆ¤æ–­æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        <span class="type">Report</span> <span class="variable">oldReport</span> <span class="operator">=</span> reportService.getById(id);</span><br><span class="line">        <span class="keyword">if</span> (oldReport == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.NOT_FOUND_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä»…æœ¬äººæˆ–ç®¡ç†å‘˜å¯åˆ é™¤</span></span><br><span class="line">        <span class="keyword">if</span> (!oldReport.getUserId().equals(user.getId()) &amp;&amp; !userService.isAdmin(request)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.NO_AUTH_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">b</span> <span class="operator">=</span> reportService.removeById(id);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> reportUpdateRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/update&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Boolean&gt; <span class="title function_">updateReport</span><span class="params">(<span class="meta">@RequestBody</span> ReportUpdateRequest reportUpdateRequest, HttpServletRequest request)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (reportUpdateRequest == <span class="literal">null</span> || reportUpdateRequest.getId() &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Report</span> <span class="variable">report</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Report</span>();</span><br><span class="line">        BeanUtils.copyProperties(reportUpdateRequest, report);</span><br><span class="line">        reportService.validReport(report, <span class="literal">false</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.getLoginUser(request);</span><br><span class="line">        <span class="type">long</span> <span class="variable">id</span> <span class="operator">=</span> reportUpdateRequest.getId();</span><br><span class="line">        <span class="comment">// åˆ¤æ–­æ˜¯å¦å­˜åœ¨</span></span><br><span class="line">        <span class="type">Report</span> <span class="variable">oldReport</span> <span class="operator">=</span> reportService.getById(id);</span><br><span class="line">        <span class="keyword">if</span> (oldReport == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.NOT_FOUND_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ä»…æœ¬äººæˆ–ç®¡ç†å‘˜å¯ä¿®æ”¹</span></span><br><span class="line">        <span class="keyword">if</span> (!oldReport.getUserId().equals(user.getId()) &amp;&amp; !userService.isAdmin(request)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.NO_AUTH_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> reportService.updateById(report);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ® id è·å–</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/get&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Report&gt; <span class="title function_">getReportById</span><span class="params">(<span class="type">long</span> id)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (id &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Report</span> <span class="variable">report</span> <span class="operator">=</span> reportService.getById(id);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(report);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–åˆ—è¡¨ï¼ˆä»…ç®¡ç†å‘˜å¯ä½¿ç”¨ï¼‰</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> reportQueryRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@AuthCheck(mustRole = &quot;admin&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/list&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;List&lt;Report&gt;&gt; <span class="title function_">listReport</span><span class="params">(ReportQueryRequest reportQueryRequest)</span> &#123;</span><br><span class="line">        <span class="type">Report</span> <span class="variable">reportQuery</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Report</span>();</span><br><span class="line">        <span class="keyword">if</span> (reportQueryRequest != <span class="literal">null</span>) &#123;</span><br><span class="line">            BeanUtils.copyProperties(reportQueryRequest, reportQuery);</span><br><span class="line">        &#125;</span><br><span class="line">        QueryWrapper&lt;Report&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;(reportQuery);</span><br><span class="line">        List&lt;Report&gt; reportList = reportService.list(queryWrapper);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(reportList);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ†é¡µè·å–åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> reportQueryRequest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/list/page&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> BaseResponse&lt;Page&lt;Report&gt;&gt; <span class="title function_">listReportByPage</span><span class="params">(ReportQueryRequest reportQueryRequest)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (reportQueryRequest == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Report</span> <span class="variable">reportQuery</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Report</span>();</span><br><span class="line">        BeanUtils.copyProperties(reportQueryRequest, reportQuery);</span><br><span class="line">        <span class="type">long</span> <span class="variable">current</span> <span class="operator">=</span> reportQueryRequest.getCurrent();</span><br><span class="line">        <span class="type">long</span> <span class="variable">size</span> <span class="operator">=</span> reportQueryRequest.getPageSize();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sortField</span> <span class="operator">=</span> reportQueryRequest.getSortField();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sortOrder</span> <span class="operator">=</span> reportQueryRequest.getSortOrder();</span><br><span class="line">        <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> reportQuery.getContent();</span><br><span class="line">        <span class="comment">// content éœ€æ”¯æŒæ¨¡ç³Šæœç´¢</span></span><br><span class="line">        reportQuery.setContent(<span class="literal">null</span>);</span><br><span class="line">        <span class="comment">// é™åˆ¶çˆ¬è™«</span></span><br><span class="line">        <span class="keyword">if</span> (size &gt; <span class="number">50</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BusinessException</span>(ErrorCode.PARAMS_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        QueryWrapper&lt;Report&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;(reportQuery);</span><br><span class="line">        queryWrapper.like(StringUtils.isNotBlank(content), <span class="string">&quot;content&quot;</span>, content);</span><br><span class="line">        queryWrapper.orderBy(StringUtils.isNotBlank(sortField), sortOrder.equals(CommonConstant.SORT_ORDER_ASC), sortField);</span><br><span class="line">        Page&lt;Report&gt; reportPage = reportService.page(<span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(current, size), queryWrapper);</span><br><span class="line">        <span class="keyword">return</span> ResultUtils.success(reportPage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// endregion</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="7-4model"><a href="#7-4model" class="headerlink" title="7.4model"></a>7.4model</h4><h5 id="7-4-1model-entity"><a href="#7-4-1model-entity" class="headerlink" title="7.4.1model.entity"></a>7.4.1model.entity</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.entity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.IdType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableField;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableId;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableLogic;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.TableName;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¸¾æŠ¥</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@TableName</span> report</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@TableName(value =&quot;report&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Report</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableId(type = IdType.AUTO)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å†…å®¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¢«ä¸¾æŠ¥å¯¹è±¡ id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long reportedId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¢«ä¸¾æŠ¥ç”¨æˆ· id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long reportedUserId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çŠ¶æ€ï¼ˆ0-æœªå¤„ç†, 1-å·²å¤„ç†ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer status;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºç”¨æˆ· id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long userId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºæ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ›´æ–°æ—¶é—´</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ˜¯å¦åˆ é™¤</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableLogic</span></span><br><span class="line">    <span class="keyword">private</span> Integer isDelete;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="7-4-2model-dto"><a href="#7-4-2model-dto" class="headerlink" title="7.4.2model.dto"></a>7.4.2model.dto</h5><h6 id="7-4-2-1åˆ›å»ºè¯·æ±‚"><a href="#7-4-2-1åˆ›å»ºè¯·æ±‚" class="headerlink" title="7.4.2.1åˆ›å»ºè¯·æ±‚"></a>7.4.2.1åˆ›å»ºè¯·æ±‚</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ›å»ºè¯·æ±‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@TableName</span> report</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReportAddRequest</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å†…å®¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¢«ä¸¾æŠ¥å¯¹è±¡ id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long reportedId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="7-4-2-2ä¿®æ”¹è¯·æ±‚"><a href="#7-4-2-2ä¿®æ”¹è¯·æ±‚" class="headerlink" title="7.4.2.2ä¿®æ”¹è¯·æ±‚"></a>7.4.2.2ä¿®æ”¹è¯·æ±‚</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ›´æ–°è¯·æ±‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@TableName</span> report</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReportUpdateRequest</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çŠ¶æ€ï¼ˆ0-æœªå¤„ç†, 1-å·²å¤„ç†ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer status;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="7-4-2-3æŸ¥è¯¢è¯·æ±‚"><a href="#7-4-2-3æŸ¥è¯¢è¯·æ±‚" class="headerlink" title="7.4.2.3æŸ¥è¯¢è¯·æ±‚"></a>7.4.2.3æŸ¥è¯¢è¯·æ±‚</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.yupi.lovefinder.common.PageRequest;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.EqualsAndHashCode;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŸ¥è¯¢è¯·æ±‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper = true)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReportQueryRequest</span> <span class="keyword">extends</span> <span class="title class_">PageRequest</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å†…å®¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¢«ä¸¾æŠ¥å¯¹è±¡ id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long reportedId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¢«ä¸¾æŠ¥ç”¨æˆ· id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long reportedUserId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * çŠ¶æ€ï¼ˆ0-æœªå¤„ç†, 1-å·²å¤„ç†ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer status;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ›å»ºç”¨æˆ· id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long userId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="7-4-3model-enum"><a href="#7-4-3model-enum" class="headerlink" title="7.4.3model.enum"></a>7.4.3model.enum</h5><h6 id="7-4-3-1ä¸¾æŠ¥çŠ¶æ€æšä¸¾"><a href="#7-4-3-1ä¸¾æŠ¥çŠ¶æ€æšä¸¾" class="headerlink" title="7.4.3.1ä¸¾æŠ¥çŠ¶æ€æšä¸¾"></a>7.4.3.1ä¸¾æŠ¥çŠ¶æ€æšä¸¾</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.yupi.lovefinder.model.enums;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¸¾æŠ¥çŠ¶æ€æšä¸¾</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> yupi</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">ReportStatusEnum</span> &#123;</span><br><span class="line"></span><br><span class="line">    DEFAULT(<span class="string">&quot;æœªå¤„ç†&quot;</span>, <span class="number">0</span>),</span><br><span class="line">    HANDLED(<span class="string">&quot;å·²å¤„ç†&quot;</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String text;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">int</span> value;</span><br><span class="line"></span><br><span class="line">    ReportStatusEnum(String text, <span class="type">int</span> value) &#123;</span><br><span class="line">        <span class="built_in">this</span>.text = text;</span><br><span class="line">        <span class="built_in">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–å€¼åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Integer&gt; <span class="title function_">getValues</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Arrays.stream(values()).map(item -&gt; item.value).collect(Collectors.toList());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getText</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> text;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–ç¨‹å¯¼èˆªæ˜ŸçƒçŸ¥è¯†åº“</p><p>ä¼˜åŒ–é¡¹ç›®ï¼šæœç´¢æ ä¸­å¯ä»¥æœ‰æç¤º</p><p>javaå¯è§†åŒ–ç›‘æµ‹å†…å­˜</p><p>ä¼˜åŒ–ç‚¹ï¼š</p><p>â€‹å¯è§‚æµ‹æ€§ï¼šå¯ä»¥å†™ä¸€ä¸ªå®šæ—¶ä»»åŠ¡</p><p>â€‹é¡¹ç›®å¼€æºçš„Readme.md</p>]]></content>
      
      
      <categories>
          
          <category> java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> java </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>First_Blog</title>
      <link href="/2022/12/20/First_Blog/"/>
      <url>/2022/12/20/First_Blog/</url>
      
        <content type="html"><![CDATA[<p>è®°å½•è‡ªå·±çš„å­¦ä¹ ç”Ÿæ´»ï¼</p>]]></content>
      
      
      <categories>
          
          <category> éšç¬” </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éšç¬” </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
